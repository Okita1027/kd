---
title: TypeScript
shortTitle: TypeScript
description: 
date: 2024-06-16 22:30:07
categories: [å‰ç«¯,TypeScript]
tags: []
---

> [TypeScript é˜®ä¸€å³° | é˜®ä¸€å³° TypeScript æ•™ç¨‹](https://typescript.p6p.net/)
>
> [TypeScript ä¸­æ–‡æ•™ç¨‹ | ä»ç±»å‹å…¥é—¨åˆ°æ¶æ„è®¾è®¡](https://ts.p6p.net/)
>
> [TypeScript ä¸­æ–‡ç½‘: æ‰‹å†Œ - TypeScript æ‰‹å†Œ](https://ts.nodejs.cn/docs/handbook/intro.html)
>
> [TypeScript æ•™ç¨‹ - ç½‘é“](https://wangdoc.com/typescript/)



```MERMAID
mindmap
  root((TypeScript çŸ¥è¯†ä½“ç³»))
    åŸºç¡€è¯­æ³•
      æ ‡å‡†ç±»å‹
        å­—ç¬¦ä¸² string
        æ•°å­— number
        å¸ƒå°” boolean
        ç©ºå€¼ void
        ä»»æ„ any/unknown
        ç©ºç±»å‹ null/undefined
        never ç±»å‹
      ç±»å‹æ³¨è§£
      ç±»å‹æ¨æ–­
      ç±»å‹æ–­è¨€
      è”åˆç±»å‹/äº¤å‰ç±»å‹
      å­—é¢é‡ç±»å‹
    å¯¹è±¡ç±»å‹
      æ¥å£ interface
      ç±»å‹åˆ«å type
      å¯é€‰å±æ€§
      åªè¯»å±æ€§
      ç´¢å¼•ç­¾å
      æ‰©å±•ä¸åˆå¹¶
    å‡½æ•°ç±»å‹
      å‚æ•°ç±»å‹
      è¿”å›å€¼ç±»å‹
      å¯é€‰å‚æ•°/é»˜è®¤å€¼
      å‰©ä½™å‚æ•°
      å‡½æ•°é‡è½½
    ç±»ä¸é¢å‘å¯¹è±¡
      ç±»å®šä¹‰
      æ„é€ å‡½æ•°
      è®¿é—®ä¿®é¥°ç¬¦ public/private/protected
      åªè¯»å±æ€§ readonly
      é™æ€å±æ€§ static
      æŠ½è±¡ç±» abstract
      æ¥å£å®ç° implements
      ç»§æ‰¿ extends
    é«˜çº§ç±»å‹
      keyof/typeof
      æ³›å‹ Generics
        æ³›å‹çº¦æŸ
        æ³›å‹å·¥å…·ç±»å‹
      æ¡ä»¶ç±»å‹
      æ˜ å°„ç±»å‹
      ç´¢å¼•è®¿é—®ç±»å‹
      ç±»å‹å®ˆå«
        typeof åˆ¤æ–­
        in åˆ¤æ–­
        instanceof åˆ¤æ–­
        è‡ªå®šä¹‰ç±»å‹ä¿æŠ¤
    æ¨¡å—åŒ–
      import/export
      å£°æ˜æ–‡ä»¶ .d.ts
      å‘½åç©ºé—´ namespace
    å·¥å…·ç±»å‹
      Partial<T>
      Required<T>
      Readonly<T>
      Pick<T>
      Omit<T>
      Record<K, T>
      ReturnType<T>
      Parameters<T>
      Awaited<T>
    é…ç½®ä¸ç¼–è¯‘
      tsconfig.json
        compilerOptions
        include/exclude
        strict æ¨¡å¼
      ç¼–è¯‘æµç¨‹
      Babel + TS
    ç±»å‹æ£€æŸ¥æœºåˆ¶
      ç±»å‹å…¼å®¹æ€§
      ç±»å‹æ”¶çª„
      ç±»å‹æ‹“å®½
      ç±»å‹æ“¦é™¤
      ç±»å‹ç³»ç»Ÿ vs å€¼è¿è¡Œæ—¶
    å®è·µä¸ç”Ÿæ€
      ä¸ JavaScript äº’æ“ä½œ
      React ä¸­ä½¿ç”¨ TypeScript
      Vue ä¸­ä½¿ç”¨ TypeScript
      Node.js ä¸­ä½¿ç”¨ TypeScript
      å¸¸è§åº“çš„ç±»å‹å£°æ˜

```

## åŸºæœ¬ä½¿ç”¨

### ç±»å‹å£°æ˜

### ç±»å‹æ¨æ–­

### å€¼ä¸ç±»å‹

æŸäº› å…³é”®å­— åŒæ—¶æ‹¥æœ‰ å€¼ä¸ç±»å‹ è¿™ä¸¤ç§æè¿°

## ç±»å‹ç³»ç»Ÿ

### åŸºæœ¬ç±»å‹

JavaScript è¯­è¨€ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ TypeScriptï¼‰å°†å€¼åˆ†æˆ 8 ç§ç±»å‹ã€‚

- boolean
- string
- number
- bigint
- symbol
- object
- undefined
- null

TypeScript ç»§æ‰¿äº† JavaScript çš„ç±»å‹è®¾è®¡ï¼Œä»¥ä¸Š 8 ç§ç±»å‹å¯ä»¥çœ‹ä½œ TypeScript çš„åŸºæœ¬ç±»å‹ã€‚

æ³¨æ„ï¼Œä¸Šé¢æ‰€æœ‰ç±»å‹çš„åç§°éƒ½æ˜¯å°å†™å­—æ¯ï¼Œé¦–å­—æ¯å¤§å†™çš„`Number`ã€`String`ã€`Boolean`ç­‰åœ¨ JavaScript è¯­è¨€ä¸­éƒ½æ˜¯å†…ç½®å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç±»å‹åç§°ã€‚

å¦å¤–ï¼Œundefined å’Œ null æ—¢å¯ä»¥ä½œä¸ºå€¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºç±»å‹ï¼Œå–å†³äºåœ¨å“ªé‡Œä½¿ç”¨å®ƒä»¬ã€‚

è¿™ 8 ç§åŸºæœ¬ç±»å‹æ˜¯ TypeScript ç±»å‹ç³»ç»Ÿçš„åŸºç¡€ï¼Œå¤æ‚ç±»å‹ç”±å®ƒä»¬ç»„åˆè€Œæˆã€‚

---

#### boolean

#### string

#### number

`number`ç±»å‹åŒ…å«æ‰€æœ‰æ•´æ•°å’Œæµ®ç‚¹æ•°ã€‚

```TS
const x: number = 123;
const y: number = 3.14;
const z: number = 0xffff;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ•´æ•°ã€æµ®ç‚¹æ•°å’Œéåè¿›åˆ¶æ•°éƒ½å±äº number ç±»å‹ã€‚

---

#### bigint

bigint ç±»å‹åŒ…å«æ‰€æœ‰çš„å¤§æ•´æ•°ã€‚

```TS
const x: bigint = 123n;
const y: bigint = 0xffffn;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`å’Œ`y`å°±å±äº bigint ç±»å‹ã€‚

bigint ä¸ number ç±»å‹ä¸å…¼å®¹ã€‚

```TS
const x: bigint = 123; // æŠ¥é”™
const y: bigint = 3.14; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`bigint`ç±»å‹èµ‹å€¼ä¸ºæ•´æ•°å’Œå°æ•°ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚

> bigint ç±»å‹æ˜¯ ES2020 æ ‡å‡†å¼•å…¥çš„ã€‚å¦‚æœä½¿ç”¨è¿™ä¸ªç±»å‹ï¼ŒTypeScript ç¼–è¯‘çš„ç›®æ ‡ JavaScript ç‰ˆæœ¬ä¸èƒ½ä½äº ES2020ï¼ˆå³ç¼–è¯‘å‚æ•°`target`ä¸ä½äº`es2020`ï¼‰ã€‚

---

#### symbol

symbol ç±»å‹åŒ…å«æ‰€æœ‰çš„ Symbol å€¼ã€‚

```TS
const x: symbol = Symbol();
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`Symbol()`å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯ symbol ç±»å‹ã€‚

---

#### object

æ ¹æ® JavaScript çš„è®¾è®¡ï¼Œobject ç±»å‹åŒ…å«äº†æ‰€æœ‰å¯¹è±¡ã€æ•°ç»„å’Œå‡½æ•°ã€‚

```TS
const x: object = { foo: 123 };
const y: object = [1, 2, 3];
const z: object = (n: number) => n + 1;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°éƒ½å±äº object ç±»å‹ã€‚

---

#### undefined

#### null

undefined å’Œ null æ˜¯ä¸¤ç§ç‹¬ç«‹ç±»å‹ï¼Œå®ƒä»¬å„è‡ªéƒ½åªæœ‰ä¸€ä¸ªå€¼ã€‚

undefined ç±»å‹åªåŒ…å«ä¸€ä¸ªå€¼`undefined`ï¼Œè¡¨ç¤ºæœªå®šä¹‰ï¼ˆå³è¿˜æœªç»™å‡ºå®šä¹‰ï¼Œä»¥åå¯èƒ½ä¼šæœ‰å®šä¹‰ï¼‰ã€‚

```TS
let x: undefined = undefined;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`å°±å±äº undefined ç±»å‹ã€‚ä¸¤ä¸ª`undefined`é‡Œé¢ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç±»å‹ï¼Œç¬¬äºŒä¸ªæ˜¯å€¼ã€‚

null ç±»å‹ä¹ŸåªåŒ…å«ä¸€ä¸ªå€¼`null`ï¼Œè¡¨ç¤ºä¸ºç©ºï¼ˆå³æ­¤å¤„æ²¡æœ‰å€¼ï¼‰ã€‚

```TS
const x: null = null;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`å°±å±äº null ç±»å‹ã€‚

> [!NOTE]
>
> å¦‚æœæ²¡æœ‰å£°æ˜ç±»å‹çš„å˜é‡ï¼Œè¢«èµ‹å€¼ä¸º`undefined`æˆ–`null`ï¼Œå®ƒä»¬çš„ç±»å‹ä¼šè¢«æ¨æ–­ä¸º`any`ã€‚

```TS
let a = undefined; // any
const b = undefined; // any

let c = null; // any
const d = null; // any
```

å¦‚æœå¸Œæœ›é¿å…è¿™ç§æƒ…å†µï¼Œåˆ™éœ€è¦æ‰“å¼€ç¼–è¯‘é€‰é¡¹`strictNullChecks`ã€‚

```TS
// æ‰“å¼€ç¼–è¯‘è®¾ç½® strictNullChecks
let a = undefined; // undefined
const b = undefined; // undefined

let c = null; // null
const d = null; // null
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ‰“å¼€ç¼–è¯‘è®¾ç½®`strictNullChecks`ä»¥åï¼Œèµ‹å€¼ä¸º`undefined`çš„å˜é‡ä¼šè¢«æ¨æ–­ä¸º`undefined`ç±»å‹ï¼Œèµ‹å€¼ä¸º`null`çš„å˜é‡ä¼šè¢«æ¨æ–­ä¸º`null`ç±»å‹ã€‚

### åŒ…è£…å¯¹è±¡ç±»å‹

JavaScript çš„ 8 ç§ç±»å‹ä¹‹ä¸­ï¼Œ`undefined`å’Œ`null`å…¶å®æ˜¯ä¸¤ä¸ªç‰¹æ®Šå€¼ï¼Œ`object`å±äºå¤åˆç±»å‹ï¼Œå‰©ä¸‹çš„äº”ç§å±äºåŸå§‹ç±»å‹ï¼ˆprimitive valueï¼‰ï¼Œä»£è¡¨æœ€åŸºæœ¬çš„ã€ä¸å¯å†åˆ†çš„å€¼ã€‚

- boolean
- string
- number
- bigint
- symbol

ä¸Šé¢è¿™äº”ç§åŸå§‹ç±»å‹çš„å€¼ï¼Œéƒ½æœ‰å¯¹åº”çš„åŒ…è£…å¯¹è±¡ï¼ˆwrapper objectï¼‰ã€‚æ‰€è°“â€œåŒ…è£…å¯¹è±¡â€ï¼ŒæŒ‡çš„æ˜¯è¿™äº›å€¼åœ¨éœ€è¦æ—¶ï¼Œä¼šè‡ªåŠ¨äº§ç”Ÿçš„å¯¹è±¡ã€‚

äº”ç§åŒ…è£…å¯¹è±¡ä¹‹ä¸­ï¼Œsymbol ç±»å‹å’Œ bigint ç±»å‹æ— æ³•ç›´æ¥è·å–å®ƒä»¬çš„åŒ…è£…å¯¹è±¡ï¼ˆå³`Symbol()`å’Œ`BigInt()`ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨ï¼‰ï¼Œä½†æ˜¯å‰©ä¸‹ä¸‰ç§å¯ä»¥ã€‚

- `Boolean()`
- `String()`
- `Number()`

> [!NOTE]
>
> `String()`åªæœ‰å½“ä½œæ„é€ å‡½æ•°ä½¿ç”¨æ—¶ï¼ˆå³å¸¦æœ‰`new`å‘½ä»¤è°ƒç”¨ï¼‰ï¼Œæ‰ä¼šè¿”å›åŒ…è£…å¯¹è±¡ã€‚å¦‚æœå½“ä½œæ™®é€šå‡½æ•°ä½¿ç”¨ï¼ˆä¸å¸¦æœ‰`new`å‘½ä»¤ï¼‰ï¼Œè¿”å›å°±æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸²ã€‚å…¶ä»–ä¸¤ä¸ªæ„é€ å‡½æ•°`Number()`å’Œ`Boolean()`ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

### Objectä¸object

##### Object

å¤§å†™çš„`Object`ç±»å‹ä»£è¡¨ JavaScript è¯­è¨€é‡Œé¢çš„å¹¿ä¹‰å¯¹è±¡ã€‚æ‰€æœ‰å¯ä»¥è½¬æˆå¯¹è±¡çš„å€¼ï¼Œéƒ½æ˜¯`Object`ç±»å‹ï¼Œè¿™å›Šæ‹¬äº†å‡ ä¹æ‰€æœ‰çš„å€¼ã€‚

```TS
let obj: Object;

obj = true;
obj = "hi";
obj = 1;
obj = { foo: 123 };
obj = [1, 2];
obj = (a: number) => a + 1;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼ŒåŸå§‹ç±»å‹å€¼ã€å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°éƒ½æ˜¯åˆæ³•çš„`Object`ç±»å‹ã€‚

äº‹å®ä¸Šï¼Œé™¤äº†`undefined`å’Œ`null`è¿™ä¸¤ä¸ªå€¼ä¸èƒ½è½¬ä¸ºå¯¹è±¡ï¼Œå…¶ä»–ä»»ä½•å€¼éƒ½å¯ä»¥èµ‹å€¼ç»™`Object`ç±»å‹ã€‚

```TS
let obj: Object;

obj = undefined; // æŠ¥é”™
obj = null; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`undefined`å’Œ`null`èµ‹å€¼ç»™`Object`ç±»å‹ï¼Œå°±ä¼šæŠ¥é”™ã€‚

å¦å¤–ï¼Œç©ºå¯¹è±¡`{}`æ˜¯`Object`ç±»å‹çš„ç®€å†™å½¢å¼ï¼Œæ‰€ä»¥ä½¿ç”¨`Object`æ—¶å¸¸å¸¸ç”¨ç©ºå¯¹è±¡ä»£æ›¿ã€‚

```TS
let obj: {};

obj = true;
obj = "hi";
obj = 1;
obj = { foo: 123 };
obj = [1, 2];
obj = (a: number) => a + 1;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`obj`çš„ç±»å‹æ˜¯ç©ºå¯¹è±¡`{}`ï¼Œå°±ä»£è¡¨`Object`ç±»å‹ã€‚

##### object

å°å†™çš„`object`ç±»å‹ä»£è¡¨ JavaScript é‡Œé¢çš„ç‹­ä¹‰å¯¹è±¡ï¼Œå³å¯ä»¥ç”¨å­—é¢é‡è¡¨ç¤ºçš„å¯¹è±¡ï¼ŒåªåŒ…å«*å¯¹è±¡ã€æ•°ç»„å’Œå‡½æ•°*ï¼Œä¸åŒ…æ‹¬åŸå§‹ç±»å‹çš„å€¼ã€‚

```TS
let obj: object;

obj = { foo: 123 };
obj = [1, 2];
obj = (a: number) => a + 1;
obj = true; // æŠ¥é”™
obj = "hi"; // æŠ¥é”™
obj = 1; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`object`ç±»å‹ä¸åŒ…å«åŸå§‹ç±»å‹å€¼ï¼ŒåªåŒ…å«å¯¹è±¡ã€æ•°ç»„å’Œå‡½æ•°ã€‚

å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ç±»å‹ï¼Œåªå¸Œæœ›åŒ…å«çœŸæ­£çš„å¯¹è±¡ï¼Œä¸å¸Œæœ›åŒ…å«åŸå§‹ç±»å‹ã€‚æ‰€ä»¥ï¼Œå»ºè®®æ€»æ˜¯ä½¿ç”¨å°å†™ç±»å‹`object`ï¼Œä¸ä½¿ç”¨å¤§å†™ç±»å‹`Object`ã€‚

> [!NOTE]
>
> æ— è®ºæ˜¯å¤§å†™çš„`Object`ç±»å‹ï¼Œè¿˜æ˜¯å°å†™çš„`object`ç±»å‹ï¼Œéƒ½åªåŒ…å« JavaScript å†…ç½®å¯¹è±¡åŸç”Ÿçš„å±æ€§å’Œæ–¹æ³•ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§å’Œæ–¹æ³•éƒ½ä¸å­˜åœ¨äºè¿™ä¸¤ä¸ªç±»å‹ä¹‹ä¸­ã€‚

```TS
const o1: Object = { foo: 0 };
const o2: object = { foo: 0 };

o1.toString(); // æ­£ç¡®
o1.foo; // æŠ¥é”™

o2.toString(); // æ­£ç¡®
o2.foo; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`toString()`æ˜¯å¯¹è±¡çš„åŸç”Ÿæ–¹æ³•ï¼Œå¯ä»¥æ­£ç¡®è®¿é—®ã€‚`foo`æ˜¯è‡ªå®šä¹‰å±æ€§ï¼Œè®¿é—®å°±ä¼šæŠ¥é”™ã€‚

### undefinedå’Œnull

`undefined`å’Œ`null`æ—¢æ˜¯å€¼ï¼Œåˆæ˜¯ç±»å‹ã€‚

ä½œä¸ºå€¼ï¼Œå®ƒä»¬æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹ï¼šä»»ä½•å…¶ä»–ç±»å‹çš„å˜é‡éƒ½å¯ä»¥èµ‹å€¼ä¸º`undefined`æˆ–`null`ã€‚

```TS
let age: number = 24;

age = null; // æ­£ç¡®
age = undefined; // æ­£ç¡®
```

ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡`age`çš„ç±»å‹æ˜¯`number`ï¼Œä½†æ˜¯èµ‹å€¼ä¸º`null`æˆ–`undefined`å¹¶ä¸æŠ¥é”™ã€‚

è¿™å¹¶ä¸æ˜¯å› ä¸º`undefined`å’Œ`null`åŒ…å«åœ¨`number`ç±»å‹é‡Œé¢ï¼Œè€Œæ˜¯æ•…æ„è¿™æ ·è®¾è®¡ï¼Œä»»ä½•ç±»å‹çš„å˜é‡éƒ½å¯ä»¥èµ‹å€¼ä¸º`undefined`å’Œ`null`ï¼Œä»¥ä¾¿è·Ÿ JavaScript çš„è¡Œä¸ºä¿æŒä¸€è‡´ã€‚

JavaScript çš„è¡Œä¸ºæ˜¯ï¼Œå˜é‡å¦‚æœç­‰äº`undefined`å°±è¡¨ç¤ºè¿˜æ²¡æœ‰èµ‹å€¼ï¼Œå¦‚æœç­‰äº`null`å°±è¡¨ç¤ºå€¼ä¸ºç©ºã€‚æ‰€ä»¥ï¼ŒTypeScript å°±å…è®¸äº†ä»»ä½•ç±»å‹çš„å˜é‡éƒ½å¯ä»¥èµ‹å€¼ä¸ºè¿™ä¸¤ä¸ªå€¼ã€‚

ä½†æ˜¯æœ‰æ—¶å€™ï¼Œè¿™å¹¶ä¸æ˜¯å¼€å‘è€…æƒ³è¦çš„è¡Œä¸ºï¼Œä¹Ÿä¸åˆ©äºå‘æŒ¥ç±»å‹ç³»ç»Ÿçš„ä¼˜åŠ¿ã€‚

```TS
const obj: object = undefined;
obj.toString(); // ç¼–è¯‘ä¸æŠ¥é”™ï¼Œè¿è¡Œå°±æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`obj`ç­‰äº`undefined`ï¼Œç¼–è¯‘ä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ï¼Œå®é™…æ‰§è¡Œæ—¶ï¼Œè°ƒç”¨`obj.toString()`å°±æŠ¥é”™äº†ï¼Œå› ä¸º`undefined`ä¸æ˜¯å¯¹è±¡ï¼Œæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ã€‚

ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒåŠæ—©å‘ç°é”™è¯¯ï¼ŒTypeScript æä¾›äº†ä¸€ä¸ªç¼–è¯‘é€‰é¡¹`strictNullChecks`ã€‚åªè¦æ‰“å¼€è¿™ä¸ªé€‰é¡¹ï¼Œ`undefined`å’Œ`null`å°±ä¸èƒ½èµ‹å€¼ç»™å…¶ä»–ç±»å‹çš„å˜é‡ï¼ˆé™¤äº†`any`ç±»å‹å’Œ`unknown`ç±»å‹ï¼‰ã€‚

ä¸‹é¢æ˜¯ tsc å‘½ä»¤æ‰“å¼€è¿™ä¸ªç¼–è¯‘é€‰é¡¹çš„ä¾‹å­:

```TS
// tsc --strictNullChecks app.ts

let age: number = 24;

age = null; // æŠ¥é”™
age = undefined; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ‰“å¼€`--strictNullChecks`ä»¥åï¼Œ`number`ç±»å‹çš„å˜é‡`age`å°±ä¸èƒ½èµ‹å€¼ä¸º`undefined`å’Œ`null`ã€‚

è¿™ä¸ªé€‰é¡¹åœ¨é…ç½®æ–‡ä»¶`tsconfig.json`çš„å†™æ³•å¦‚ä¸‹:

```json
{
  "compilerOptions": {
    "strictNullChecks": true
    // ...
  }
}
```

æ‰“å¼€`strictNullChecks`ä»¥åï¼Œ`undefined`å’Œ`null`è¿™ä¸¤ç§å€¼ä¹Ÿä¸èƒ½äº’ç›¸èµ‹å€¼äº†ã€‚

```ts
// æ‰“å¼€ strictNullChecks

let x: undefined = null; // æŠ¥é”™
let y: null = undefined; // æŠ¥é”™
```

æ€»ä¹‹ï¼Œæ‰“å¼€`strictNullChecks`ä»¥åï¼Œ`undefined`å’Œ`null`åªèƒ½èµ‹å€¼ç»™è‡ªèº«ï¼Œæˆ–è€…`any`ç±»å‹å’Œ`unknown`ç±»å‹çš„å˜é‡ã€‚

```ts
let x: any = undefined;
let y: unknown = null;
```

### å€¼ç±»å‹

TypeScript è§„å®šï¼Œå•ä¸ªå€¼ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œç§°ä¸ºâ€œå€¼ç±»å‹â€ã€‚

```ts
let x: "hello";

x = "hello"; // æ­£ç¡®
x = "world"; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`çš„ç±»å‹æ˜¯å­—ç¬¦ä¸²`hello`ï¼Œå¯¼è‡´å®ƒåªèƒ½èµ‹å€¼ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œèµ‹å€¼ä¸ºå…¶ä»–å­—ç¬¦ä¸²å°±ä¼šæŠ¥é”™ã€‚

TypeScript æ¨æ–­ç±»å‹æ—¶ï¼Œé‡åˆ°`const`å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œå¦‚æœä»£ç é‡Œé¢æ²¡æœ‰æ³¨æ˜ç±»å‹ï¼Œå°±ä¼šæ¨æ–­è¯¥å˜é‡æ˜¯å€¼ç±»å‹ã€‚

```ts
// x çš„ç±»å‹æ˜¯ "https"
const x = "https";

// y çš„ç±»å‹æ˜¯ string
const y: string = "https";
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`æ˜¯`const`å‘½ä»¤å£°æ˜çš„ï¼ŒTypeScript å°±ä¼šæ¨æ–­å®ƒçš„ç±»å‹æ˜¯å€¼`https`ï¼Œè€Œä¸æ˜¯`string`ç±»å‹ã€‚

è¿™æ ·æ¨æ–­æ˜¯åˆç†çš„ï¼Œå› ä¸º`const`å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä¸€æ—¦å£°æ˜å°±ä¸èƒ½æ”¹å˜ï¼Œç›¸å½“äºå¸¸é‡ã€‚å€¼ç±»å‹å°±æ„å‘³ç€ä¸èƒ½èµ‹ä¸ºå…¶ä»–å€¼ã€‚

> [!NOTE]
>
> `const`å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œå¦‚æœèµ‹å€¼ä¸ºå¯¹è±¡ï¼Œå¹¶ä¸ä¼šæ¨æ–­ä¸ºå€¼ç±»å‹ã€‚

```ts
// x çš„ç±»å‹æ˜¯ { foo: number }
const x = { foo: 1 };
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`æ²¡æœ‰è¢«æ¨æ–­ä¸ºå€¼ç±»å‹ï¼Œè€Œæ˜¯æ¨æ–­å±æ€§`foo`çš„ç±»å‹æ˜¯`number`ã€‚è¿™æ˜¯å› ä¸º JavaScript é‡Œé¢ï¼Œ`const`å˜é‡èµ‹å€¼ä¸ºå¯¹è±¡æ—¶ï¼Œå±æ€§å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚

å€¼ç±»å‹å¯èƒ½ä¼šå‡ºç°ä¸€äº›å¾ˆå¥‡æ€ªçš„æŠ¥é”™:

```ts
const x: 5 = 4 + 1; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç­‰å·å·¦ä¾§çš„ç±»å‹æ˜¯æ•°å€¼`5`ï¼Œç­‰å·å³ä¾§`4 + 1`çš„ç±»å‹ï¼ŒTypeScript æ¨æµ‹ä¸º`number`ã€‚ç”±äº`5`æ˜¯`number`çš„å­ç±»å‹ï¼Œ`number`æ˜¯`5`çš„çˆ¶ç±»å‹ï¼Œçˆ¶ç±»å‹ä¸èƒ½èµ‹å€¼ç»™å­ç±»å‹ï¼Œæ‰€ä»¥æŠ¥é”™äº†

ä½†æ˜¯ï¼Œåè¿‡æ¥æ˜¯å¯ä»¥çš„ï¼Œå­ç±»å‹å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»å‹:

```ts
let x: 5 = 5;
let y: number = 4 + 1;

x = y; // æŠ¥é”™
y = x; // æ­£ç¡®
```

å¦‚æœä¸€å®šè¦è®©å­ç±»å‹å¯ä»¥èµ‹å€¼ä¸ºçˆ¶ç±»å‹çš„å€¼ï¼Œå°±è¦ç”¨åˆ°ç±»å‹æ–­è¨€:

```ts
const x: 5 = (4 + 1) as 5; // æ­£ç¡®
```

### `type`

`type`å‘½ä»¤ç”¨æ¥å®šä¹‰ä¸€ä¸ªç±»å‹çš„åˆ«åã€‚

```ts
type Age = number;

let age: Age = 55;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`type`å‘½ä»¤ä¸º`number`ç±»å‹å®šä¹‰äº†ä¸€ä¸ªåˆ«å`Age`ã€‚è¿™æ ·å°±èƒ½åƒä½¿ç”¨`number`ä¸€æ ·ï¼Œä½¿ç”¨`Age`ä½œä¸ºç±»å‹ã€‚

åˆ«åä¸å…è®¸é‡åã€‚

```ts
type Color = "red";
type Color = "blue"; // æŠ¥é”™
```

### `typeof`

#### è¯­æ³•

è¯­æ³•: `typeof operand` æˆ– `typeof(operand)`ã€‚

```ts
// ä½œä¸ºä¸€å…ƒæ“ä½œç¬¦
console.log(typeof 42); // "number"

// å¸¦æœ‰æ‹¬å·
console.log(typeof("hello")); // "string"
```

`typeof` çš„è¿”å›å€¼å§‹ç»ˆæ˜¯**ä¸€ä¸ªå­—ç¬¦ä¸²**ã€‚å®ƒçš„è¿”å›å€¼ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š

| ç±»å‹      | ç¤ºä¾‹                    | è¿”å›å€¼      | è¯´æ˜                                   |
| --------- | ----------------------- | ----------- | -------------------------------------- |
| string    | abc', ""                | "string"    | å­—ç¬¦ä¸²ç±»å‹                             |
| number    | 42, 3.14, NaN, Infinity | "number"    | æ•°å­—ç±»å‹ï¼ˆåŒ…æ‹¬ç‰¹æ®Šå€¼ NaN å’Œ Infinityï¼‰ |
| boolean   | true, false             | "boolean"   | å¸ƒå°”ç±»å‹                               |
| bigint    | 10n                     | "bigint"    | å¤§æ•´æ•°ç±»å‹ï¼ˆES11 æ–°å¢ï¼‰                |
| symbol    | Symbol('foo')           | "symbol"    | ç¬¦å·ç±»å‹ï¼ˆES6 æ–°å¢ï¼‰                   |
| undefined | undefined, æœªå£°æ˜çš„å˜é‡ | "undefined" | æœªå®šä¹‰ç±»å‹                             |
| object    | {}, [], null            | "object"    | å¯¹è±¡ç±»å‹ï¼ˆåŒ…æ‹¬æ•°ç»„å’Œ nullï¼‰            |
| function  | function() {}           | "function"  | å‡½æ•°ç±»å‹                               |

#### éœ€æ³¨æ„çš„ç±»å‹

##### null => object



##### NaN => number



##### æ•°ç»„ => object



##### 

### ç‰¹æ®Šç±»å‹

#### any

å¯¹äºå¼€å‘è€…æ²¡æœ‰æŒ‡å®šç±»å‹ã€TypeScript å¿…é¡»è‡ªå·±æ¨æ–­ç±»å‹çš„é‚£äº›å˜é‡ï¼Œå¦‚æœæ— æ³•æ¨æ–­å‡ºç±»å‹ï¼ŒTypeScript å°±ä¼šè®¤ä¸ºè¯¥å˜é‡çš„ç±»å‹æ˜¯`any`ã€‚

```TS
function add(x, y) {
  return x + y;
}

add(1, [1, 2, 3]); // ä¸æŠ¥é”™
```

TypeScript æä¾›äº†ä¸€ä¸ªç¼–è¯‘é€‰é¡¹`noImplicitAny`ï¼Œæ‰“å¼€è¯¥é€‰é¡¹ï¼Œåªè¦æ¨æ–­å‡º`any`ç±»å‹å°±ä¼šæŠ¥é”™ã€‚

```BASH
tsc --noImplicitAny app.ts
```

è¿™é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼Œå³ä½¿æ‰“å¼€äº†`noImplicitAny`ï¼Œä½¿ç”¨`let`å’Œ`var`å‘½ä»¤å£°æ˜å˜é‡ï¼Œä½†ä¸èµ‹å€¼ä¹Ÿä¸æŒ‡å®šç±»å‹ï¼Œæ˜¯ä¸ä¼šæŠ¥é”™çš„ã€‚

```TS
var x; // ä¸æŠ¥é”™
let y; // ä¸æŠ¥é”™
```

```TS
let x;

x = 123;
x = { foo: "hello" };
```

ç”±äºè¿™ä¸ªåŸå› ï¼Œå»ºè®®ä½¿ç”¨`let`å’Œ`var`å£°æ˜å˜é‡æ—¶ï¼Œå¦‚æœä¸èµ‹å€¼ï¼Œå°±ä¸€å®šè¦æ˜¾å¼å£°æ˜ç±»å‹ï¼Œå¦åˆ™å¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£ã€‚

`const`å‘½ä»¤æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸º JavaScript è¯­è¨€è§„å®š`const`å£°æ˜å˜é‡æ—¶ï¼Œå¿…é¡»åŒæ—¶è¿›è¡Œåˆå§‹åŒ–ï¼ˆèµ‹å€¼ï¼‰ã€‚

```TS
const x; // æŠ¥é”™
```

**æ±¡æŸ“é—®é¢˜ï¼š**

`any`ç±»å‹é™¤äº†å…³é—­ç±»å‹æ£€æŸ¥ï¼Œè¿˜æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå°±æ˜¯å®ƒä¼šâ€œæ±¡æŸ“â€å…¶ä»–å˜é‡ã€‚å®ƒå¯ä»¥èµ‹å€¼ç»™å…¶ä»–ä»»ä½•ç±»å‹çš„å˜é‡ï¼ˆå› ä¸ºæ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼‰ï¼Œå¯¼è‡´å…¶ä»–å˜é‡å‡ºé”™ã€‚

```TS
let x: any = "hello";
let y: number;

y = x; // ä¸æŠ¥é”™

y * 123; // ä¸æŠ¥é”™
y.toFixed(); // ä¸æŠ¥é”™
```

#### unknown

ä¸ºäº†è§£å†³`any`ç±»å‹â€œæ±¡æŸ“â€å…¶ä»–å˜é‡çš„é—®é¢˜ï¼ŒTypeScript 3.0 å¼•å…¥äº†[`unknown`ç±»å‹](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-0.html#new-unknown-top-type)ã€‚å®ƒä¸`any`å«ä¹‰ç›¸åŒï¼Œè¡¨ç¤ºç±»å‹ä¸ç¡®å®šï¼Œå¯èƒ½æ˜¯ä»»æ„ç±»å‹ï¼Œä½†æ˜¯å®ƒçš„ä½¿ç”¨æœ‰ä¸€äº›é™åˆ¶ï¼Œä¸åƒ`any`é‚£æ ·è‡ªç”±ï¼Œå¯ä»¥è§†ä¸ºä¸¥æ ¼ç‰ˆçš„`any`ã€‚

`unknown`è·Ÿ`any`çš„ç›¸ä¼¼ä¹‹å¤„ï¼Œåœ¨äºæ‰€æœ‰ç±»å‹çš„å€¼éƒ½å¯ä»¥åˆ†é…ç»™`unknown`ç±»å‹ã€‚

```TS
let x: unknown;

x = true; // æ­£ç¡®
x = 42; // æ­£ç¡®
x = "Hello World"; // æ­£ç¡®
```

---

`unknown`ç±»å‹è·Ÿ`any`ç±»å‹çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªé™åˆ¶ã€‚

1. `unknown`ç±»å‹çš„å˜é‡ï¼Œä¸èƒ½ç›´æ¥èµ‹å€¼ç»™å…¶ä»–ç±»å‹çš„å˜é‡ï¼ˆé™¤äº†`any`ç±»å‹å’Œ`unknown`ç±»å‹ï¼‰ã€‚

```TS
let v: unknown = 123;

let v1: boolean = v; // æŠ¥é”™
let v2: number = v; // æŠ¥é”™
```

2. ä¸èƒ½ç›´æ¥è°ƒç”¨`unknown`ç±»å‹å˜é‡çš„æ–¹æ³•å’Œå±æ€§ã€‚

```TS
let v1: unknown = { foo: 123 };
v1.foo; // æŠ¥é”™

let v2: unknown = "hello";
v2.trim(); // æŠ¥é”™

let v3: unknown = (n = 0) => n + 1;
v3(); // æŠ¥é”™
```

3. `unknown`ç±»å‹å˜é‡èƒ½å¤Ÿè¿›è¡Œçš„è¿ç®—æ˜¯æœ‰é™çš„ï¼Œåªèƒ½è¿›è¡Œæ¯”è¾ƒè¿ç®—ï¼ˆè¿ç®—ç¬¦`==`ã€`===`ã€`!=`ã€`!==`ã€`||`ã€`&&`ã€`?`ï¼‰ã€å–åè¿ç®—ï¼ˆè¿ç®—ç¬¦`!`ï¼‰ã€`typeof`è¿ç®—ç¬¦å’Œ`instanceof`è¿ç®—ç¬¦è¿™å‡ ç§ï¼Œå…¶ä»–è¿ç®—éƒ½ä¼šæŠ¥é”™ã€‚

```TS
let a: unknown = 1;

a + 1; // æŠ¥é”™
a === 1; // æ­£ç¡®
```

---

unknownçš„æ­£ç¡®ç”¨æ³•ï¼š

åªæœ‰ç»è¿‡â€œç±»å‹ç¼©å°â€ï¼Œ`unknown`ç±»å‹å˜é‡æ‰å¯ä»¥ä½¿ç”¨ã€‚æ‰€è°“â€œç±»å‹ç¼©å°â€ï¼Œå°±æ˜¯ç¼©å°`unknown`å˜é‡çš„ç±»å‹èŒƒå›´ï¼Œç¡®ä¿ä¸ä¼šå‡ºé”™

```TS
let a: unknown = 1;

if (typeof a === "number") {
  let r = a + 10; // æ­£ç¡®
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`unknown`ç±»å‹çš„å˜é‡`a`ç»è¿‡`typeof`è¿ç®—ä»¥åï¼Œèƒ½å¤Ÿç¡®å®šå®é™…ç±»å‹æ˜¯`number`ï¼Œå°±èƒ½ç”¨äºåŠ æ³•è¿ç®—äº†ã€‚è¿™å°±æ˜¯â€œç±»å‹ç¼©å°â€ï¼Œå³å°†ä¸€ä¸ªä¸ç¡®å®šçš„ç±»å‹ç¼©å°ä¸ºæ›´æ˜ç¡®çš„ç±»å‹ã€‚

ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š

```TS
let s: unknown = "hello";

if (typeof s === "string") {
  s.length; // æ­£ç¡®
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç¡®å®šå˜é‡`s`çš„ç±»å‹ä¸ºå­—ç¬¦ä¸²ä»¥åï¼Œæ‰èƒ½è°ƒç”¨å®ƒçš„`length`å±æ€§ã€‚

è¿™æ ·è®¾è®¡çš„ç›®çš„æ˜¯ï¼Œåªæœ‰æ˜ç¡®`unknown`å˜é‡çš„å®é™…ç±»å‹ï¼Œæ‰å…è®¸ä½¿ç”¨å®ƒï¼Œé˜²æ­¢åƒ`any`é‚£æ ·å¯ä»¥éšæ„ä¹±ç”¨ï¼Œâ€œæ±¡æŸ“â€å…¶ä»–å˜é‡ã€‚ç±»å‹ç¼©å°ä»¥åå†ä½¿ç”¨ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚

æ€»ä¹‹ï¼Œ`unknown`å¯ä»¥çœ‹ä½œæ˜¯æ›´å®‰å…¨çš„`any`ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå‡¡æ˜¯éœ€è¦è®¾ä¸º`any`ç±»å‹çš„åœ°æ–¹ï¼Œé€šå¸¸éƒ½åº”è¯¥ä¼˜å…ˆè€ƒè™‘è®¾ä¸º`unknown`ç±»å‹ã€‚

åœ¨é›†åˆè®ºä¸Šï¼Œ`unknown`ä¹Ÿå¯ä»¥è§†ä¸ºæ‰€æœ‰å…¶ä»–ç±»å‹ï¼ˆé™¤äº†`any`ï¼‰çš„å…¨é›†ï¼Œæ‰€ä»¥å®ƒå’Œ`any`ä¸€æ ·ï¼Œä¹Ÿå±äº TypeScript çš„é¡¶å±‚ç±»å‹ã€‚

#### never

`never`ç±»å‹çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸»è¦æ˜¯åœ¨ä¸€äº›ç±»å‹è¿ç®—ä¹‹ä¸­ï¼Œä¿è¯ç±»å‹è¿ç®—çš„å®Œæ•´æ€§ï¼Œè¯¦è§åé¢ç« èŠ‚ã€‚å¦å¤–ï¼Œä¸å¯èƒ½è¿”å›å€¼çš„å‡½æ•°ï¼Œè¿”å›å€¼çš„ç±»å‹å°±å¯ä»¥å†™æˆ`never`

å¦‚æœä¸€ä¸ªå˜é‡å¯èƒ½æœ‰å¤šç§ç±»å‹ï¼ˆå³è”åˆç±»å‹ï¼‰ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨åˆ†æ”¯å¤„ç†æ¯ä¸€ç§ç±»å‹ã€‚è¿™æ—¶ï¼Œå¤„ç†æ‰€æœ‰å¯èƒ½çš„ç±»å‹ä¹‹åï¼Œå‰©ä½™çš„æƒ…å†µå°±å±äº`never`ç±»å‹ã€‚

```TS
function fn(x: string | number) {
  if (typeof x === "string") {
    // ...
  } else if (typeof x === "number") {
    // ...
  } else {
    x; // never ç±»å‹
  }
}
```

---

`never`ç±»å‹çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯ï¼Œå¯ä»¥èµ‹å€¼ç»™ä»»æ„å…¶ä»–ç±»å‹ã€‚

```TS
function f(): never {
  throw new Error("Error");
}

let v1: number = f(); // ä¸æŠ¥é”™
let v2: string = f(); // ä¸æŠ¥é”™
let v3: boolean = f(); // ä¸æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå‡½æ•°`f()`ä¼šæŠ›é”™ï¼Œæ‰€ä»¥è¿”å›å€¼ç±»å‹å¯ä»¥å†™æˆ`never`ï¼Œå³ä¸å¯èƒ½è¿”å›ä»»ä½•å€¼ã€‚å„ç§å…¶ä»–ç±»å‹çš„å˜é‡éƒ½å¯ä»¥èµ‹å€¼ä¸º`f()`çš„è¿è¡Œç»“æœï¼ˆ`never`ç±»å‹ï¼‰ã€‚

ä¸ºä»€ä¹ˆ`never`ç±»å‹å¯ä»¥èµ‹å€¼ç»™ä»»æ„å…¶ä»–ç±»å‹å‘¢ï¼Ÿè¿™ä¹Ÿè·Ÿé›†åˆè®ºæœ‰å…³ï¼Œç©ºé›†æ˜¯ä»»ä½•é›†åˆçš„å­é›†ã€‚TypeScript å°±ç›¸åº”è§„å®šï¼Œä»»ä½•ç±»å‹éƒ½åŒ…å«äº†`never`ç±»å‹ã€‚å› æ­¤ï¼Œ`never`ç±»å‹æ˜¯ä»»ä½•å…¶ä»–ç±»å‹æ‰€å…±æœ‰çš„ï¼ŒTypeScript æŠŠè¿™ç§æƒ…å†µç§°ä¸ºâ€œåº•å±‚ç±»å‹â€ï¼ˆbottom typeï¼‰ã€‚

æ€»ä¹‹ï¼ŒTypeScript æœ‰ä¸¤ä¸ªâ€œé¡¶å±‚ç±»å‹â€ï¼ˆ`any`å’Œ`unknown`ï¼‰ï¼Œä½†æ˜¯â€œåº•å±‚ç±»å‹â€åªæœ‰`never`å”¯ä¸€ä¸€ä¸ªã€‚

### è”åˆç±»å‹

#### è¯­æ³•

è”åˆç±»å‹ï¼ˆunion typesï¼‰æŒ‡çš„æ˜¯å¤šä¸ªç±»å‹ç»„æˆçš„ä¸€ä¸ªæ–°ç±»å‹ï¼Œä½¿ç”¨ç¬¦å·`|`è¡¨ç¤ºã€‚

è”åˆç±»å‹`A|B`è¡¨ç¤ºï¼Œä»»ä½•ä¸€ä¸ªç±»å‹åªè¦å±äº`A`æˆ–`B`ï¼Œå°±å±äºè”åˆç±»å‹`A|B`ã€‚

```TS
let x: string | number;

x = 123; // æ­£ç¡®
x = "abc"; // æ­£ç¡®
```

è”åˆç±»å‹å¯ä»¥ä¸å€¼ç±»å‹ç›¸ç»“åˆï¼Œè¡¨ç¤ºä¸€ä¸ªå˜é‡çš„å€¼æœ‰è‹¥å¹²ç§å¯èƒ½ã€‚
```typescript
let setting: true | false;

let gender: "male" | "female";

let rainbowColor: "èµ¤" | "æ©™" | "é»„" | "ç»¿" | "é’" | "è“" | "ç´«";
```

å‰é¢æåˆ°ï¼Œæ‰“å¼€ç¼–è¯‘é€‰é¡¹`strictNullChecks`åï¼Œå…¶ä»–ç±»å‹çš„å˜é‡ä¸èƒ½èµ‹å€¼ä¸º`undefined`æˆ–`null`ã€‚è¿™æ—¶ï¼Œå¦‚æœæŸä¸ªå˜é‡ç¡®å®å¯èƒ½åŒ…å«ç©ºå€¼ï¼Œå°±å¯ä»¥é‡‡ç”¨è”åˆç±»å‹çš„å†™æ³•ã€‚

```ts
let name: string | null;

name = "John";
name = null;
```

#### ç±»å‹ç¼©å°

è”åˆç±»å‹å˜é‡çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼ŒTypeScript èƒ½å¤Ÿé€šè¿‡**ç±»å‹ç¼©å° (Type Narrowing)** æ¥æ™ºèƒ½åœ°æ¨æ–­å‡ºåœ¨ç‰¹å®šä»£ç å—ä¸­è¯¥å˜é‡çš„å…·ä½“ç±»å‹ã€‚å½“ä½ å¯¹è”åˆç±»å‹å˜é‡è¿›è¡Œç±»å‹æ£€æŸ¥æ—¶ï¼ŒTypeScript ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨â€œç¼©å°â€å…¶ç±»å‹èŒƒå›´ã€‚

å¸¸è§çš„ç±»å‹ç¼©å°æ–¹å¼åŒ…æ‹¬ï¼š

- **`typeof` ç±»å‹ä¿æŠ¤**ï¼šæ£€æŸ¥å€¼çš„åŸºæœ¬ç±»å‹ã€‚

```ts
function printIdInfo(id: string | number) {
  if (typeof id === "string") {
    // åœ¨è¿™é‡Œï¼ŒTypeScript çŸ¥é“ id çš„ç±»å‹æ˜¯ string
    console.log("ID is a string, length: " + id.length); // å¯ä»¥å®‰å…¨åœ°è®¿é—® string çš„å±æ€§å’Œæ–¹æ³•
  } else {
    // åœ¨è¿™é‡Œï¼ŒTypeScript çŸ¥é“ id çš„ç±»å‹æ˜¯ number
    console.log("ID is a number, value: " + id.toFixed(2)); // å¯ä»¥å®‰å…¨åœ°è®¿é—® number çš„å±æ€§å’Œæ–¹æ³•
  }
}

printIdInfo("hello");
printIdInfo(123.456);
```

- **`instanceof` ç±»å‹ä¿æŠ¤**ï¼šæ£€æŸ¥å€¼æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å®ä¾‹ã€‚

```ts
class Dog { bark() { console.log('Woof!'); } }
class Cat { meow() { console.log('Meow!'); } }

function makeSound(animal: Dog | Cat) {
  if (animal instanceof Dog) {
    animal.bark(); // OK, animal is Dog
  } else {
    animal.meow(); // OK, animal is Cat
  }
}

makeSound(new Dog());
makeSound(new Cat());
```

- **`in` æ“ä½œç¬¦ç±»å‹ä¿æŠ¤**ï¼šæ£€æŸ¥å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªå±æ€§ã€‚

```ts
type Car = { drive: () => void; };
type Bike = { pedal: () => void; };

function move(vehicle: Car | Bike) {
  if ('drive' in vehicle) {
    vehicle.drive(); // OK, vehicle is Car
  } else {
    vehicle.pedal(); // OK, vehicle is Bike
  }
}
```

- **å­—é¢é‡ç±»å‹ä¿æŠ¤ (Equality Narrowing)**ï¼šé€šè¿‡æ¯”è¾ƒå­—é¢é‡å€¼æ¥ç¼©å°ç±»å‹ã€‚

```ts
type Status = "success" | "error" | "pending";

function handleStatus(status: Status) {
  if (status === "success") {
    console.log("Operation successful!"); // status æ˜¯ "success"
  } else if (status === "error") {
    console.log("Operation failed.");    // status æ˜¯ "error"
  } else {
    console.log("Operation pending..."); // status æ˜¯ "pending"
  }
}
```

- **ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ä¿æŠ¤**ï¼šé€šè¿‡è¿”å› `arg is Type` çš„å‡½æ•°æ¥å®šä¹‰è‡ªå·±çš„ç±»å‹ä¿æŠ¤ã€‚

```ts
function isNumber(x: any): x is number {
  return typeof x === "number";
}

function processValue(value: string | number) {
  if (isNumber(value)) {
    console.log(value * 2); // OK, value is number
  } else {
    console.log(value.toUpperCase()); // OK, value is string
  }
}
```

### äº¤å‰ç±»å‹

#### è¯­æ³•

äº¤å‰ç±»å‹ï¼ˆintersection typesï¼‰æŒ‡çš„å¤šä¸ªç±»å‹ç»„æˆçš„ä¸€ä¸ªæ–°ç±»å‹ï¼Œä½¿ç”¨ç¬¦å·`&`è¡¨ç¤ºã€‚

äº¤å‰ç±»å‹`A&B`è¡¨ç¤ºï¼Œä»»ä½•ä¸€ä¸ªç±»å‹å¿…é¡»åŒæ—¶å±äº`A`å’Œ`B`ï¼Œæ‰å±äºäº¤å‰ç±»å‹`A&B`ï¼Œå³äº¤å‰ç±»å‹åŒæ—¶æ»¡è¶³`A`å’Œ`B`çš„ç‰¹å¾ã€‚

```ts
let x: number & string;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`åŒæ—¶æ˜¯æ•°å€¼å’Œå­—ç¬¦ä¸²ï¼Œè¿™å½“ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥ TypeScript ä¼šè®¤ä¸º`x`çš„ç±»å‹å®é™…æ˜¯`never`ã€‚

äº¤å‰ç±»å‹çš„ä¸»è¦ç”¨é€”æ˜¯è¡¨ç¤ºå¯¹è±¡çš„åˆæˆ:

```ts
// å®šä¹‰ä¸¤ä¸ªåŸºæœ¬ç±»å‹
interface A {
  propA: string;
}

interface B {
  propB: number;
}

// å®šä¹‰ä¸€ä¸ªäº¤å‰ç±»å‹ Cï¼Œå®ƒåŒæ—¶æ‹¥æœ‰ A çš„ propA å’Œ B çš„ propB
type C = A & B;

const obj: C = {
  propA: "hello",
  propB: 123
};

console.log(obj.propA); // "hello"
console.log(obj.propB); // 123

// å¦‚æœç¼ºå°‘ä»»ä½•ä¸€ä¸ªå±æ€§ï¼ŒTypeScript éƒ½ä¼šæŠ¥é”™
// const obj2: C = { propA: "world" }; // Error: Property 'propB' is missing
```

äº¤å‰ç±»å‹ä¹Ÿå¯ä»¥ç”¨äºå‡½æ•°ç­¾åï¼Œè¡¨ç¤ºä¸€ä¸ªå‡½æ•°éœ€è¦åŒæ—¶æ»¡è¶³å¤šä¸ªå‡½æ•°ç­¾åã€‚è¿™åœ¨å‡½æ•°é‡è½½çš„åœºæ™¯ä¸‹å¾ˆæœ‰ç”¨ï¼Œå°½ç®¡é€šå¸¸æ›´æ¨èä½¿ç”¨å‡½æ•°é‡è½½çš„è¯­æ³•ã€‚

```ts
type F1 = (a: number) => string;
type F2 = (b: string) => number;

type FCombined = F1 & F2; // è¿™è¡¨ç¤ºä¸€ä¸ªå‡½æ•°éœ€è¦åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªç­¾å
// ä½†å®é™…ä½¿ç”¨ä¸­ï¼Œé€šå¸¸ç”¨å‡½æ•°é‡è½½è¯­æ³•æ›´æ¸…æ™°

// å®é™…ä½¿ç”¨ FCombined æ—¶ï¼Œä¼šå‘ç°å®ƒçš„è°ƒç”¨è§„åˆ™å˜å¾—éå¸¸ä¸¥æ ¼ï¼Œå› ä¸ºå®ƒå¿…é¡»åŒæ—¶æ»¡è¶³ä¸¤ä¸ªç­¾åï¼š
// æ¯”å¦‚ï¼Œå®ƒä¸èƒ½åªæœ‰ä¸€ä¸ª number å‚æ•°è¿”å› stringï¼Œä¹Ÿä¸èƒ½åªæœ‰ä¸€ä¸ª string å‚æ•°è¿”å› numberã€‚
// è¿™ç§æƒ…å†µé€šå¸¸åªå‡ºç°åœ¨å¤æ‚çš„é«˜é˜¶å‡½æ•°ç±»å‹æ¨å¯¼ä¸­ã€‚
// let fn: FCombined;
// fn = (x: number | string) => { /* ... */ return typeof x === 'number' ? 'str' : 1; }
// console.log(fn(5));
// console.log(fn('test'));
```

#### å±æ€§å†²çª

##### åŸå§‹ç±»å‹å†²çª

å¦‚æœå±æ€§æ˜¯åŸå§‹ç±»å‹ï¼ˆ`string`, `number`, `boolean`, `symbol`, `bigint`, `null`, `undefined`ï¼‰ï¼Œå¹¶ä¸”ç±»å‹ä¸å…¼å®¹ï¼Œé‚£ä¹ˆç»“æœç±»å‹å°†æ˜¯ `never`ã€‚è¿™æ„å‘³ç€è¿™ä¸ªäº¤å‰ç±»å‹å®é™…ä¸Šæ˜¯ä¸å¯æ„é€ çš„ï¼Œä½ æ— æ³•åˆ›å»ºä¸€ä¸ªç¬¦åˆè¿™ç§ç±»å‹çš„å€¼ã€‚

```ts
interface ConflictingA {
  id: string;
}
interface ConflictingB {
  id: number;
}

type Conflicting = ConflictingA & ConflictingB;
// id çš„ç±»å‹å°†æ˜¯ string & numberï¼Œç»“æœæ˜¯ never

// const objC: Conflicting = { id: "abc" }; // Error: Type 'string' is not assignable to type 'never'.
// const objC2: Conflicting = { id: 123 }; // Error: Type 'number' is not assignable to type 'never'.
// ä½ æ— æ³•åˆ›å»ºç¬¦åˆ Conflicting ç±»å‹çš„å€¼ï¼Œå› ä¸º id æ—¢è¦å­—ç¬¦ä¸²åˆè¦æ•°å­—ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚
```

##### å¯¹è±¡ç±»å‹å†²çª

å¦‚æœå±æ€§æ˜¯å¯¹è±¡ç±»å‹ï¼Œå¹¶ä¸”åŒåå±æ€§çš„ç±»å‹ä¸å…¼å®¹ï¼Œé‚£ä¹ˆäº¤å‰ç±»å‹ä¼šå°è¯•é€’å½’åœ°åˆå¹¶è¿™äº›å±æ€§çš„ç±»å‹ã€‚

```ts
interface SettingsA {
  config: { timeout: number; };
}
interface SettingsB {
  config: { retries: number; };
}

type CombinedSettings = SettingsA & SettingsB;
// config çš„ç±»å‹å°†æ˜¯ { timeout: number; } & { retries: number; }
// æœ€ç»ˆæ˜¯ { timeout: number; retries: number; }

const s: CombinedSettings = {
  config: {
    timeout: 1000,
    retries: 3
  }
};
```

##### å‡½æ•°ç­¾åå†²çª

å¦‚æœäº¤å‰ç±»å‹åˆå¹¶äº†åŒåçš„å‡½æ•°å±æ€§ï¼Œå¹¶ä¸”è¿™äº›å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸åŒï¼Œåˆ™æœ€ç»ˆç±»å‹ä¼šæ˜¯è¿™äº›å‡½æ•°ç­¾åçš„**é‡è½½åˆå¹¶**ã€‚

```ts
interface LoggerA {
  log(message: string): void;
}
interface LoggerB {
  log(errorCode: number): void;
}

type CombinedLogger = LoggerA & LoggerB;

const logger: CombinedLogger = {
  log(arg: string | number) {
    if (typeof arg === 'string') {
      console.log(`String Log: ${arg}`);
    } else {
      console.log(`Error Log: ${arg}`);
    }
  }
};

logger.log("Hello World"); // OK
logger.log(500);         // OK
```

### å—çº§ç±»å‹å£°æ˜

TypeScript æ”¯æŒå—çº§ç±»å‹å£°æ˜ï¼Œå³ç±»å‹å¯ä»¥å£°æ˜åœ¨ä»£ç å—ï¼ˆç”¨å¤§æ‹¬å·è¡¨ç¤ºï¼‰é‡Œé¢ï¼Œå¹¶ä¸”åªåœ¨å½“å‰ä»£ç å—æœ‰æ•ˆã€‚

```TS
if (true) {
  type T = number;
  let v: T = 5;
} else {
  type T = string;
  let v: T = "hello";
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªä»£ç å—ï¼Œå…¶ä¸­åˆ†åˆ«æœ‰ä¸€ä¸ªç±»å‹`T`çš„å£°æ˜ã€‚è¿™ä¸¤ä¸ªå£°æ˜éƒ½åªåœ¨è‡ªå·±çš„ä»£ç å—å†…éƒ¨æœ‰æ•ˆï¼Œåœ¨ä»£ç å—å¤–éƒ¨æ— æ•ˆã€‚

### ç±»å‹çš„å…¼å®¹

TypeScript çš„ç±»å‹å­˜åœ¨å…¼å®¹å…³ç³»ï¼ŒæŸäº›ç±»å‹å¯ä»¥å…¼å®¹å…¶ä»–ç±»å‹ã€‚

```TS
type T = number | string;

let a: number = 1;
let b: T = a;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`a`å’Œ`b`çš„ç±»å‹æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯å˜é‡`a`èµ‹å€¼ç»™å˜é‡`b`å¹¶ä¸ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºï¼Œ`b`çš„ç±»å‹å…¼å®¹`a`çš„ç±»å‹ã€‚

TypeScript ä¸ºè¿™ç§æƒ…å†µå®šä¹‰äº†ä¸€ä¸ªä¸“é—¨æœ¯è¯­ã€‚å¦‚æœç±»å‹`A`çš„å€¼å¯ä»¥èµ‹å€¼ç»™ç±»å‹`B`ï¼Œé‚£ä¹ˆç±»å‹`A`å°±ç§°ä¸ºç±»å‹`B`çš„å­ç±»å‹ï¼ˆsubtypeï¼‰ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œç±»å‹`number`å°±æ˜¯ç±»å‹`number|string`çš„å­ç±»å‹ã€‚

TypeScript çš„ä¸€ä¸ªè§„åˆ™æ˜¯ï¼Œå‡¡æ˜¯å¯ä»¥ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å­ç±»å‹ï¼Œä½†æ˜¯åè¿‡æ¥ä¸è¡Œã€‚

```TS
let a: "hi" = "hi";
let b: string = "hello";

b = a; // æ­£ç¡®
a = b; // æŠ¥é”™
```

ä¹‹æ‰€ä»¥æœ‰è¿™æ ·çš„è§„åˆ™ï¼Œæ˜¯å› ä¸ºå­ç±»å‹ç»§æ‰¿äº†çˆ¶ç±»å‹çš„æ‰€æœ‰ç‰¹å¾ï¼Œæ‰€ä»¥å¯ä»¥ç”¨åœ¨çˆ¶ç±»å‹çš„åœºåˆã€‚ä½†æ˜¯ï¼Œå­ç±»å‹è¿˜å¯èƒ½æœ‰ä¸€äº›çˆ¶ç±»å‹æ²¡æœ‰çš„ç‰¹å¾ï¼Œæ‰€ä»¥çˆ¶ç±»å‹ä¸èƒ½ç”¨åœ¨å­ç±»å‹çš„åœºåˆã€‚

## æ•°ç»„

### å•ç±»å‹æ•°ç»„

#### `T[]` 

è¿™æ˜¯æœ€å¸¸è§å’Œæ¨èçš„æ–¹å¼ï¼Œè¡¨ç¤ºä¸€ä¸ªç‰¹å®šç±»å‹çš„å…ƒç´ ç»„æˆçš„æ•°ç»„ã€‚

```TS
// å£°æ˜ä¸€ä¸ªåªåŒ…å«æ•°å­—çš„æ•°ç»„
let numbers: number[] = [1, 2, 3, 4];

// å£°æ˜ä¸€ä¸ªåªåŒ…å«å­—ç¬¦ä¸²çš„æ•°ç»„
let names: string[] = ["Alice", "Bob", "Charlie"];

// å£°æ˜ä¸€ä¸ªåªåŒ…å«å¸ƒå°”å€¼çš„æ•°ç»„
let flags: boolean[] = [true, false, true];

// å°è¯•æ·»åŠ ä¸ç¬¦åˆç±»å‹çš„å€¼ä¼šæŠ¥é”™
// numbers.push("hello"); // Error: Argument of type 'string' is not assignable to parameter of type 'number'.
```

#### `Array<T>`

è¿™ç§æ–¹å¼ä½¿ç”¨**æ³›å‹**ï¼ˆGenericsï¼‰æ¥å®šä¹‰æ•°ç»„ç±»å‹ï¼Œæ•ˆæœä¸ `[]` è¯­æ³•ç›¸åŒã€‚

```TS
let scores: Array<number> = [90, 85, 92];
let users: Array<{ name: string; age: number }> = [
  { name: "David", age: 30 },
  { name: "Eve", age: 25 },
];
```

### å¤šç±»å‹æ•°ç»„

å¦‚æœä½ éœ€è¦ä¸€ä¸ªæ•°ç»„ä¸­å¯ä»¥åŒ…å«å¤šç§ä¸åŒç±»å‹ï¼ˆä½†è¿™äº›ç±»å‹æ˜¯é¢„å…ˆç¡®å®šçš„ï¼‰çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨**è”åˆç±»å‹**ã€‚

```TS
// æ•°ç»„å¯ä»¥åŒ…å«æ•°å­—æˆ–å­—ç¬¦ä¸²
let mixedData: (number | string)[] = [1, "hello", 2, "world"];

// æˆ–è€…ä½¿ç”¨æ³›å‹å†™æ³•
let mixedData2: Array<number | string> = [3, "typescript", 4];

// å°è¯•æ·»åŠ å…¶ä»–ç±»å‹çš„å€¼ä¼šæŠ¥é”™
// mixedData.push(true); // Error: Argument of type 'boolean' is not assignable to parameter of type 'string | number'.
```

### åªè¯»æ•°ç»„

#### `readonly` `T[]`

```TS
const arr: readonly number[] = [0, 1];

arr[1] = 2; // æŠ¥é”™
arr.push(3); // æŠ¥é”™
delete arr[0]; // æŠ¥é”™
```

#### `ReadonlyArray<T>`

```TS
const a1: ReadonlyArray<number> = [0, 1];
```

> [!NOTE]
>
> `readonly`å…³é”®å­—ä¸èƒ½ä¸æ•°ç»„çš„æ³›å‹å†™æ³•ä¸€èµ·ä½¿ç”¨ã€‚

```TS
// æŠ¥é”™
const arr: readonly Array<number> = [0, 1];
```

#### `Readonly<T[]>`

```TS
const a2: Readonly<number[]> = [0, 1];
```

#### `as const`

ä»…ä»…åœ¨å£°æ˜å˜é‡æ—¶(`=`çš„å·¦è¾¹)å†™constæ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¿…é¡»åœ¨èµ‹å€¼é˜¶æ®µç”¨`as const`æ ‡è®°

```TS
const array = [1, 2]
array[1] = 3;	// å¯è¡Œ

const arr = [0, 1] as const;
arr[0] = [2]; // æŠ¥é”™
```

> [!note]
>
> è¿™é‡Œç”¨`as const`ç”Ÿæˆçš„æ—¢æ˜¯ æ•°ç»„ ï¼Œä¹Ÿæ˜¯ å…ƒç»„ï¼Œå› ä¸ºå®ƒæ˜¯ å€¼ç±»å‹

#### æ™®é€šæ•°ç»„ä¸åªè¯»æ•°ç»„

TypeScript å°†`readonly number[]`ä¸`number[]`è§†ä¸ºä¸¤ç§ä¸ä¸€æ ·çš„ç±»å‹ï¼Œåè€…æ˜¯å‰è€…çš„å­ç±»å‹ã€‚

è¿™æ˜¯å› ä¸ºåªè¯»æ•°ç»„æ²¡æœ‰`pop()`ã€`push()`ä¹‹ç±»ä¼šæ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•ï¼Œæ‰€ä»¥`number[]`çš„æ–¹æ³•æ•°é‡è¦å¤šäº`readonly number[]`ï¼Œè¿™æ„å‘³ç€`number[]`å…¶å®æ˜¯`readonly number[]`çš„å­ç±»å‹ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œå­ç±»å‹ç»§æ‰¿äº†çˆ¶ç±»å‹çš„æ‰€æœ‰ç‰¹å¾ï¼Œå¹¶åŠ ä¸Šäº†è‡ªå·±çš„ç‰¹å¾ï¼Œæ‰€ä»¥å­ç±»å‹`number[]`å¯ä»¥ç”¨äºæ‰€æœ‰ä½¿ç”¨çˆ¶ç±»å‹çš„åœºåˆï¼Œåè¿‡æ¥å°±ä¸è¡Œã€‚

```TS
let a1: number[] = [0, 1];
let a2: readonly number[] = a1; // æ­£ç¡®

a1 = a2; // æŠ¥é”™
```

### æ•°ç»„çš„ç±»å‹æ¨æ–­

å¦‚æœæ•°ç»„å˜é‡æ²¡æœ‰å£°æ˜ç±»å‹ï¼ŒTypeScript å°±ä¼šæ¨æ–­æ•°ç»„æˆå‘˜çš„ç±»å‹ã€‚è¿™æ—¶ï¼Œæ¨æ–­è¡Œä¸ºä¼šå› ä¸ºå€¼çš„ä¸åŒï¼Œè€Œæœ‰æ‰€ä¸åŒã€‚

å¦‚æœå˜é‡çš„åˆå§‹å€¼æ˜¯ç©ºæ•°ç»„ï¼Œé‚£ä¹ˆ TypeScript ä¼šæ¨æ–­æ•°ç»„ç±»å‹æ˜¯`any[]`ã€‚

```TS
// æ¨æ–­ä¸º any[]
const arr = [];
```

åé¢ï¼Œä¸ºè¿™ä¸ªæ•°ç»„èµ‹å€¼æ—¶ï¼ŒTypeScript ä¼šè‡ªåŠ¨æ›´æ–°ç±»å‹æ¨æ–­ã€‚

```TS
const arr = [];
arr; // æ¨æ–­ä¸º any[]

arr.push(123);
arr; // æ¨æ–­ç±»å‹ä¸º number[]

arr.push("abc");
arr; // æ¨æ–­ç±»å‹ä¸º (string|number)[]
```

> [!NOTE]
>
> ç±»å‹æ¨æ–­çš„è‡ªåŠ¨æ›´æ–°åªå‘ç”Ÿåˆå§‹å€¼ä¸ºç©ºæ•°ç»„çš„æƒ…å†µã€‚å¦‚æœåˆå§‹å€¼ä¸æ˜¯ç©ºæ•°ç»„ï¼Œç±»å‹æ¨æ–­å°±ä¸ä¼šæ›´æ–°ã€‚

```TS
// æ¨æ–­ç±»å‹ä¸º number[]
const arr = [123];

arr.push("abc"); // æŠ¥é”™
```

## å…ƒç»„

**å…ƒç»„**æ˜¯æ•°ç»„çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå®ƒ**æ˜ç¡®æŒ‡å®šäº†æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•ä½ç½®ä¸Šå…ƒç´ çš„ç±»å‹å’Œæ•°ç»„çš„é•¿åº¦**ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚

```TS
const s: [string, string, boolean] = ["a", "b", true];
```

### åªè¯»å…ƒç»„

å…ƒç»„ä¹Ÿå¯ä»¥æ˜¯åªè¯»çš„ï¼Œä¸å…è®¸ä¿®æ”¹ï¼Œæœ‰ä¸¤ç§å†™æ³•ã€‚

```TS
// å†™æ³•ä¸€
type t = readonly [number, string];

// å†™æ³•äºŒ
type t = Readonly<[number, string]>;

// å†™æ³•ä¸‰
const t = [1, true] as const
```

è·Ÿæ•°ç»„ä¸€æ ·ï¼Œåªè¯»å…ƒç»„æ˜¯å…ƒç»„çš„çˆ¶ç±»å‹ã€‚æ‰€ä»¥ï¼Œå…ƒç»„å¯ä»¥æ›¿ä»£åªè¯»å…ƒç»„ï¼Œè€Œåªè¯»å…ƒç»„ä¸èƒ½æ›¿ä»£å…ƒç»„ã€‚

```TS
type t1 = readonly [number, number];
type t2 = [number, number];

let x: t2 = [1, 2];
let y: t1 = x; // æ­£ç¡®

x = y; // æŠ¥é”™
```



### å¯é€‰æˆå‘˜

å¯é€‰æˆå‘˜å¿…é¡»å£°æ˜åœ¨æœ«å°¾

```TS
type t = [number, number?]	// æ­£ç¡®
type t = [number, string?, boolean]	//é”™è¯¯
```



### æ•°é‡æ¨æ–­

å¦‚æœæ²¡æœ‰å¯é€‰æˆå‘˜å’Œæ‰©å±•è¿ç®—ç¬¦ï¼ŒTypeScript ä¼šæ¨æ–­å‡ºå…ƒç»„çš„æˆå‘˜æ•°é‡ï¼ˆå³å…ƒç»„é•¿åº¦ï¼‰ã€‚

```TS
function f(point: [number, number]) {
  if (point.length === 3) {
    // æŠ¥é”™
    // ...
  }
}
```



å¦‚æœåŒ…å«äº†å¯é€‰æˆå‘˜ï¼ŒTypeScript ä¼šæ¨æ–­å‡ºå¯èƒ½çš„æˆå‘˜æ•°é‡ã€‚

```TS
function f(point: [number, number?, number?]) {
  if (point.length === 4) {
    // æŠ¥é”™
    // ...
  }
}
```



å¦‚æœä½¿ç”¨äº†æ‰©å±•è¿ç®—ç¬¦ï¼ŒTypeScript å°±æ— æ³•æ¨æ–­å‡ºæˆå‘˜æ•°é‡ã€‚

```TS
const myTuple: [...string[]] = ["a", "b", "c"];

if (myTuple.length === 4) {
  // æ­£ç¡®
  // ...
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­`myTuple`åªæœ‰ä¸‰ä¸ªæˆå‘˜ï¼Œä½†æ˜¯ TypeScript æ¨æ–­ä¸å‡ºå®ƒçš„æˆå‘˜æ•°é‡ï¼Œå› ä¸ºå®ƒçš„ç±»å‹ç”¨åˆ°äº†æ‰©å±•è¿ç®—ç¬¦ï¼ŒTypeScript æŠŠ`myTuple`å½“æˆæ•°ç»„çœ‹å¾…ï¼Œè€Œæ•°ç»„çš„æˆå‘˜æ•°é‡æ˜¯ä¸ç¡®å®šçš„ã€‚

ä¸€æ—¦æ‰©å±•è¿ç®—ç¬¦ä½¿å¾—å…ƒç»„çš„æˆå‘˜æ•°é‡æ— æ³•æ¨æ–­ï¼ŒTypeScript å†…éƒ¨å°±ä¼šæŠŠè¯¥å…ƒç»„å½“æˆæ•°ç»„å¤„ç†ã€‚

## å‡½æ•°

å¦‚æœå˜é‡è¢«èµ‹å€¼ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå˜é‡çš„ç±»å‹æœ‰ä¸¤ç§å†™æ³•ã€‚

```TS
// å†™æ³•ä¸€
const hello = function (txt: string) {
  console.log("hello " + txt);
};

// å†™æ³•äºŒ
const hello: (txt: string) => void = function (txt) {
  console.log("hello " + txt);
};
```

### Functionç±»å‹

TypeScript æä¾› Function ç±»å‹è¡¨ç¤ºå‡½æ•°ï¼Œä»»ä½•å‡½æ•°éƒ½å±äºè¿™ä¸ªç±»å‹ã€‚

Function ç±»å‹çš„å‡½æ•°å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°çš„ç±»å‹éƒ½æ˜¯`any`ï¼Œè¿”å›å€¼çš„ç±»å‹ä¹Ÿæ˜¯`any`ï¼Œä»£è¡¨æ²¡æœ‰ä»»ä½•çº¦æŸï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨è¿™ä¸ªç±»å‹ï¼Œç»™å‡ºå‡½æ•°è¯¦ç»†çš„ç±»å‹å£°æ˜ä¼šæ›´å¥½

```TS
function doSomething(f: Function) {
  return f(1, 2, 3);
}
```

### å‚æ•°ç±»å‹

#### å¯é€‰å‚æ•°



#### é»˜è®¤å‚æ•°



#### å‰©ä½™å‚æ•°

rest å‚æ•°è¡¨ç¤ºå‡½æ•°å‰©ä½™çš„æ‰€æœ‰å‚æ•°ï¼Œå®ƒå¯ä»¥æ˜¯æ•°ç»„ï¼ˆå‰©ä½™å‚æ•°ç±»å‹ç›¸åŒï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯å…ƒç»„ï¼ˆå‰©ä½™å‚æ•°ç±»å‹ä¸åŒï¼‰ã€‚

```TS
// rest å‚æ•°ä¸ºæ•°ç»„
function joinNumbers(...nums: number[]) {
  // ...
}

// rest å‚æ•°ä¸ºå…ƒç»„
function f(...args: [boolean, number]) {
  // ...
}
```

rest å‚æ•°ç”šè‡³å¯ä»¥åµŒå¥—ã€‚

```TS
function f(...args: [boolean, ...string[]]) {
  // ...
}
```



#### åªè¯»å‚æ•°



## å¯¹è±¡

### å±æ€§åçš„ç´¢å¼•ç±»å‹

ç´¢å¼•ç­¾åæœ‰ä¸¤ç§ä¸»è¦å½¢å¼ï¼š**å­—ç¬¦ä¸²ç´¢å¼•ç­¾å** å’Œ **æ•°å­—ç´¢å¼•ç­¾å**ã€‚

```TS
interface MyObject {
  // å­—ç¬¦ä¸²ç´¢å¼•ç­¾å
  [key: string]: number;

  // æ•°å­—ç´¢å¼•ç­¾å (é€šå¸¸ç”¨äºè¡¨ç¤ºç±»æ•°ç»„å¯¹è±¡æˆ–å­—å…¸ï¼Œé”®ä¸ºæ•°å­—)
  // [index: number]: string; // ç¤ºä¾‹ï¼šé”®æ˜¯æ•°å­—ï¼Œå€¼æ˜¯å­—ç¬¦ä¸²
}
```

`[key: string]`: è¿™éƒ¨åˆ†å®šä¹‰äº†**é”®ï¼ˆå±æ€§åï¼‰çš„ç±»å‹**ã€‚å®ƒå¯ä»¥æ˜¯ `string` æˆ– `number`ï¼ˆæˆ– `symbol`ï¼Œä½†è¾ƒå°‘ç”¨ä½œé€šç”¨ç´¢å¼•ï¼‰ã€‚

`: number`: è¿™éƒ¨åˆ†å®šä¹‰äº†**å€¼ï¼ˆå±æ€§å€¼ï¼‰çš„ç±»å‹**ã€‚

#### å­—ç¬¦ä¸²ç´¢å¼•ç­¾å

å­—ç¬¦ä¸²ç´¢å¼•ç­¾åæ˜¯æœ€å¸¸è§çš„å½¢å¼ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å­—ç¬¦ä¸²å±æ€§ï¼Œå¹¶ä¸”è¿™äº›å±æ€§çš„å€¼éƒ½å¿…é¡»æ˜¯æŒ‡å®šç±»å‹ã€‚

ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°æ•°å­—çš„å­—å…¸

```TS
interface StringToNumberDictionary {
  [key: string]: number; // ä»»ä½•å­—ç¬¦ä¸²é”®éƒ½å¯¹åº”ä¸€ä¸ªæ•°å­—å€¼
  length?: number; // å¯ä»¥æœ‰å…¶ä»–æ˜ç¡®å®šä¹‰çš„å±æ€§ï¼Œä½†å…¶ç±»å‹å¿…é¡»ä¸ç´¢å¼•ç­¾åå…¼å®¹
  // name: string; // Error: Property 'name' of type 'string' is not assignable to 'string' index type 'number'.
                   // å¦‚æœ name å±æ€§å­˜åœ¨ï¼Œå®ƒçš„å€¼ç±»å‹å¿…é¡»æ˜¯ numberï¼Œå› ä¸ºç´¢å¼•ç­¾åè§„å®šäº†æ‰€æœ‰å­—ç¬¦ä¸²å±æ€§çš„å€¼éƒ½æ˜¯ numberã€‚
}

let scores: StringToNumberDictionary = {
  "math": 95,
  "english": 88,
  "science": 92
};

console.log(scores["math"]); // 95
scores.history = 78;          // OK
// scores.chemistry = "ninety"; // Error: Type 'string' is not assignable to type 'number'.

// ä¹Ÿå¯ä»¥æœ‰å¯é€‰å±æ€§ï¼Œåªè¦å…¶ç±»å‹å…¼å®¹
scores.length = 3; // OK
```

> [!important]
>
> å½“ä¸€ä¸ªæ¥å£åŒæ—¶å®šä¹‰äº†ç´¢å¼•ç­¾åå’Œæ˜ç¡®çš„å±æ€§æ—¶ï¼Œ**æ˜ç¡®å±æ€§çš„ç±»å‹å¿…é¡»æ˜¯ç´¢å¼•ç­¾åå€¼ç±»å‹çš„å­ç±»å‹**ï¼ˆæˆ–è€…è¯´ï¼Œå¿…é¡»å…¼å®¹ç´¢å¼•ç­¾åå€¼ç±»å‹ï¼‰ã€‚
>
> è¿™æ˜¯å› ä¸ºç´¢å¼•ç­¾åè¡¨ç¤ºâ€œæ‰€æœ‰â€å­—ç¬¦ä¸²é”®çš„å±æ€§å€¼ç±»å‹ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªæ˜ç¡®çš„å±æ€§ `name: string`ï¼Œä½†ç´¢å¼•ç­¾åæ˜¯ `[key: string]: number`ï¼Œé‚£ä¹ˆ `name` çš„å€¼æ—¢è¦æ»¡è¶³ `string` åˆè¦æ»¡è¶³ `number`ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œé™¤é `string` æ˜¯ `number` çš„å­ç±»å‹ï¼ˆæ˜¾ç„¶ä¸æ˜¯ï¼‰ï¼Œæˆ–è€… `number` æ˜¯ `string` çš„å­ç±»å‹ï¼ˆä¹Ÿä¸æ˜¯ï¼‰ã€‚æ‰€ä»¥ï¼Œå®ƒä»¬å¿…é¡»å…¼å®¹ã€‚
>
> **ä¾‹å­ä¸­çš„ `length?: number;` æ˜¯å…¼å®¹çš„ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±æ˜¯ `number` ç±»å‹ï¼Œç¬¦åˆ `[key: string]: number` çš„è¦æ±‚ã€‚**

#### æ•°å­—ç´¢å¼•ç­¾å

æ•°å­—ç´¢å¼•ç­¾åè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡å¯ä»¥ç”¨æ•°å­—ä½œä¸ºé”®æ¥ç´¢å¼•ï¼Œå¹¶ä¸”è¿™äº›æ•°å­—é”®å¯¹åº”çš„å€¼éƒ½å¿…é¡»æ˜¯æŒ‡å®šç±»å‹ã€‚è¿™åœ¨å¤„ç†ç±»æ•°ç»„å¯¹è±¡æˆ–å½“æ•°å­—é”®æœ‰ç‰¹æ®Šå«ä¹‰æ—¶å¾ˆæœ‰ç”¨ã€‚

ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªæ•°å­—åˆ°å­—ç¬¦ä¸²çš„æ˜ å°„

```ts
interface StringArray {
  [index: number]: string; // ä»»ä½•æ•°å­—é”®éƒ½å¯¹åº”ä¸€ä¸ªå­—ç¬¦ä¸²å€¼
}

let myArray: StringArray = ["Hello", "World"]; // æ•°ç»„æœ¬èº«å°±æ˜¯æ•°å­—ç´¢å¼•çš„ï¼Œå¹¶ä¸”å€¼éƒ½æ˜¯å­—ç¬¦ä¸²

console.log(myArray[0]); // "Hello"
myArray[2] = "TypeScript"; // OK

// ä¹Ÿå¯ä»¥åƒæ“ä½œæ•°ç»„ä¸€æ ·æ“ä½œ
// myArray.push("!"); // å°½ç®¡è¯­æ³•å…è®¸ï¼Œä½†å®é™…ä¸Šï¼Œç´¢å¼•ç­¾åä¸ä¼šç›´æ¥èµ‹äºˆæ•°ç»„æ–¹æ³•ã€‚
                      // å¦‚æœä½ æƒ³è¦ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼Œç›´æ¥ä½¿ç”¨ string[] æˆ– Array<string>ã€‚
```

> [!note]
>
> æ•°å­—å±æ€§åè‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚å› æ­¤ï¼Œ`obj[100]` å’Œ `obj["100"]` æ˜¯ç­‰ä»·çš„ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€ä¸ªæ¥å£åŒæ—¶å®šä¹‰äº†**å­—ç¬¦ä¸²ç´¢å¼•ç­¾å**å’Œ**æ•°å­—ç´¢å¼•ç­¾å**ï¼Œé‚£ä¹ˆ**æ•°å­—ç´¢å¼•ç­¾åå®šä¹‰çš„å€¼ç±»å‹å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç´¢å¼•ç­¾åå€¼ç±»å‹çš„å­ç±»å‹**ã€‚

#### æ€»ç»“

1. `[key: string]: ValueType;` å®šä¹‰æ‰€æœ‰å­—ç¬¦ä¸²é”®çš„å±æ€§å€¼ç±»å‹ã€‚
2. `[index: number]: ValueType;` å®šä¹‰æ‰€æœ‰æ•°å­—é”®çš„å±æ€§å€¼ç±»å‹ã€‚
3. å¦‚æœåŒæ—¶å­˜åœ¨ï¼Œæ•°å­—ç´¢å¼•ç­¾åå€¼ç±»å‹å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç´¢å¼•ç­¾åå€¼ç±»å‹çš„å­ç±»å‹ã€‚
4. æ˜ç¡®å®šä¹‰çš„å±æ€§ç±»å‹å¿…é¡»å…¼å®¹ç´¢å¼•ç­¾åå€¼ç±»å‹ã€‚

### ç»“æ„ç±»å‹åŸåˆ™

åªè¦å¯¹è±¡ B æ»¡è¶³ å¯¹è±¡ A çš„ç»“æ„ç‰¹å¾ï¼ŒTypeScript å°±è®¤ä¸ºå¯¹è±¡ B å…¼å®¹å¯¹è±¡ A çš„ç±»å‹ï¼Œè¿™ç§°ä¸ºâ€œç»“æ„ç±»å‹â€åŸåˆ™ï¼ˆstructual typingï¼‰ã€‚

```TS
const A = {
  x: number;
};

const B = {
  x: number;
  y: number;
};
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå¯¹è±¡`A`åªæœ‰ä¸€ä¸ªå±æ€§`x`ï¼Œç±»å‹ä¸º`number`ã€‚å¯¹è±¡`B`æ»¡è¶³è¿™ä¸ªç‰¹å¾ï¼Œå› æ­¤å…¼å®¹å¯¹è±¡`A`ï¼Œåªè¦å¯ä»¥ä½¿ç”¨`A`çš„åœ°æ–¹ï¼Œå°±å¯ä»¥ä½¿ç”¨`B`ã€‚

```TS
const B = {
  x: 1,
  y: 1,
};

const A: { x: number } = B; // æ­£ç¡®
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`A`å’Œ`B`å¹¶ä¸æ˜¯åŒä¸€ä¸ªç±»å‹ï¼Œä½†æ˜¯`B`å¯ä»¥èµ‹å€¼ç»™`A`ï¼Œå› ä¸º`B`æ»¡è¶³`A`çš„ç»“æ„ç‰¹å¾ã€‚

æ ¹æ®â€œç»“æ„ç±»å‹â€åŸåˆ™ï¼ŒTypeScript æ£€æŸ¥æŸä¸ªå€¼æ˜¯å¦ç¬¦åˆæŒ‡å®šç±»å‹æ—¶ï¼Œå¹¶ä¸æ˜¯æ£€æŸ¥è¿™ä¸ªå€¼çš„ç±»å‹åï¼ˆå³â€œåä¹‰ç±»å‹â€ï¼‰ï¼Œè€Œæ˜¯æ£€æŸ¥è¿™ä¸ªå€¼çš„ç»“æ„æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆå³â€œç»“æ„ç±»å‹â€ï¼‰ã€‚

TypeScript ä¹‹æ‰€ä»¥è¿™æ ·è®¾è®¡ï¼Œæ˜¯ä¸ºäº†ç¬¦åˆ JavaScript çš„è¡Œä¸ºã€‚JavaScript å¹¶ä¸å…³å¿ƒå¯¹è±¡æ˜¯å¦ä¸¥æ ¼ç›¸ä¼¼ï¼Œåªè¦æŸä¸ªå¯¹è±¡å…·æœ‰æ‰€è¦æ±‚çš„å±æ€§ï¼Œå°±å¯ä»¥æ­£ç¡®è¿è¡Œã€‚

å¦‚æœç±»å‹ B å¯ä»¥èµ‹å€¼ç»™ç±»å‹ Aï¼ŒTypeScript å°±è®¤ä¸º B æ˜¯ A çš„å­ç±»å‹ï¼ˆsubtypingï¼‰ï¼ŒA æ˜¯ B çš„çˆ¶ç±»å‹ã€‚å­ç±»å‹æ»¡è¶³çˆ¶ç±»å‹çš„æ‰€æœ‰ç»“æ„ç‰¹å¾ï¼ŒåŒæ—¶è¿˜å…·æœ‰è‡ªå·±çš„ç‰¹å¾ã€‚å‡¡æ˜¯å¯ä»¥ä½¿ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å­ç±»å‹ï¼Œå³å­ç±»å‹å…¼å®¹çˆ¶ç±»å‹ã€‚

### ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥

å¦‚æœå¯¹è±¡ä½¿ç”¨å­—é¢é‡è¡¨ç¤ºï¼Œä¼šè§¦å‘ TypeScript çš„ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ï¼ˆstrict object literal checkingï¼‰ã€‚å¦‚æœå­—é¢é‡çš„ç»“æ„è·Ÿç±»å‹å®šä¹‰çš„ä¸ä¸€æ ·ï¼ˆæ¯”å¦‚å¤šå‡ºäº†æœªå®šä¹‰çš„å±æ€§ï¼‰ï¼Œå°±ä¼šæŠ¥é”™ã€‚

```TS
const point: {
  x: number;
  y: number;
} = {
  x: 1,
  y: 1,
  z: 1, // æŠ¥é”™
};
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç­‰å·å³è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å­—é¢é‡ï¼Œè¿™æ—¶ä¼šè§¦å‘ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ã€‚åªè¦æœ‰ç±»å‹å£°æ˜ä¸­ä¸å­˜åœ¨çš„å±æ€§ï¼ˆæœ¬ä¾‹æ˜¯`z`ï¼‰ï¼Œå°±ä¼šå¯¼è‡´æŠ¥é”™ã€‚

å¦‚æœç­‰å·å³è¾¹ä¸æ˜¯å­—é¢é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªå˜é‡ï¼Œæ ¹æ®ç»“æ„ç±»å‹åŸåˆ™ï¼Œæ˜¯ä¸ä¼šæŠ¥é”™çš„:

```TS
const myPoint = {
  x: 1,
  y: 1,
  z: 1,
};

const point: {
  x: number;
  y: number;
} = myPoint; // æ­£ç¡®
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç­‰å·å³è¾¹æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå°±ä¸ä¼šè§¦å‘ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ï¼Œä»è€Œä¸æŠ¥é”™ã€‚

TypeScript å¯¹å­—é¢é‡è¿›è¡Œä¸¥æ ¼æ£€æŸ¥çš„ç›®çš„ï¼Œä¸»è¦æ˜¯é˜²æ­¢æ‹¼å†™é”™è¯¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå­—é¢é‡å¤§å¤šæ•°æ¥è‡ªæ‰‹å†™ï¼Œå®¹æ˜“å‡ºç°æ‹¼å†™é”™è¯¯ï¼Œæˆ–è€…è¯¯ç”¨ APIã€‚

```TS
type Options = {
  title: string;
  darkMode?: boolean;
};

const Obj: Options = {
  title: "æˆ‘çš„ç½‘é¡µ",
  darkmode: true, // æŠ¥é”™
};
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå±æ€§`darkMode`æ‹¼å†™é”™äº†ï¼Œæˆäº†`darkmode`ã€‚å¦‚æœæ²¡æœ‰ä¸¥æ ¼å­—é¢é‡è§„åˆ™ï¼Œå°±ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸º`darkMode`æ˜¯å¯é€‰å±æ€§ï¼Œæ ¹æ®ç»“æ„ç±»å‹åŸåˆ™ï¼Œä»»ä½•å¯¹è±¡åªè¦æœ‰`title`å±æ€§ï¼Œéƒ½è®¤ä¸ºç¬¦åˆ`Options`ç±»å‹ã€‚

è§„é¿ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ï¼Œå¯ä»¥ä½¿ç”¨ä¸­é—´å˜é‡ã€‚

```TS
let myOptions = {
  title: "æˆ‘çš„ç½‘é¡µ",
  darkmode: true,
};

const Obj: Options = myOptions;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªä¸­é—´å˜é‡`myOptions`ï¼Œå°±ä¸ä¼šè§¦å‘ä¸¥æ ¼å­—é¢é‡è§„åˆ™ï¼Œå› ä¸ºè¿™æ—¶å˜é‡`obj`çš„èµ‹å€¼ï¼Œä¸å±äºç›´æ¥å­—é¢é‡èµ‹å€¼ã€‚

å¦‚æœä½ ç¡®è®¤å­—é¢é‡æ²¡æœ‰é”™è¯¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»å‹æ–­è¨€è§„é¿ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ã€‚

```TS
const Obj: Options = {
  title: "æˆ‘çš„ç½‘é¡µ",
  darkmode: true,
} as Options;
```

ä¸Šé¢ç¤ºä¾‹ä½¿ç”¨ç±»å‹æ–­è¨€`as Options`ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå­—é¢é‡ç¬¦åˆ Options ç±»å‹ï¼Œå°±èƒ½è§„é¿è¿™æ¡è§„åˆ™ã€‚

å¦‚æœå…è®¸å­—é¢é‡æœ‰å¤šä½™å±æ€§ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·åœ¨ç±»å‹é‡Œé¢å®šä¹‰ä¸€ä¸ªé€šç”¨å±æ€§ã€‚

```TS
let x: {
  foo: number;
  [x: string]: any;
};

x = { foo: 1, baz: 2 }; // Ok
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`x`çš„ç±»å‹å£°æ˜é‡Œé¢ï¼Œæœ‰ä¸€ä¸ªå±æ€§çš„å­—ç¬¦ä¸²ç´¢å¼•ï¼ˆ`[x: string]`ï¼‰ï¼Œå¯¼è‡´ä»»ä½•å­—ç¬¦ä¸²å±æ€§åéƒ½æ˜¯åˆæ³•çš„ã€‚

ç”±äºä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ï¼Œå­—é¢é‡å¯¹è±¡ä¼ å…¥å‡½æ•°å¿…é¡»å¾ˆå°å¿ƒï¼Œä¸èƒ½æœ‰å¤šä½™çš„å±æ€§ã€‚

```TS
interface Point {
  x: number;
  y: number;
}

function computeDistance(point: Point) {
  /*...*/
}

computeDistance({ x: 1, y: 2, z: 3 }); // æŠ¥é”™
computeDistance({ x: 1, y: 2 }); // æ­£ç¡®
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå¯¹è±¡å­—é¢é‡ä¼ å…¥å‡½æ•°`computeDistance()`æ—¶ï¼Œä¸èƒ½æœ‰å¤šä½™çš„å±æ€§ï¼Œå¦åˆ™å°±é€šä¸è¿‡ä¸¥æ ¼å­—é¢é‡æ£€æŸ¥ã€‚

ç¼–è¯‘å™¨é€‰é¡¹`suppressExcessPropertyErrors`ï¼Œå¯ä»¥å…³é—­å¤šä½™å±æ€§æ£€æŸ¥ã€‚ä¸‹é¢æ˜¯å®ƒåœ¨ `tsconfig.json` æ–‡ä»¶é‡Œé¢çš„å†™æ³•ã€‚

```json
{
  "compilerOptions": {
    "suppressExcessPropertyErrors": true
  }
}
```

### æœ€å°å¯é€‰å±æ€§è§„åˆ™

å¦‚æœä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§éƒ½æ˜¯å¯é€‰çš„ï¼Œä¼šè§¦å‘æœ€å°å¯é€‰å±æ€§è§„åˆ™ã€‚

```TS
type Options = {
  a?: number;
  b?: number;
  c?: number;
};

const obj: Options = {
  d: 123, // æŠ¥é”™
};
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»å‹`Options`æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„æ‰€æœ‰å±æ€§éƒ½æ˜¯å¯é€‰çš„ï¼Œè¿™å¯¼è‡´ä»»ä½•å¯¹è±¡å®é™…éƒ½ç¬¦åˆ`Options`ç±»å‹ã€‚

ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒTypeScript æ·»åŠ äº†æœ€å°å¯é€‰å±æ€§è§„åˆ™ï¼Œè§„å®šè¿™æ—¶å±äº`Options`ç±»å‹çš„å¯¹è±¡ï¼Œå¿…é¡»è‡³å°‘å­˜åœ¨ä¸€ä¸ªå¯é€‰å±æ€§ï¼Œä¸èƒ½æ‰€æœ‰å¯é€‰å±æ€§éƒ½ä¸å­˜åœ¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šä¾‹çš„`myObj`å¯¹è±¡ä¼šæŠ¥é”™çš„åŸå› ã€‚

è¿™æ¡è§„åˆ™æ— æ³•é€šè¿‡ä¸­é—´å˜é‡è§„é¿ã€‚

```TS
const myOptions = { d: 123 };

const obj: Options = myOptions; // æŠ¥é”™
```

### ç©ºå¯¹è±¡

ç©ºå¯¹è±¡æ˜¯ TypeScript çš„ä¸€ç§ç‰¹æ®Šå€¼ï¼Œä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹ã€‚

```TS
const obj = {};
obj.prop = 123; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå˜é‡`obj`çš„å€¼æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç„¶åå¯¹`obj.prop`èµ‹å€¼å°±ä¼šæŠ¥é”™ã€‚

åŸå› æ˜¯è¿™æ—¶ TypeScript ä¼šæ¨æ–­å˜é‡`obj`çš„ç±»å‹ä¸ºç©ºå¯¹è±¡ï¼Œå®é™…æ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„ä»£ç ã€‚

```TS
const obj: {} = {};
```

ç©ºå¯¹è±¡æ²¡æœ‰è‡ªå®šä¹‰å±æ€§ï¼Œæ‰€ä»¥å¯¹è‡ªå®šä¹‰å±æ€§èµ‹å€¼å°±ä¼šæŠ¥é”™ã€‚ç©ºå¯¹è±¡åªèƒ½ä½¿ç”¨ç»§æ‰¿çš„å±æ€§ï¼Œå³ç»§æ‰¿è‡ªåŸå‹å¯¹è±¡`Object.prototype`çš„å±æ€§ã€‚

```TS
obj.toString(); // æ­£ç¡®
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`toString()`æ–¹æ³•æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ªåŸå‹å¯¹è±¡çš„æ–¹æ³•ï¼ŒTypeScript å…è®¸åœ¨ç©ºå¯¹è±¡ä¸Šä½¿ç”¨ã€‚



è¿™ç§ç©ºå¯¹è±¡çš„å†™æ³•å…¶å®åœ¨ JavaScript å¾ˆå¸¸è§ï¼šå…ˆå£°æ˜ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç„¶åå‘ç©ºå¯¹è±¡æ·»åŠ å±æ€§ã€‚ä½†æ˜¯ï¼ŒTypeScript ä¸å…è®¸åŠ¨æ€æ·»åŠ å±æ€§ï¼Œæ‰€ä»¥å¯¹è±¡ä¸èƒ½åˆ†æ­¥ç”Ÿæˆï¼Œå¿…é¡»ç”Ÿæˆæ—¶ä¸€æ¬¡æ€§å£°æ˜æ‰€æœ‰å±æ€§ã€‚

```TS
// é”™è¯¯
const pt = {};
pt.x = 3;
pt.y = 4;

// æ­£ç¡®
const pt = {
  x: 3,
  y: 4,
};
```

å¦‚æœç¡®å®éœ€è¦åˆ†æ­¥å£°æ˜ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆ`...`ï¼‰åˆæˆä¸€ä¸ªæ–°å¯¹è±¡ã€‚

```TS
const pt0 = {};
const pt1 = { x: 3 };
const pt2 = { y: 4 };

const pt = {
  ...pt0,
  ...pt1,
  ...pt2,
};
```

## interface

### å£°æ˜çš„å†…å®¹

#### å¯é€‰å±æ€§

#### åªè¯»å±æ€§

#### ç´¢å¼•ç­¾å

#### å‡½æ•°

#### ç±»

æ¥å£å¯ä»¥çº¦æŸç±»å¿…é¡»å®ç°ï¼ˆ`implements`ï¼‰çš„å…¬å…±æ–¹æ³•å’Œå±æ€§ã€‚

```TS
interface ClockInterface {
  currentTime: Date;
  setTime(d: Date): void;
}

class Clock implements ClockInterface {
  currentTime: Date = new Date(); // å¿…é¡»æœ‰ currentTime å±æ€§
  setTime(d: Date) {              // å¿…é¡»æœ‰ setTime æ–¹æ³•
    this.currentTime = d;
  }
  constructor(h: number, m: number) {}
}

// class DigitalClock implements ClockInterface {
//   // Error: Class 'DigitalClock' incorrectly implements interface 'ClockInterface'.
//   // Property 'currentTime' is missing in type 'DigitalClock' but required in type 'ClockInterface'.
//   setTime(d: Date) { /* ... */ }
// }
```

> [!NOTE]
>
> æ¥å£åªæ£€æŸ¥ç±»çš„**å®ä¾‹éƒ¨åˆ†**ã€‚ç±»çš„é™æ€éƒ¨åˆ†ï¼ˆå¦‚æ„é€ å‡½æ•°ï¼‰ä¸ä¼šè¢«æ¥å£æ£€æŸ¥ã€‚

### interfaceçš„ç»§æ‰¿

#### ç»§æ‰¿interface

#### ç»§æ‰¿type

#### ç»§æ‰¿class

### æ¥å£å£°æ˜çš„åˆå¹¶

å¤šä¸ªåŒåæ¥å£ä¼šåˆå¹¶æˆä¸€ä¸ªæ¥å£:

```TS
interface Box {
  height: number;
  width: number;
}

interface Box {
  length: number;
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ª`Box`æ¥å£ä¼šåˆå¹¶æˆä¸€ä¸ªæ¥å£ï¼ŒåŒæ—¶æœ‰`height`ã€`width`å’Œ`length`ä¸‰ä¸ªå±æ€§ã€‚

### `interface` å¯¹æ¯” `type`

#### ç›¸åŒç‚¹

| åŠŸèƒ½                       | ä¾‹å­                                  |
| -------------------------- | ------------------------------------- |
| å®šä¹‰å¯¹è±¡ç»“æ„               | `{ name: string, age: number }`       |
| ç»™å‡½æ•°å®šä¹‰ç±»å‹             | `(x: number) => string`               |
| ä½¿ç”¨æ³›å‹                   | `interface Box<T> { value: T }`       |
| åœ¨ç±»ä¸­ç”¨ `implements` å®ç° | `class Foo implements Bar`            |
| å®šä¹‰æ•°ç»„æˆ–ç±»æ•°ç»„ç»“æ„       | `{ [index: number]: string }`         |
| å¯é€‰å±æ€§/åªè¯»å±æ€§          | `name?: string; readonly age: number` |

#### ä¸åŒç‚¹

##### å®šä¹‰èƒ½åŠ›

```TS
// âœ… type å¯å®šä¹‰åŸå§‹ç±»å‹
type Name = string;

// âŒ interface åªèƒ½ç”¨äºå¯¹è±¡ç»“æ„
interface Name { } // æ²¡æœ‰å®é™…æ„ä¹‰
```

##### è”åˆä¸äº¤å‰ç±»å‹

```TS
// âœ… type
type A = { a: number };
type B = { b: string };
type C = A | B; // è”åˆç±»å‹
type D = A & B; // äº¤å‰ç±»å‹

// âŒ interface ä¸æ”¯æŒè”åˆ/äº¤å‰
```

##### æ˜ å°„ç±»å‹

```TS
type Readonly<T> = {
  readonly [K in keyof T]: T[K];
};

type Maybe<T> = T extends string ? string[] : T;
```

è¿™äº›éƒ½åªèƒ½ç”¨ `type`ï¼Œ`interface` æ— æ³•å¤„ç†ã€‚

##### å£°æ˜åˆå¹¶

```TS
interface Point {
  x: number;
}
interface Point {
  y: number;
}

const p: Point = { x: 1, y: 2 }; // åˆå¹¶ä¸º { x, y }
```

é€‚ç”¨äºç¬¬ä¸‰æ–¹åº“æ‰©å±•ï¼ˆæ¯”å¦‚å¢å¼º `Window`ã€`Express.Request`ï¼‰

##### ç±»å®ç°

```TS
interface Animal {
  name: string;
  speak(): void;
}

class Dog implements Animal {
  name = "dog";
  speak() { console.log("wang"); }
}
```

è™½ç„¶ `type` ä¹Ÿå¯ä»¥ç”¨äº `implements`ï¼Œä½†è¯­ä¹‰ä¸Šæ›´å€¾å‘ä½¿ç”¨ `interface`ã€‚

#### ä¸€è§ˆè¡¨

| æ¯”è¾ƒç»´åº¦           | `interface`                            | `type`                                         |
| ------------------ | -------------------------------------- | ---------------------------------------------- |
| ğŸ§¾ å®šä¹‰æ–¹å¼         | `interface A {}`                       | `type A = {...}`                               |
| ğŸ§© å®šä¹‰å¯¹è±¡ç»“æ„     | âœ… æ˜¯ï¼Œä¸“é—¨ç”¨äºå¯¹è±¡æè¿°                 | âœ… æ˜¯                                           |
| ğŸ§ª å®šä¹‰åŸå§‹ç±»å‹     | âŒ ä¸æ”¯æŒï¼ˆä¸èƒ½å®šä¹‰ `type A = string`ï¼‰ | âœ… æ”¯æŒåŸå§‹ã€è”åˆã€äº¤å‰ã€å‡½æ•°ã€å…ƒç»„ç­‰æ‰€æœ‰ç±»å‹   |
| â• æ‰©å±•ï¼ˆç»§æ‰¿ï¼‰æ–¹å¼ | `extends`ï¼Œæ”¯æŒå¤šç»§æ‰¿                  | é€šè¿‡äº¤å‰ç±»å‹ `&` æ‰©å±•                          |
| ğŸ” å£°æ˜åˆå¹¶         | âœ… æ”¯æŒï¼ˆå¤šæ¬¡å£°æ˜è‡ªåŠ¨åˆå¹¶ï¼‰             | âŒ ä¸æ”¯æŒï¼Œé‡å¤å®šä¹‰åŒåä¼šæŠ¥é”™                   |
| ğŸ§  æ˜ å°„ç±»å‹æ”¯æŒ     | âŒ ä¸æ”¯æŒæ˜ å°„ç±»å‹                       | âœ… æ”¯æŒï¼Œå¦‚ `Partial<T>`ã€`Record<K, V>` ç­‰     |
| â“ æ¡ä»¶ç±»å‹         | âŒ ä¸æ”¯æŒ                               | âœ… æ”¯æŒ `T extends U ? X : Y`                   |
| â›“ è”åˆ/äº¤å‰ç±»å‹    | âŒ ä¸æ”¯æŒå®šä¹‰è”åˆç±»å‹                   | âœ… type A \| B       type A & B                 |
| ğŸ“¦ å…ƒç»„ã€å‡½æ•°ç±»å‹   | âœ… å‡½æ•°æ”¯æŒï¼›å…ƒç»„ä¸ç›´è§‚                 | âœ… å…¨éƒ¨æ”¯æŒ                                     |
| ğŸ§± ç±» `implements`  | âœ… æ¨èç”¨ interface                     | âœ… ä¹Ÿæ”¯æŒ                                       |
| ğŸ§¬ æ³›å‹æ”¯æŒ         | âœ… æ”¯æŒ                                 | âœ… æ”¯æŒ                                         |
| ğŸ’¥ ç¼–è¯‘æ€§èƒ½         | é«˜ï¼ˆæ›´å¿«ï¼‰                             | ç¨æ…¢ï¼ˆåŠŸèƒ½æ›´å¼ºæ³›å‹æ›´å¤šï¼Œç±»å‹å¤æ‚ï¼‰             |
| âœ… æœ€ä½³ä½¿ç”¨åœºæ™¯     | æè¿°ç±»ã€å¯¹è±¡ç»“æ„ã€å…¬å…± API ç»“æ„ç­‰      | é«˜çº§ç±»å‹æ“ä½œã€ç±»å‹å˜æ¢ã€è”åˆç±»å‹ã€å®ç”¨å·¥å…·ç±»å‹ |

#### æœ€ä½³å®è·µ

| ä½¿ç”¨åœºæ™¯                             | å»ºè®®ä½¿ç”¨      | ç†ç”±                                      |
| ------------------------------------ | ------------- | ----------------------------------------- |
| é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæè¿°ç±»ç»“æ„             | `interface`   | è¯­ä¹‰æ¸…æ™°ï¼Œæ”¯æŒç»§æ‰¿åˆå¹¶ï¼Œå®ç°ç±»çº¦æŸ        |
| å®šä¹‰ç®€å•çš„å¯¹è±¡æˆ–å‡½æ•°ç±»å‹             | ä»»æ„          | éƒ½å¯ä»¥                                    |
| éœ€è¦è”åˆã€äº¤å‰ã€æ˜ å°„ã€æ¡ä»¶ç­‰é«˜çº§ç±»å‹ | `type`        | åªæœ‰ type æ”¯æŒ                            |
| å¤šæ¬¡å£°æ˜ã€æ‹“å±•ç±»å‹ï¼ˆå¦‚å…¨å±€ Windowï¼‰  | `interface`   | æ”¯æŒå£°æ˜åˆå¹¶                              |
| æ„å»ºç»„ä»¶ Propsï¼Œé…åˆå·¥å…·ç±»å‹         | é€šå¸¸ç”¨ `type` | æ›´çµæ´»ï¼Œå¯ç”¨ `Pick`ã€`Omit`ã€`Partial` ç­‰ |
| å®šä¹‰å¤æ‚æ•°æ®ç»“æ„æˆ–å˜æ¢å·¥å…·ç±»å‹       | `type`        | æ”¯æŒç±»å‹è®¡ç®—                              |

## ç±»

### å±æ€§ç´¢å¼•ä¸å‡½æ•°

ç±»å…è®¸å®šä¹‰å±æ€§ç´¢å¼•ã€‚

```TS
class MyClass {
  [s: string]: boolean | ((s: string) => boolean);

  get(s: string) {
    return this[s] as boolean;
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`[s:string]`è¡¨ç¤ºæ‰€æœ‰å±æ€§åç±»å‹ä¸ºå­—ç¬¦ä¸²çš„å±æ€§ï¼Œå®ƒä»¬çš„å±æ€§å€¼è¦ä¹ˆæ˜¯å¸ƒå°”å€¼ï¼Œè¦ä¹ˆæ˜¯è¿”å›å¸ƒå°”å€¼çš„å‡½æ•°ã€‚

æ³¨æ„ï¼Œç”±äºç±»çš„æ–¹æ³•æ˜¯ä¸€ç§ç‰¹æ®Šå±æ€§ï¼ˆå±æ€§å€¼ä¸ºå‡½æ•°çš„å±æ€§ï¼‰ï¼Œæ‰€ä»¥å±æ€§ç´¢å¼•çš„ç±»å‹å®šä¹‰ä¹Ÿæ¶µç›–äº†æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åŒæ—¶å®šä¹‰äº†å±æ€§ç´¢å¼•å’Œæ–¹æ³•ï¼Œé‚£ä¹ˆå‰è€…å¿…é¡»åŒ…å«åè€…çš„ç±»å‹ã€‚

```TS
class MyClass {
  [s: string]: boolean;
  f() {
    // æŠ¥é”™
    return true;
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå±æ€§ç´¢å¼•çš„ç±»å‹é‡Œé¢ä¸åŒ…æ‹¬æ–¹æ³•ï¼Œå¯¼è‡´åé¢çš„æ–¹æ³•`f()`å®šä¹‰ç›´æ¥æŠ¥é”™ã€‚æ­£ç¡®çš„å†™æ³•æ˜¯ä¸‹é¢è¿™æ ·ã€‚

```TS
class MyClass {
  [s: string]: boolean | (() => boolean);
  f() {
    return true;
  }
}
```

### ç±»ä¸­çš„`interface`

#### `implements`

interface æ¥å£æˆ– type åˆ«åï¼Œå¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼ï¼Œä¸º class æŒ‡å®šä¸€ç»„æ£€æŸ¥æ¡ä»¶ã€‚ç„¶åï¼Œç±»ä½¿ç”¨ implements å…³é”®å­—ï¼Œè¡¨ç¤ºå½“å‰ç±»æ»¡è¶³è¿™äº›å¤–éƒ¨ç±»å‹æ¡ä»¶çš„é™åˆ¶ã€‚

```TS
interface Country {
  name: string;
  capital: string;
}
// æˆ–è€…
type Country = {
  name: string;
  capital: string;
};

class MyCountry implements Country {
  name = "";
  capital = "";
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`interface`æˆ–`type`éƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡ç±»å‹ã€‚ç±»`MyCountry`ä½¿ç”¨`implements`å…³é”®å­—ï¼Œè¡¨ç¤ºè¯¥ç±»çš„å®ä¾‹å¯¹è±¡æ»¡è¶³è¿™ä¸ªå¤–éƒ¨ç±»å‹ã€‚

interface åªæ˜¯æŒ‡å®šæ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœä¸æ»¡è¶³è¿™äº›æ¡ä»¶å°±ä¼šæŠ¥é”™ã€‚å®ƒå¹¶ä¸èƒ½ä»£æ›¿ class è‡ªèº«çš„ç±»å‹å£°æ˜ã€‚

```TS
interface A {
  get(name: string): boolean;
}

class B implements A {
  get(s) {
    // s çš„ç±»å‹æ˜¯ any
    return true;
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»`B`å®ç°äº†æ¥å£`A`ï¼Œä½†æ˜¯åè€…å¹¶ä¸èƒ½ä»£æ›¿`B`çš„ç±»å‹å£°æ˜ã€‚å› æ­¤ï¼Œ`B`çš„`get()`æ–¹æ³•çš„å‚æ•°`s`çš„ç±»å‹æ˜¯`any`ï¼Œè€Œä¸æ˜¯`string`ã€‚`B`ç±»ä¾ç„¶éœ€è¦å£°æ˜å‚æ•°`s`çš„ç±»å‹ã€‚

```TS
class B implements A {
  get(s: string) {
    return true;
  }
}
```

ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­:

```TS
interface A {
  x: number;
  y?: number;
}

class B implements A {
  x = 0;
}

const b = new B();
b.y = 10; // æŠ¥é”™
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ¥å£`A`æœ‰ä¸€ä¸ªå¯é€‰å±æ€§`y`ï¼Œç±»`B`æ²¡æœ‰å£°æ˜è¿™ä¸ªå±æ€§ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç±»å‹æ£€æŸ¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœç»™`B`çš„å®ä¾‹å¯¹è±¡çš„å±æ€§`y`èµ‹å€¼ï¼Œå°±ä¼šæŠ¥é”™ã€‚æ‰€ä»¥ï¼Œ`B`ç±»è¿˜æ˜¯éœ€è¦å£°æ˜å¯é€‰å±æ€§`y`ã€‚

***

ç±»å¯ä»¥å®šä¹‰æ¥å£æ²¡æœ‰å£°æ˜çš„æ–¹æ³•å’Œå±æ€§:

```TS
interface Point {
  x: number;
  y: number;
}

class MyPoint implements Point {
  x = 1;
  y = 1;
  z: number = 1;
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`MyPoint`ç±»å®ç°äº†`Point`æ¥å£ï¼Œä½†æ˜¯å†…éƒ¨è¿˜å®šä¹‰äº†ä¸€ä¸ªé¢å¤–çš„å±æ€§`z`ï¼Œè¿™æ˜¯å…è®¸çš„ï¼Œè¡¨ç¤ºé™¤äº†æ»¡è¶³æ¥å£ç»™å‡ºçš„æ¡ä»¶ï¼Œç±»è¿˜æœ‰é¢å¤–çš„æ¡ä»¶ã€‚

---

`implements`å…³é”®å­—åé¢ï¼Œä¸ä»…å¯ä»¥æ˜¯æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªç±»ã€‚è¿™æ—¶ï¼Œåé¢çš„ç±»å°†è¢«å½“ä½œæ¥å£ã€‚

```TS
class Car {
  id: number = 1;
  move(): void {}
}

class MyCar implements Car {
  id = 2; // ä¸å¯çœç•¥
  move(): void {} // ä¸å¯çœç•¥
}
```

---

interface æè¿°çš„æ˜¯ç±»çš„å¯¹å¤–æ¥å£ï¼Œä¹Ÿå°±æ˜¯å®ä¾‹çš„å…¬å¼€å±æ€§å’Œå…¬å¼€æ–¹æ³•ï¼Œä¸èƒ½å®šä¹‰ç§æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™æ˜¯å› ä¸º TypeScript è®¾è®¡è€…è®¤ä¸ºï¼Œç§æœ‰å±æ€§æ˜¯ç±»çš„å†…éƒ¨å®ç°ï¼Œæ¥å£ä½œä¸ºæ¨¡æ¿ï¼Œä¸åº”è¯¥æ¶‰åŠç±»çš„å†…éƒ¨ä»£ç å†™æ³•ã€‚

```TS
interface MyInterface {
  // private myPrivateProperty: string; // Error: An interface property cannot be private or protected.
  // protected myProtectedProperty: string; // Error: An interface property cannot be private or protected.

  public myPublicProperty: string; // OK (public æ˜¯é»˜è®¤çš„ï¼Œé€šå¸¸çœç•¥)
  myAnotherPublicProperty: number; // OK (é»˜è®¤å°±æ˜¯ public)
}
```

#### å®ç°å¤šä¸ªæ¥å£

ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼ˆå…¶å®æ˜¯æ¥å—å¤šé‡é™åˆ¶ï¼‰ï¼Œæ¯ä¸ªæ¥å£ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ã€‚

```TS
class Car implements MotorVehicle, Flyable, Swimmable {
  // ...
}
```

#### ç±»ä¸æ¥å£çš„åˆå¹¶

TypeScript ä¸å…è®¸ä¸¤ä¸ªåŒåçš„ç±»ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªç±»å’Œä¸€ä¸ªæ¥å£åŒåï¼Œé‚£ä¹ˆæ¥å£ä¼šè¢«åˆå¹¶è¿›ç±»ã€‚

```TS
class A {
  x: number = 1;
}

interface A {
  y: number;
}

let a = new A();
a.y = 10;

a.x; // 1
a.y; // 10
```

### å®ä¾‹å±æ€§çš„ç®€å†™å½¢å¼

å®é™…å¼€å‘ä¸­ï¼Œå¾ˆå¤šå®ä¾‹å±æ€§çš„å€¼ï¼Œæ˜¯é€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥çš„,å¸¸è§„å†™æ³•ï¼š

```TS
class Point {
  x: number;
  y: number;

  constructor(x: number, y: number) {
    this.x = x;
    this.y = y;
  }
}
```

è¿™æ ·çš„å†™æ³•ç­‰äºå¯¹åŒä¸€ä¸ªå±æ€§è¦å£°æ˜ä¸¤æ¬¡ç±»å‹ï¼Œä¸€æ¬¡åœ¨ç±»çš„å¤´éƒ¨ï¼Œå¦ä¸€æ¬¡åœ¨æ„é€ æ–¹æ³•çš„å‚æ•°é‡Œé¢ã€‚è¿™æœ‰äº›ç´¯èµ˜ï¼ŒTypeScript å°±æä¾›äº†ä¸€ç§ç®€å†™å½¢å¼:

```TS
class Point {
  constructor(public x: number, public y: number) {}
}

const p = new Point(10, 10);
p.x; // 10
p.y; // 10
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ„é€ æ–¹æ³•çš„å‚æ•°`x`å‰é¢æœ‰`public`ä¿®é¥°ç¬¦ï¼Œè¿™æ—¶ TypeScript å°±ä¼šè‡ªåŠ¨å£°æ˜ä¸€ä¸ªå…¬å¼€å±æ€§`x`ï¼Œä¸å¿…åœ¨æ„é€ æ–¹æ³•é‡Œé¢å†™ä»»ä½•ä»£ç ï¼ŒåŒæ—¶è¿˜ä¼šè®¾ç½®`x`çš„å€¼ä¸ºæ„é€ æ–¹æ³•çš„å‚æ•°å€¼ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„`public`ä¸èƒ½çœç•¥ã€‚

é™¤äº†`public`ä¿®é¥°ç¬¦ï¼Œæ„é€ æ–¹æ³•çš„å‚æ•°ååªè¦æœ‰`private`ã€`protected`ã€`readonly`ä¿®é¥°ç¬¦ï¼Œéƒ½ä¼šè‡ªåŠ¨å£°æ˜å¯¹åº”ä¿®é¥°ç¬¦çš„å®ä¾‹å±æ€§ã€‚

```TS
class A {
  constructor(
    public a: number,
    protected b: number,
    private c: number,
    readonly d: number
  ) {}
}

// ç¼–è¯‘ç»“æœ
class A {
  a;
  b;
  c;
  d;
  constructor(a, b, c, d) {
    this.a = a;
    this.b = b;
    this.c = c;
    this.d = d;
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œä»ç¼–è¯‘ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œæ„é€ æ–¹æ³•çš„`a`ã€`b`ã€`c`ã€`d`ä¼šç”Ÿæˆå¯¹åº”çš„å®ä¾‹å±æ€§ã€‚

`readonly`è¿˜å¯ä»¥ä¸å…¶ä»–ä¸‰ä¸ªå¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼Œä¸€èµ·ä½¿ç”¨ã€‚

```TS
class A {
  constructor(
    public readonly x: number,
    protected readonly y: number,
    private readonly z: number
  ) {}
}
```

## æ³›å‹

### ç±»å‹åˆ«åä¸­çš„æ³›å‹

```TS
type Nullable<T> = T | undefined | null;
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`Nullable<T>`æ˜¯ä¸€ä¸ªæ³›å‹ï¼Œåªè¦ä¼ å…¥ä¸€ä¸ªç±»å‹ï¼Œå°±å¯ä»¥å¾—åˆ°è¿™ä¸ªç±»å‹ä¸`undefined`å’Œ`null`çš„ä¸€ä¸ªè”åˆç±»å‹ã€‚

### ç±»å‹å‚æ•°çš„é»˜è®¤å€¼

ç±»å‹å‚æ•°å¯ä»¥è®¾ç½®é»˜è®¤å€¼ã€‚ä½¿ç”¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºç±»å‹å‚æ•°çš„å€¼ï¼Œå°±ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚

```TS
function getFirst<T = string>(arr: T[]): T {
  return arr[0];
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`T = string`è¡¨ç¤ºç±»å‹å‚æ•°çš„é»˜è®¤å€¼æ˜¯`string`ã€‚è°ƒç”¨`getFirst()`æ—¶ï¼Œå¦‚æœä¸ç»™å‡º`T`çš„å€¼ï¼ŒTypeScript å°±è®¤ä¸º`T`ç­‰äº`string`ã€‚

ä½†æ˜¯ï¼Œå› ä¸º TypeScript ä¼šä»å®é™…å‚æ•°æ¨æ–­å‡º`T`çš„å€¼ï¼Œä»è€Œè¦†ç›–æ‰é»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä»£ç ä¸ä¼šæŠ¥é”™ã€‚

```TS
getFirst([1, 2, 3]); // æ­£ç¡®
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå®é™…å‚æ•°æ˜¯`[1, 2, 3]`ï¼ŒTypeScript æ¨æ–­ T ç­‰äº`number`ï¼Œä»è€Œè¦†ç›–æ‰é»˜è®¤å€¼`string`ã€‚

ç±»å‹å‚æ•°çš„é»˜è®¤å€¼ï¼Œå¾€å¾€ç”¨åœ¨ç±»ä¸­:

```TS
class Generic<T = string> {
  list: T[] = [];

  add(t: T) {
    this.list.push(t);
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»`Generic`æœ‰ä¸€ä¸ªç±»å‹å‚æ•°`T`ï¼Œé»˜è®¤å€¼ä¸º`string`ã€‚è¿™æ„å‘³ç€ï¼Œå±æ€§`list`é»˜è®¤æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ–¹æ³•`add()`çš„é»˜è®¤å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

```TS
const g = new Generic();

g.add(4); // æŠ¥é”™
g.add("hello"); // æ­£ç¡®
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ–°å»º`Generic`çš„å®ä¾‹`g`æ—¶ï¼Œæ²¡æœ‰ç»™å‡ºç±»å‹å‚æ•°`T`çš„å€¼ï¼Œæ‰€ä»¥`T`å°±ç­‰äº`string`ã€‚å› æ­¤ï¼Œå‘`add()`æ–¹æ³•ä¼ å…¥ä¸€ä¸ªæ•°å€¼ä¼šæŠ¥é”™ï¼Œä¼ å…¥å­—ç¬¦ä¸²å°±ä¸ä¼šã€‚

### ç±»å‹å‚æ•°çš„çº¦æŸæ¡ä»¶

å¾ˆå¤šç±»å‹å‚æ•°å¹¶ä¸æ˜¯æ— é™åˆ¶çš„ï¼Œå¯¹äºä¼ å…¥çš„ç±»å‹å­˜åœ¨çº¦æŸæ¡ä»¶ã€‚

```TS
function comp<Type>(a: Type, b: Type) {
  if (a.length >= b.length) {
    return a;
  }
  return b;
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»å‹å‚æ•° Type æœ‰ä¸€ä¸ªéšè—çš„çº¦æŸæ¡ä»¶ï¼šå®ƒå¿…é¡»å­˜åœ¨`length`å±æ€§ã€‚å¦‚æœä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå°±ä¼šæŠ¥é”™ã€‚

TypeScript æä¾›äº†ä¸€ç§è¯­æ³•ï¼Œå…è®¸åœ¨ç±»å‹å‚æ•°ä¸Šé¢å†™æ˜çº¦æŸæ¡ä»¶ï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œç¼–è¯‘æ—¶å°±ä¼šæŠ¥é”™ã€‚è¿™æ ·ä¹Ÿå¯ä»¥æœ‰è‰¯å¥½çš„è¯­ä¹‰ï¼Œå¯¹ç±»å‹å‚æ•°è¿›è¡Œè¯´æ˜ã€‚

```TS
function comp<T extends { length: number }>(a: T, b: T) {
  if (a.length >= b.length) {
    return a;
  }
  return b;
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`T extends { length: number }`å°±æ˜¯çº¦æŸæ¡ä»¶ï¼Œè¡¨ç¤ºç±»å‹å‚æ•° T å¿…é¡»æ»¡è¶³`{ length: number }`ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚

```TS
comp([1, 2], [1, 2, 3]); // æ­£ç¡®
comp("ab", "abc"); // æ­£ç¡®
comp(1, 2); // æŠ¥é”™
```

*åŒæ—¶æŒ‡å®šçº¦æŸå’Œé»˜è®¤å€¼ï¼š*

```TS
// å®šä¹‰ä¸€ä¸ªåŸºç¡€æ¥å£ï¼Œç¡®ä¿æ³›å‹ç±»å‹å…·æœ‰ value å±æ€§
interface Wrapper<T> {
  value: T;
}

// Box æ¥å£ï¼šT å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­— (çº¦æŸ)ï¼Œé»˜è®¤ä¸ºå­—ç¬¦ä¸² (é»˜è®¤å€¼)
interface Box<T extends string | number = string> extends Wrapper<T> {
  label: string;
}

// 1. ä¸æŒ‡å®š Tï¼Œä½¿ç”¨é»˜è®¤ç±»å‹ string
const box1: Box = {
  value: "hello", // T é»˜è®¤ä¸º string
  label: "Message"
};
// const boxError1: Box = { value: 123, label: "Invalid" }; // Error: Type 'number' is not assignable to type 'string'.

// 2. æ˜ç¡®æŒ‡å®š T ä¸º number (ç¬¦åˆçº¦æŸ)
const box2: Box<number> = {
  value: 42, // T æ˜ç¡®ä¸º number
  label: "Answer"
};

// 3. æ˜ç¡®æŒ‡å®š T ä¸º boolean (ä¸ç¬¦åˆçº¦æŸ)
// const boxError2: Box<boolean> = { value: true, label: "Boolean Box" }; // Error: Type 'boolean' does not satisfy the constraint 'string | number'.
```

## Enum

### æˆå‘˜çš„å€¼

#### å€¼ç±»å‹

##### æ•°å€¼

æˆå‘˜çš„å€¼å¯ä»¥æ˜¯ä»»æ„æ•°å€¼ï¼Œä½†ä¸èƒ½æ˜¯å¤§æ•´æ•°ï¼ˆBigintï¼‰

```TS
enum Color {
  Red = 90,
  Green = 0.5,
  Blue = 7n, // æŠ¥é”™
}
```

##### å­—ç¬¦ä¸²

```TS
enum Direction {
  Up = "UP",
  Down = "DOWN",
  Left = "LEFT",
  Right = "RIGHT",
}
```

> [!NOTE]
>
> å­—ç¬¦ä¸²æšä¸¾çš„æ‰€æœ‰æˆå‘˜å€¼ï¼Œéƒ½å¿…é¡»æ˜¾å¼è®¾ç½®ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œæˆå‘˜å€¼é»˜è®¤ä¸ºæ•°å€¼ï¼Œä¸”ä½ç½®å¿…é¡»åœ¨å­—ç¬¦ä¸²æˆå‘˜ä¹‹å‰ã€‚

```TS
enum Foo {
  A, // 0
  B = "hello",
  C, // æŠ¥é”™
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`A`ä¹‹å‰æ²¡æœ‰å…¶ä»–æˆå‘˜ï¼Œæ‰€ä»¥å¯ä»¥ä¸è®¾ç½®åˆå§‹å€¼ï¼Œé»˜è®¤ç­‰äº`0`ï¼›`C`ä¹‹å‰æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²æˆå‘˜ï¼Œå¿…é¡»`C`å¿…é¡»æœ‰åˆå§‹å€¼ï¼Œä¸èµ‹å€¼å°±æŠ¥é”™äº†ã€‚

##### æ··åˆä½¿ç”¨

```TS
enum Enum {
  One = "One",
  Two = "Two",
  Three = 3,
  Four = 4,
}
```



#### å¯é‡å¤

```TS
enum Color {
  Red = 0,
  Green = 0,
  Blue = 0,
}
```

#### å¯è¿ç®—

```TS
enum asd {
  a = 2 >> 3,
  b = 3 + 3,
}
```

#### åªè¯»

Enum æˆå‘˜å€¼éƒ½æ˜¯åªè¯»çš„ï¼Œä¸èƒ½é‡æ–°èµ‹å€¼ã€‚

```TS
enum Color {
  Red,
  Green,
  Blue,
}

Color.Red = 4; // æŠ¥é”™
```

ä¸ºäº†è®©è¿™ä¸€ç‚¹æ›´é†’ç›®ï¼Œé€šå¸¸ä¼šåœ¨ enum å…³é”®å­—å‰é¢åŠ ä¸Š`const`ä¿®é¥°ï¼Œè¡¨ç¤ºè¿™æ˜¯å¸¸é‡ï¼Œä¸èƒ½å†æ¬¡èµ‹å€¼ã€‚

```TS
const enum Color {
  Red,
  Green,
  Blue,
}
```

åŠ ä¸Š`const`çš„ç‰¹ç‚¹ï¼š

1. åœ¨ç¼–è¯‘æ—¶ä¼šè¢« **å†…è”ä¸ºå…·ä½“å€¼**ï¼Œä¸ç”Ÿæˆé¢å¤–ä»£ç ã€‚
2. æ— æ³•ä½¿ç”¨ `Color[0]` è¿™ç§åæŸ¥è¯­æ³•ã€‚
3. ä¸èƒ½å’Œ `computed`ï¼ˆè®¡ç®—å€¼ï¼‰ç»„åˆã€‚

ç¼–è¯‘å‰ï¼š

```TS
const enum season {
	winter,
	autumn,
}

enum day {
	Friday,
	Wednesday,
}


const a = season.winter

const b = day.Friday
```

ç¼–è¯‘åï¼š

```JS
var day;
(function (day) {
    day[day["Friday"] = 0] = "Friday";
    day[day["Wednesday"] = 1] = "Wednesday";
})(day || (day = {}));
day.Friday = 1;
var a = 0 /* season.winter */;
var b = day.Friday;
```



### åŒåEnumçš„åˆå¹¶

å¤šä¸ªåŒåçš„ Enum ç»“æ„ä¼šè‡ªåŠ¨åˆå¹¶ã€‚

```TS
enum Foo {
  A,
}

enum Foo {
  B = 1,
}

enum Foo {
  C = 2,
}

// ç­‰åŒäº
enum Foo {
  A,
  B = 1ï¼Œ
  C = 2
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`Foo`åˆ†æˆä¸‰æ®µå®šä¹‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠå®ƒä»¬åˆå¹¶ã€‚

#### æ³¨æ„ç‚¹

1. Enum ç»“æ„åˆå¹¶æ—¶ï¼Œåªå…è®¸å…¶ä¸­ä¸€ä¸ªçš„é¦–æˆå‘˜çœç•¥åˆå§‹å€¼ï¼Œå¦åˆ™æŠ¥é”™:

```TS
enum Foo {
  A,
}

enum Foo {
  B, // æŠ¥é”™
}
```

2. åŒå Enum åˆå¹¶æ—¶ï¼Œä¸èƒ½æœ‰åŒåæˆå‘˜ï¼Œå¦åˆ™æŠ¥é”™:

```TS
enum Foo {
  A,
  B,
}

enum Foo {
  B = 1, // æŠ¥é”™
  C,
}
```

3. æ‰€æœ‰å®šä¹‰å¿…é¡»åŒä¸º const æšä¸¾æˆ–è€…é const æšä¸¾ï¼Œä¸å…è®¸æ··åˆä½¿ç”¨:

```TS
// æ­£ç¡®
enum E {
  A,
}
enum E {
  B = 1,
}

// æ­£ç¡®
const enum E {
  A,
}
const enum E {
  B = 1,
}

// æŠ¥é”™
enum E {
  A,
}
const enum E2 {
  B = 1,
}
```

### åå‘æ˜ å°„

æ•°å€¼ Enum å­˜åœ¨åå‘æ˜ å°„ï¼Œå³å¯ä»¥é€šè¿‡æˆå‘˜å€¼è·å¾—æˆå‘˜åã€‚

```TS
enum Weekdays {
  Monday = 1,
  Tuesday,
  Wednesday,
  Thursday,
  Friday,
  Saturday,
  Sunday,
}

console.log(Weekdays[3]); // Wednesday
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼ŒEnum æˆå‘˜`Wednesday`çš„å€¼ç­‰äº 3ï¼Œä»è€Œå¯ä»¥ä»æˆå‘˜å€¼`3`å–åˆ°å¯¹åº”çš„æˆå‘˜å`Wednesday`ï¼Œè¿™å°±å«åå‘æ˜ å°„ã€‚

è¿™æ˜¯å› ä¸º TypeScript ä¼šå°†ä¸Šé¢çš„ Enum ç»“æ„ï¼Œç¼–è¯‘æˆä¸‹é¢çš„ JavaScript ä»£ç ã€‚

```JS
var Weekdays;
(function (Weekdays) {
  Weekdays[(Weekdays["Monday"] = 1)] = "Monday";
  Weekdays[(Weekdays["Tuesday"] = 2)] = "Tuesday";
  Weekdays[(Weekdays["Wednesday"] = 3)] = "Wednesday";
  Weekdays[(Weekdays["Thursday"] = 4)] = "Thursday";
  Weekdays[(Weekdays["Friday"] = 5)] = "Friday";
  Weekdays[(Weekdays["Saturday"] = 6)] = "Saturday";
  Weekdays[(Weekdays["Sunday"] = 7)] = "Sunday";
})(Weekdays || (Weekdays = {}));
```

## è£…é¥°å™¨

**è£…é¥°å™¨ï¼ˆDecoratorsï¼‰** æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å£°æ˜ï¼Œå®ƒèƒ½å¤Ÿ**é™„åŠ åˆ°ç±»å£°æ˜ã€æ–¹æ³•ã€è®¿é—®å™¨ã€å±æ€§æˆ–å‚æ•°ä¸Š**ã€‚å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯**å‡½æ•°**ï¼Œåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ï¼Œå¹¶èƒ½å¤Ÿ**ä¿®æ”¹æˆ–æ‰©å±•**å…¶æ‰€é™„åŠ å£°æ˜çš„è¡Œä¸ºã€‚

å¯ä»¥æŠŠè£…é¥°å™¨æƒ³è±¡æˆä¸€ä¸ªâ€œåŒ…è£…å™¨â€æˆ–â€œå…ƒæ•°æ®æ³¨å…¥å™¨â€ã€‚å®ƒä»¬è®©ä½ å¯ä»¥åœ¨**ä¸ä¿®æ”¹åŸå§‹ç±»/æ–¹æ³•ä»£ç **çš„æƒ…å†µä¸‹ï¼Œä¸ºå…¶æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€ä¿®æ”¹å…¶å…ƒæ•°æ®æˆ–è§‚å¯Ÿå…¶è¡Œä¸ºã€‚

- **è¯­æ³•**ï¼šè£…é¥°å™¨ä½¿ç”¨ `@expression` è¿™ç§å½¢å¼ï¼Œå…¶ä¸­ `expression` å¿…é¡»æ±‚å€¼ä¸ºä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ï¼Œå¹¶è·å¾—è¢«è£…é¥°å£°æ˜çš„ä¿¡æ¯ã€‚
- **æ‰§è¡Œæ—¶æœº**ï¼šè£…é¥°å™¨åœ¨**è¿è¡Œæ—¶**æ‰§è¡Œï¼Œä½†å®ƒä»¬æ˜¯åœ¨**ç¼–è¯‘æ—¶**ï¼ˆTypeScript ç¼–è¯‘æˆ JavaScript æ—¶ï¼‰è¢«å¤„ç†å’Œæ³¨å…¥çš„ã€‚

### å¯ç”¨è£…é¥°å™¨

ç”±äºè£…é¥°å™¨æ˜¯å®éªŒæ€§ç‰¹æ€§ï¼Œä½ éœ€è¦åœ¨ `tsconfig.json` ä¸­è¿›è¡Œé…ç½®æ‰èƒ½ä½¿ç”¨å®ƒä»¬ï¼š

```JSON
{
  "compilerOptions": {
    "target": "ES5",             /* æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¦‚ ES2015 */
    "experimentalDecorators": true, /* å¯ç”¨å®éªŒæ€§è£…é¥°å™¨ */
    "emitDecoratorMetadata": true  /* (å¯é€‰) å¯ç”¨å‘å°„è£…é¥°å™¨å…ƒæ•°æ®ï¼Œç”¨äºåå°„ï¼Œå¦‚ TypeORMã€Angular DI */
  }
}
```

### è£…é¥°å™¨ç»“æ„

```TS
type Decorator = (
  value: DecoratedValue,
  context: {
    kind: string;
    name: string | symbol;
    addInitializer?(initializer: () => void): void;
    static?: boolean;
    private?: boolean;
    access: {
      get?(): unknown;
      set?(value: unknown): void;
    };
  }
) => void | ReplacementValue;
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`Decorator`æ˜¯è£…é¥°å™¨çš„ç±»å‹å®šä¹‰ã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨æ—¶ä¼šæ¥æ”¶åˆ°`value`å’Œ`context`ä¸¤ä¸ªå‚æ•°ã€‚

- `value`ï¼šæ‰€è£…é¥°çš„å¯¹è±¡ã€‚
- `context`ï¼šä¸Šä¸‹æ–‡å¯¹è±¡ï¼ŒTypeScript æä¾›ä¸€ä¸ªåŸç”Ÿæ¥å£`ClassMethodDecoratorContext`ï¼Œæè¿°è¿™ä¸ªå¯¹è±¡ã€‚

```TS
function decorator(value: any, context: ClassMethodDecoratorContext) {
  // ...
}
```

ä¸Šé¢æ˜¯ä¸€ä¸ªè£…é¥°å™¨å‡½æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°`context`çš„ç±»å‹å°±å¯ä»¥å†™æˆ`ClassMethodDecoratorContext`ã€‚

`context`å¯¹è±¡çš„å±æ€§ï¼Œæ ¹æ®æ‰€è£…é¥°å¯¹è±¡çš„ä¸åŒè€Œä¸åŒï¼Œå…¶ä¸­åªæœ‰ä¸¤ä¸ªå±æ€§ï¼ˆ`kind`å’Œ`name`ï¼‰æ˜¯å¿…æœ‰çš„ï¼Œå…¶ä»–éƒ½æ˜¯å¯é€‰çš„ã€‚

ï¼ˆ1ï¼‰`kind`ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ‰€è£…é¥°å¯¹è±¡çš„ç±»å‹ï¼Œå¯èƒ½å–ä»¥ä¸‹çš„å€¼ã€‚

- 'class'
- 'method'
- 'getter'
- 'setter'
- 'field'
- 'accessor'

è¿™è¡¨ç¤ºä¸€å…±æœ‰å…­ç§ç±»å‹çš„è£…é¥°å™¨ã€‚

ï¼ˆ2ï¼‰`name`ï¼šå­—ç¬¦ä¸²æˆ–è€… Symbol å€¼ï¼Œæ‰€è£…é¥°å¯¹è±¡çš„åå­—ï¼Œæ¯”å¦‚ç±»åã€å±æ€§åç­‰ã€‚

ï¼ˆ3ï¼‰`addInitializer()`ï¼šå‡½æ•°ï¼Œç”¨æ¥æ·»åŠ ç±»çš„åˆå§‹åŒ–é€»è¾‘ã€‚ä»¥å‰ï¼Œè¿™äº›é€»è¾‘é€šå¸¸æ”¾åœ¨æ„é€ å‡½æ•°é‡Œé¢ï¼Œå¯¹æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œç°åœ¨æ”¹æˆä»¥å‡½æ•°å½¢å¼ä¼ å…¥`addInitializer()`æ–¹æ³•ã€‚æ³¨æ„ï¼Œ`addInitializer()`æ²¡æœ‰è¿”å›å€¼ã€‚

ï¼ˆ4ï¼‰`private`ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ‰€è£…é¥°çš„å¯¹è±¡æ˜¯å¦ä¸ºç±»çš„ç§æœ‰æˆå‘˜ã€‚

ï¼ˆ5ï¼‰`static`ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ‰€è£…é¥°çš„å¯¹è±¡æ˜¯å¦ä¸ºç±»çš„é™æ€æˆå‘˜ã€‚

ï¼ˆ6ï¼‰`access`ï¼šä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†æŸä¸ªå€¼çš„ get å’Œ set æ–¹æ³•ã€‚

### ç±»è£…é¥°å™¨

ç±»è£…é¥°å™¨çš„ç±»å‹æè¿°å¦‚ä¸‹ã€‚

```TS
type ClassDecorator = (
  value: Function,
  context: {
    kind: "class";
    name: string | undefined;
    addInitializer(initializer: () => void): void;
  }
) => Function | void;
```

ç±»è£…é¥°å™¨æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š`value`ï¼ˆå½“å‰ç±»æœ¬èº«ï¼‰å’Œ`context`ï¼ˆä¸Šä¸‹æ–‡å¯¹è±¡ï¼‰ã€‚å…¶ä¸­ï¼Œ`context`å¯¹è±¡çš„`kind`å±æ€§å›ºå®šä¸ºå­—ç¬¦ä¸²`class`ã€‚

ç±»è£…é¥°å™¨ä¸€èˆ¬ç”¨æ¥å¯¹ç±»è¿›è¡Œæ“ä½œï¼Œå¯ä»¥ä¸è¿”å›ä»»ä½•å€¼ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

```TS
function Greeter(value, context) {
  if (context.kind === "class") {
    value.prototype.greet = function () {
      console.log("ä½ å¥½");
    };
  }
}

@Greeter
class User {}

let u = new User();
u.greet(); // "ä½ å¥½"
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»è£…é¥°å™¨`@Greeter`åœ¨ç±»`User`çš„åŸå‹å¯¹è±¡ä¸Šï¼Œæ·»åŠ äº†ä¸€ä¸ª`greet()`æ–¹æ³•ï¼Œå®ä¾‹å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥æ–¹æ³•ã€‚

ç±»è£…é¥°å™¨å¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ›¿ä»£å½“å‰ç±»çš„æ„é€ æ–¹æ³•:

```TS
function countInstances(value: any, context: any) {
  let instanceCount = 0; // â‘  é—­åŒ…å˜é‡ï¼Œç”¨äºè·Ÿè¸ªå®ä¾‹æ•°é‡

  const wrapper = function (...args: any[]) { // â‘¡ æ›¿ä»£åŸå§‹æ„é€ å‡½æ•°çš„æ–°æ„é€ å‡½æ•°
    instanceCount++; // æ¯æ¬¡è°ƒç”¨æ–°æ„é€ å‡½æ•°æ—¶ï¼Œå®ä¾‹è®¡æ•°é€’å¢
    const instance = new value(...args); // â‘¢ ä½¿ç”¨åŸå§‹æ„é€ å‡½æ•°åˆ›å»ºå®é™…å®ä¾‹
    instance.count = instanceCount; // â‘£ ä¸ºæ–°å®ä¾‹æ·»åŠ ä¸€ä¸ª 'count' å±æ€§
    return instance;
  } as unknown as typeof MyClass; // â‘¤ ç±»å‹æ–­è¨€ï¼Œç¡®ä¿ TypeScript è®¤ä¸ºè¿™æ˜¯ MyClass çš„æ„é€ å‡½æ•°

  wrapper.prototype = value.prototype; // â‘¥ å…³é”®ä¸€æ­¥ï¼šå°†æ–°æ„é€ å‡½æ•°çš„åŸå‹æŒ‡å‘åŸå§‹æ„é€ å‡½æ•°çš„åŸå‹
  return wrapper; // â‘¦ è¿”å›æ–°æ„é€ å‡½æ•°ï¼Œæ›¿æ¢æ‰åŸå§‹ç±»
}

@countInstances
class MyClass {}

const inst1 = new MyClass();
inst1 instanceof MyClass; // true
inst1.count; // 1
```

> [!NOTE]
>
> ä¸Šä¾‹ä¸ºäº†ç¡®ä¿æ–°æ„é€ æ–¹æ³•ç»§æ‰¿å®šä¹‰åœ¨`MyClass`çš„åŸå‹ä¹‹ä¸Šçš„æˆå‘˜ï¼Œç‰¹åˆ«åŠ å…¥`A`è¡Œï¼Œç¡®ä¿ä¸¤è€…çš„åŸå‹å¯¹è±¡æ˜¯ä¸€è‡´çš„ã€‚å¦åˆ™ï¼Œæ–°çš„æ„é€ å‡½æ•°`wrapper`çš„åŸå‹å¯¹è±¡ï¼Œä¸`MyClass`ä¸åŒï¼Œé€šä¸è¿‡`instanceof`è¿ç®—ç¬¦ã€‚

ç±»è£…é¥°å™¨ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„ç±»ï¼Œæ›¿ä»£åŸæ¥æ‰€è£…é¥°çš„ç±»ï¼š

```TS
function countInstances(value: any, context: any) {
  let instanceCount = 0;

  return class extends value {
    constructor(...args: any[]) {
      super(...args);
      instanceCount++;
      this.count = instanceCount;
    }
  };
}

@countInstances
class MyClass {}

const inst1 = new MyClass();
inst1 instanceof MyClass; // true
inst1.count; // 1
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`@countInstances`è¿”å›ä¸€ä¸ª`MyClass`çš„å­ç±»ã€‚

ä¸‹é¢çš„ä¾‹å­æ˜¯é€šè¿‡ç±»è£…é¥°å™¨ï¼Œç¦æ­¢ä½¿ç”¨`new`å‘½ä»¤æ–°å»ºç±»çš„å®ä¾‹:

```TS
function functionCallable(
  value as any, {kind} as any
) {
  if (kind === 'class') {
    return function (...args) {
      if (new.target !== undefined) {
        throw new TypeError('This function canâ€™t be new-invoked');
      }
      return new value(...args);
    }
  }
}

@functionCallable
class Person {
  constructor(name) {
    this.name = name;
  }
}
const robin = Person('Robin');
robin.name // 'Robin'
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»è£…é¥°å™¨`@functionCallable`è¿”å›ä¸€ä¸ªæ–°çš„æ„é€ æ–¹æ³•ï¼Œé‡Œé¢åˆ¤æ–­`new.target`æ˜¯å¦ä¸ä¸ºç©ºï¼Œå¦‚æœæ˜¯ï¼Œå°±è¡¨ç¤ºé€šè¿‡`new`å‘½ä»¤è°ƒç”¨ï¼Œä»è€ŒæŠ¥é”™ã€‚

ç±»è£…é¥°å™¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡`context`çš„`addInitializer()`æ–¹æ³•ï¼Œç”¨æ¥å®šä¹‰ä¸€ä¸ªç±»çš„åˆå§‹åŒ–å‡½æ•°ï¼Œåœ¨ç±»å®Œå…¨å®šä¹‰ç»“æŸåæ‰§è¡Œã€‚

```TS
function customElement(name: string) {
  return <Input extends new (...args: any) => any>(
    value: Input,
    context: ClassDecoratorContext
  ) => {
    context.addInitializer(function () {
      customElements.define(name, value);
    });
  };
}

@customElement("hello-world")
class MyComponent extends HTMLElement {
  constructor() {
    super();
  }
  connectedCallback() {
    this.innerHTML = `<h1>Hello World</h1>`;
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»`MyComponent`å®šä¹‰å®Œæˆåï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œç±»è£…é¥°å™¨`@customElement()`ç»™å‡ºçš„åˆå§‹åŒ–å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šå°†å½“å‰ç±»æ³¨å†Œä¸ºæŒ‡å®šåç§°ï¼ˆæœ¬ä¾‹ä¸º`<hello-world>`ï¼‰çš„è‡ªå®šä¹‰ HTML å…ƒç´ ã€‚

### æ–¹æ³•è£…é¥°å™¨

æ–¹æ³•è£…é¥°å™¨ç”¨æ¥è£…é¥°ç±»çš„æ–¹æ³•ï¼ˆmethodï¼‰ã€‚å®ƒçš„ç±»å‹æè¿°å¦‚ä¸‹:

```TS
type ClassMethodDecorator = (
  value: Function,
  context: {
    kind: "method";
    name: string | symbol;
    static: boolean;
    private: boolean;
    access: { get: () => unknown };
    addInitializer(initializer: () => void): void;
  }
) => Function | void;
```

æ ¹æ®ä¸Šé¢çš„ç±»å‹ï¼Œæ–¹æ³•è£…é¥°å™¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š`value`å’Œ`context`ã€‚

å‚æ•°`value`æ˜¯æ–¹æ³•æœ¬èº«ï¼Œå‚æ•°`context`æ˜¯ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å±æ€§ã€‚

- `kind`ï¼šå€¼å›ºå®šä¸ºå­—ç¬¦ä¸²`method`ï¼Œè¡¨ç¤ºå½“å‰ä¸ºæ–¹æ³•è£…é¥°å™¨ã€‚
- `name`ï¼šæ‰€è£…é¥°çš„æ–¹æ³•åï¼Œç±»å‹ä¸ºå­—ç¬¦ä¸²æˆ– Symbol å€¼ã€‚
- `static`ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦ä¸ºé™æ€æ–¹æ³•ã€‚è¯¥å±æ€§ä¸ºåªè¯»å±æ€§ã€‚
- `private`ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦ä¸ºç§æœ‰æ–¹æ³•ã€‚è¯¥å±æ€§ä¸ºåªè¯»å±æ€§ã€‚
- `access`ï¼šå¯¹è±¡ï¼ŒåŒ…å«äº†æ–¹æ³•çš„å­˜å–å™¨ï¼Œä½†æ˜¯åªæœ‰`get()`æ–¹æ³•ç”¨æ¥å–å€¼ï¼Œæ²¡æœ‰`set()`æ–¹æ³•è¿›è¡Œèµ‹å€¼ã€‚
- `addInitializer()`ï¼šä¸ºæ–¹æ³•å¢åŠ åˆå§‹åŒ–å‡½æ•°ã€‚

æ–¹æ³•è£…é¥°å™¨ä¼šæ”¹å†™ç±»çš„åŸå§‹æ–¹æ³•ï¼Œå®è´¨ç­‰åŒäºä¸‹é¢çš„æ“ä½œ:

```TS
function trace(decoratedMethod) {
  // ...
}

class C {
  @trace
  toString() {
    return "C";
  }
}

// @trace` ç­‰åŒäº
// C.prototype.toString = trace(C.prototype.toString);
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`@trace`æ˜¯æ–¹æ³•`toString()`çš„è£…é¥°å™¨ï¼Œå®ƒçš„æ•ˆæœç­‰åŒäºæœ€åä¸€è¡Œå¯¹`toString()`çš„æ”¹å†™ã€‚

å¦‚æœæ–¹æ³•è£…é¥°å™¨è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå°±ä¼šæ›¿ä»£æ‰€è£…é¥°çš„åŸå§‹å‡½æ•°ã€‚

```TS
function replaceMethod() {
  return function () {
    return `How are you, ${this.name}?`;
  };
}

class Person {
  constructor(name) {
    this.name = name;
  }

  @replaceMethod
  hello() {
    return `Hi ${this.name}!`;
  }
}

const robin = new Person("Robin");

robin.hello(); // 'How are you, Robin?'
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œè£…é¥°å™¨`@replaceMethod`è¿”å›çš„å‡½æ•°ï¼Œå°±æˆä¸ºäº†æ–°çš„`hello()`æ–¹æ³•ã€‚

ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚

```TS
class Person {
  name: string;
  constructor(name: string) {
    this.name = name;
  }

  @log
  greet() {
    console.log(`Hello, my name is ${this.name}.`);
  }
}

function log(originalMethod: any, context: ClassMethodDecoratorContext) {
  const methodName = String(context.name);

  function replacementMethod(this: any, ...args: any[]) {
    console.log(`LOG: Entering method '${methodName}'.`);
    const result = originalMethod.call(this, ...args);
    console.log(`LOG: Exiting method '${methodName}'.`);
    return result;
  }

  return replacementMethod;
}

const person = new Person("å¼ ä¸‰");
person.greet();
// "LOG: Entering method 'greet'."
// "Hello, my name is å¼ ä¸‰."
// "LOG: Exiting method 'greet'."
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œè£…é¥°å™¨`@log`çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°`replacementMethod`ï¼Œæ›¿ä»£äº†åŸå§‹æ–¹æ³•`greet()`ã€‚åœ¨`replacementMethod()`å†…éƒ¨ï¼Œé€šè¿‡æ‰§è¡Œ`originalMethod.call()`å®Œæˆäº†å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ã€‚

åˆ©ç”¨æ–¹æ³•è£…é¥°å™¨ï¼Œå¯ä»¥å°†ç±»çš„æ–¹æ³•å˜æˆå»¶è¿Ÿæ‰§è¡Œã€‚

```TS
function delay(milliseconds: number = 0) {
  return function (value, context) {
    if (context.kind === "method") {
      return function (...args: any[]) {
        setTimeout(() => {
          value.apply(this, args);
        }, milliseconds);
      };
    }
  };
}

class Logger {
  @delay(1000)
  log(msg: string) {
    console.log(`${msg}`);
  }
}

let logger = new Logger();
logger.log("Hello World");
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ–¹æ³•è£…é¥°å™¨`@delay(1000)`å°†æ–¹æ³•`log()`çš„æ‰§è¡Œæ¨è¿Ÿäº† 1 ç§’ï¼ˆ1000 æ¯«ç§’ï¼‰ã€‚è¿™é‡ŒçœŸæ­£çš„æ–¹æ³•è£…é¥°å™¨ï¼Œæ˜¯`delay()`æ‰§è¡Œåè¿”å›çš„å‡½æ•°ï¼Œ`delay()`çš„ä½œç”¨æ˜¯æ¥æ”¶å‚æ•°ï¼Œç”¨æ¥è®¾ç½®æ¨è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚è¿™ç§é€šè¿‡é«˜é˜¶å‡½æ•°è¿”å›è£…é¥°å™¨çš„åšæ³•ï¼Œç§°ä¸ºâ€œå·¥å‚æ¨¡å¼â€ï¼Œå³å¯ä»¥åƒå·¥å‚é‚£æ ·ç”Ÿäº§å‡ºä¸€ä¸ªæ¨¡å­çš„è£…é¥°å™¨ã€‚

æ–¹æ³•è£…é¥°å™¨çš„å‚æ•°`context`å¯¹è±¡é‡Œé¢ï¼Œæœ‰ä¸€ä¸ª`addInitializer()`æ–¹æ³•ã€‚å®ƒæ˜¯ä¸€ä¸ªé’©å­æ–¹æ³•ï¼Œç”¨æ¥åœ¨ç±»çš„åˆå§‹åŒ–é˜¶æ®µï¼Œæ·»åŠ å›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯ä½œä¸º`addInitializer()`çš„å‚æ•°ä¼ å…¥çš„ï¼Œå®ƒä¼šåœ¨æ„é€ æ–¹æ³•æ‰§è¡ŒæœŸé—´æ‰§è¡Œï¼Œæ—©äºå±æ€§ï¼ˆfieldï¼‰çš„åˆå§‹åŒ–ã€‚

ä¸‹é¢æ˜¯`addInitializer()`æ–¹æ³•çš„ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç±»çš„æ–¹æ³•å¾€å¾€éœ€è¦åœ¨æ„é€ æ–¹æ³•é‡Œé¢ï¼Œè¿›è¡Œ`this`çš„ç»‘å®šã€‚

```TS
class Person {
  name: string;
  constructor(name: string) {
    this.name = name;

    // greet() ç»‘å®š this
    this.greet = this.greet.bind(this);
  }

  greet() {
    console.log(`Hello, my name is ${this.name}.`);
  }
}

const g = new Person("å¼ ä¸‰").greet;
g(); // "Hello, my name is å¼ ä¸‰."
```

ä¸Šé¢ä¾‹å­ä¸­ï¼Œç±»`Person`çš„æ„é€ æ–¹æ³•å†…éƒ¨ï¼Œå°†`this`ä¸`greet()`æ–¹æ³•è¿›è¡Œäº†ç»‘å®šã€‚å¦‚æœæ²¡æœ‰è¿™ä¸€è¡Œï¼Œå°†`greet()`èµ‹å€¼ç»™å˜é‡`g`è¿›è¡Œè°ƒç”¨ï¼Œå°±ä¼šæŠ¥é”™äº†ã€‚

`this`çš„ç»‘å®šå¿…é¡»æ”¾åœ¨æ„é€ æ–¹æ³•é‡Œé¢ï¼Œå› ä¸ºè¿™å¿…é¡»åœ¨ç±»çš„åˆå§‹åŒ–é˜¶æ®µå®Œæˆã€‚ç°åœ¨ï¼Œå®ƒå¯ä»¥ç§»åˆ°æ–¹æ³•è£…é¥°å™¨çš„`addInitializer()`é‡Œé¢ã€‚

```TS
function bound(originalMethod: any, context: ClassMethodDecoratorContext) {
  const methodName = context.name;
  if (context.private) {
    throw new Error(`ä¸èƒ½ç»‘å®šç§æœ‰æ–¹æ³• ${methodName as string}`);
  }
  context.addInitializer(function () {
    this[methodName] = this[methodName].bind(this);
  });
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç»‘å®š`this`è½¬ç§»åˆ°äº†`addInitializer()`æ–¹æ³•é‡Œé¢ã€‚

ä¸‹é¢å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡`addInitializer()`å°†é€‰å®šçš„æ–¹æ³•åï¼Œæ”¾å…¥ä¸€ä¸ªé›†åˆã€‚

```TS
function collect(value, { name, addInitializer }) {
  addInitializer(function () {
    if (!this.collectedMethodKeys) {
      this.collectedMethodKeys = new Set();
    }
    this.collectedMethodKeys.add(name);
  });
}

class C {
  @collect
  toString() {}

  @collect
  [Symbol.iterator]() {}
}

const inst = new C();
inst.collectedMethodKeys; // new Set(['toString', Symbol.iterator])
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ–¹æ³•è£…é¥°å™¨`@collect`ä¼šå°†æ‰€è£…é¥°çš„æˆå‘˜åå­—ï¼ŒåŠ å…¥ä¸€ä¸ª Set é›†åˆ`collectedMethodKeys`ã€‚

### å±æ€§è£…é¥°å™¨

å±æ€§è£…é¥°å™¨ç”¨æ¥è£…é¥°å®šä¹‰åœ¨ç±»é¡¶éƒ¨çš„å±æ€§ï¼ˆfieldï¼‰ã€‚å®ƒçš„ç±»å‹æè¿°å¦‚ä¸‹ï¼š

```TS
type ClassFieldDecorator = (
  value: undefined,
  context: {
    kind: "field";
    name: string | symbol;
    static: boolean;
    private: boolean;
    access: { get: () => unknown; set: (value: unknown) => void };
    addInitializer(initializer: () => void): void;
  }
) => (initialValue: unknown) => unknown | void;
```

> [!NOTE]
>
> è£…é¥°å™¨çš„ç¬¬ä¸€ä¸ªå‚æ•°`value`çš„ç±»å‹æ˜¯`undefined`ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªå‚æ•°å®é™…ä¸Šæ²¡ç”¨çš„ï¼Œè£…é¥°å™¨ä¸èƒ½ä»`value`è·å–æ‰€è£…é¥°å±æ€§çš„å€¼ã€‚å¦å¤–ï¼Œç¬¬äºŒä¸ªå‚æ•°`context`å¯¹è±¡çš„`kind`å±æ€§çš„å€¼ä¸ºå­—ç¬¦ä¸²`field`ï¼Œè€Œä¸æ˜¯â€œpropertyâ€æˆ–â€œattributeâ€ï¼Œè¿™ä¸€ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ã€‚

å±æ€§è£…é¥°å™¨è¦ä¹ˆä¸è¿”å›å€¼ï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œç”¨æ¥å¯¹æ‰€è£…é¥°å±æ€§è¿›è¡Œåˆå§‹åŒ–ã€‚è¯¥å‡½æ•°çš„å‚æ•°æ˜¯æ‰€è£…é¥°å±æ€§çš„åˆå§‹å€¼ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼æ˜¯è¯¥å±æ€§çš„æœ€ç»ˆå€¼ã€‚

```TS
function logged(value, context) {
  const { kind, name } = context;
  if (kind === "field") {
    return function (initialValue) {
      console.log(`initializing ${name} with value ${initialValue}`);
      return initialValue;
    };
  }
}

class Color {
  @logged name = "green";
}

const color = new Color();
// "initializing name with value green"
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå±æ€§è£…é¥°å™¨`@logged`è£…é¥°å±æ€§`name`ã€‚`@logged`çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨æ¥å¯¹å±æ€§`name`è¿›è¡Œåˆå§‹åŒ–ï¼Œå®ƒçš„å‚æ•°`initialValue`å°±æ˜¯å±æ€§`name`çš„åˆå§‹å€¼`green`ã€‚æ–°å»ºå®ä¾‹å¯¹è±¡`color`æ—¶ï¼Œè¯¥å‡½æ•°ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚

å±æ€§è£…é¥°å™¨çš„è¿”å›å€¼å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥æ›´æ”¹å±æ€§çš„åˆå§‹å€¼:

```TS
function twice() {
  return (initialValue) => initialValue * 2;
}

class C {
  @twice
  field = 3;
}

const inst = new C();
inst.field; // 6
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå±æ€§è£…é¥°å™¨`@twice`è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼æ˜¯å±æ€§`field`çš„åˆå§‹å€¼ä¹˜ä»¥ 2ï¼Œæ‰€ä»¥å±æ€§`field`çš„æœ€ç»ˆå€¼æ˜¯ 6ã€‚

å±æ€§è£…é¥°å™¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡`context`çš„`access`å±æ€§ï¼Œæä¾›æ‰€è£…é¥°å±æ€§çš„å­˜å–å™¨ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­:

```TS
let acc;

function exposeAccess(value, { access }) {
  acc = access;
}

class Color {
  @exposeAccess
  name = "green";
}

const green = new Color();
green.name; // 'green'

acc.get(green); // 'green'

acc.set(green, "red");
green.name; // 'red'
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`access`åŒ…å«äº†å±æ€§`name`çš„å­˜å–å™¨ï¼Œå¯ä»¥å¯¹è¯¥å±æ€§è¿›è¡Œå–å€¼å’Œèµ‹å€¼ã€‚

### getter/setterè£…é¥°å™¨

getter è£…é¥°å™¨å’Œ setter è£…é¥°å™¨ï¼Œæ˜¯åˆ†åˆ«é’ˆå¯¹ç±»çš„å–å€¼å™¨ï¼ˆgetterï¼‰å’Œå­˜å€¼å™¨ï¼ˆsetterï¼‰çš„è£…é¥°å™¨ã€‚å®ƒä»¬çš„ç±»å‹æè¿°å¦‚ä¸‹:

```TS
type ClassGetterDecorator = (
  value: Function,
  context: {
    kind: "getter";
    name: string | symbol;
    static: boolean;
    private: boolean;
    access: { get: () => unknown };
    addInitializer(initializer: () => void): void;
  }
) => Function | void;

type ClassSetterDecorator = (
  value: Function,
  context: {
    kind: "setter";
    name: string | symbol;
    static: boolean;
    private: boolean;
    access: { set: (value: unknown) => void };
    addInitializer(initializer: () => void): void;
  }
) => Function | void;
```

> [!NOTE]
>
> getter è£…é¥°å™¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡`context`çš„`access`å±æ€§ï¼ŒåªåŒ…å«`get()`æ–¹æ³•ï¼›setter è£…é¥°å™¨çš„`access`å±æ€§ï¼ŒåªåŒ…å«`set()`æ–¹æ³•ã€‚

è¿™ä¸¤ä¸ªè£…é¥°å™¨è¦ä¹ˆä¸è¿”å›å€¼ï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå–ä»£åŸæ¥çš„å–å€¼å™¨æˆ–å­˜å€¼å™¨ã€‚

ä¸‹é¢çš„ä¾‹å­æ˜¯å°†å–å€¼å™¨çš„ç»“æœï¼Œä¿å­˜ä¸ºä¸€ä¸ªå±æ€§ï¼ŒåŠ å¿«åé¢çš„è¯»å–:

```TS
class C {
  @lazy
  get value() {
    console.log("æ­£åœ¨è®¡ç®—â€¦â€¦");
    return "å¼€é”€å¤§çš„è®¡ç®—ç»“æœ";
  }
}

function lazy(value: any, { kind, name }: any) {
  // `value`: è¢«è£…é¥°çš„ getter æ–¹æ³•æœ¬èº«ï¼ˆå³ C ç±»çš„ get value() å‡½æ•°ï¼‰
  // `context`: è£…é¥°å™¨ä¸Šä¸‹æ–‡å¯¹è±¡
  //   `context.kind`: æŒ‡ç¤ºè¢«è£…é¥°çš„æˆå‘˜ç±»å‹ï¼Œè¿™é‡Œæ˜¯ "getter"
  //   `context.name`: è¢«è£…é¥°æˆå‘˜çš„åç§°ï¼Œè¿™é‡Œæ˜¯ "value"

  if (kind === "getter") { // ç¡®è®¤è£…é¥°å™¨åº”ç”¨äº getter
    // è£…é¥°å™¨è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†æ›¿æ¢åŸå§‹çš„ getter
    return function (this: any) {
      console.log("æ­£åœ¨è®¡ç®—â€¦â€¦"); // åŸå§‹çš„è®¡ç®—é€»è¾‘
      const result = value.call(this); // â‘  è°ƒç”¨åŸå§‹çš„ getter æ–¹æ³•è·å–ç»“æœ

      // â‘¡ å…³é”®æ­¥éª¤ï¼šç”¨ä¸€ä¸ªæ™®é€šçš„æ•°æ®å±æ€§æ›¿æ¢æ‰ getter
      Object.defineProperty(this, name, {
        value: result,    // æ–°å±æ€§çš„å€¼å°±æ˜¯ç¬¬ä¸€æ¬¡è®¡ç®—çš„ç»“æœ
        writable: false,  // è®¾ç½®ä¸ºä¸å¯å†™ï¼Œé˜²æ­¢å¤–éƒ¨ä¿®æ”¹
      });

      return result; // â‘¢ è¿”å›è®¡ç®—ç»“æœ
    };
  }
  return; // å¦‚æœä¸æ˜¯ getterï¼Œåˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œ
}

const inst = new C();
inst.value;
// æ­£åœ¨è®¡ç®—â€¦â€¦
// 'å¼€é”€å¤§çš„è®¡ç®—ç»“æœ'
inst.value;
// 'å¼€é”€å¤§çš„è®¡ç®—ç»“æœ'
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç¬¬ä¸€æ¬¡è¯»å–`inst.value`ï¼Œä¼šè¿›è¡Œè®¡ç®—ï¼Œç„¶åè£…é¥°å™¨`@lazy`å°†ç»“æœå­˜å…¥åªè¯»å±æ€§`value`ï¼Œåé¢å†è¯»å–è¿™ä¸ªå±æ€§ï¼Œå°±ä¸ä¼šè¿›è¡Œè®¡ç®—äº†ã€‚

### accessorè£…é¥°å™¨

```TS
class C {
  accessor x = 1;
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`accessor`ä¿®é¥°ç¬¦ç­‰åŒäºä¸ºå±æ€§`x`è‡ªåŠ¨ç”Ÿæˆå–å€¼å™¨å’Œå­˜å€¼å™¨ï¼Œå®ƒä»¬ä½œç”¨äºç§æœ‰å±æ€§`x`ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä»£ç ç­‰åŒäºä¸‹é¢çš„ä»£ç ã€‚

```TS
class C {
  #x = 1;

  get x() {
    return this.#x;
  }

  set x(val) {
    this.#x = val;
  }
}
```

accessor è£…é¥°å™¨çš„ç±»å‹å¦‚ä¸‹ã€‚

```TS
type ClassAutoAccessorDecorator = (
  value: {
    get: () => unknown;
    set: (value: unknown) => void;
  },
  context: {
    kind: "accessor";
    name: string | symbol;
    access: { get(): unknown; set(value: unknown): void };
    static: boolean;
    private: boolean;
    addInitializer(initializer: () => void): void;
  }
) => {
  get?: () => unknown;
  set?: (value: unknown) => void;
  init?: (initialValue: unknown) => unknown;
} | void;
```

accessor è£…é¥°å™¨çš„`value`å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªåŒ…å«`get()`æ–¹æ³•å’Œ`set()`æ–¹æ³•çš„å¯¹è±¡ã€‚è¯¥è£…é¥°å™¨å¯ä»¥ä¸è¿”å›å€¼ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œç”¨æ¥å–ä»£åŸæ¥çš„`get()`æ–¹æ³•å’Œ`set()`æ–¹æ³•ã€‚æ­¤å¤–ï¼Œè£…é¥°å™¨è¿”å›çš„å¯¹è±¡è¿˜å¯ä»¥åŒ…æ‹¬ä¸€ä¸ª`init()`æ–¹æ³•ï¼Œç”¨æ¥æ”¹å˜ç§æœ‰å±æ€§çš„åˆå§‹å€¼ã€‚

ç¤ºä¾‹ï¼š

```TS
class C {
  @logged accessor x = 1;
}

function logged(value, { kind, name }) {
  if (kind === "accessor") {
    let { get, set } = value;

    return {
      get() {
        console.log(`getting ${name}`);

        return get.call(this);
      },

      set(val) {
        console.log(`setting ${name} to ${val}`);

        return set.call(this, val);
      },

      init(initialValue) {
        console.log(`initializing ${name} with value ${initialValue}`);
        return initialValue;
      },
    };
  }
}

let c = new C();

c.x;
// getting x

c.x = 123;
// setting x to 123
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œè£…é¥°å™¨`@logged`ä¸ºå±æ€§`x`çš„å­˜å€¼å™¨å’Œå–å€¼å™¨ï¼ŒåŠ ä¸Šäº†æ—¥å¿—è¾“å‡ºã€‚

### è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº

è£…é¥°å™¨çš„æ‰§è¡Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µã€‚

ï¼ˆ1ï¼‰è¯„ä¼°ï¼ˆevaluationï¼‰ï¼šè®¡ç®—`@`ç¬¦å·åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼Œå¾—åˆ°çš„åº”è¯¥æ˜¯å‡½æ•°ã€‚

ï¼ˆ2ï¼‰åº”ç”¨ï¼ˆapplicationï¼‰ï¼šå°†è¯„ä¼°è£…é¥°å™¨åå¾—åˆ°çš„å‡½æ•°ï¼Œåº”ç”¨äºæ‰€è£…é¥°å¯¹è±¡ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼Œå…ˆè¯„ä¼°æ‰€æœ‰è£…é¥°å™¨è¡¨è¾¾å¼çš„å€¼ï¼Œå†å°†å…¶åº”ç”¨äºå½“å‰ç±»ã€‚

åº”ç”¨è£…é¥°å™¨æ—¶ï¼Œé¡ºåºä¾æ¬¡ä¸ºæ–¹æ³•è£…é¥°å™¨å’Œå±æ€§è£…é¥°å™¨ï¼Œç„¶åæ˜¯ç±»è£…é¥°å™¨ã€‚

ç¤ºä¾‹ï¼š

```TS
function d(str: string) {
  console.log(`è¯„ä¼° @d(): ${str}`);
  return (value: any, context: any) => console.log(`åº”ç”¨ @d(): ${str}`);
}

function log(str: string) {
  console.log(str);
  return str;
}

@d("ç±»è£…é¥°å™¨")
class T {
  @d("é™æ€å±æ€§è£…é¥°å™¨")
  static staticField = log("é™æ€å±æ€§å€¼");

  @d("åŸå‹æ–¹æ³•")
  [log("è®¡ç®—æ–¹æ³•å")]() {}

  @d("å®ä¾‹å±æ€§")
  instanceField = log("å®ä¾‹å±æ€§å€¼");
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»`T`æœ‰å››ç§è£…é¥°å™¨ï¼šç±»è£…é¥°å™¨ã€é™æ€å±æ€§è£…é¥°å™¨ã€æ–¹æ³•è£…é¥°å™¨ã€å±æ€§è£…é¥°å™¨ã€‚

å®ƒçš„è¿è¡Œç»“æœå¦‚ä¸‹:

```TS
// "è¯„ä¼° @d(): ç±»è£…é¥°å™¨"
// "è¯„ä¼° @d(): é™æ€å±æ€§è£…é¥°å™¨"
// "è¯„ä¼° @d(): åŸå‹æ–¹æ³•"
// "è®¡ç®—æ–¹æ³•å"
// "è¯„ä¼° @d(): å®ä¾‹å±æ€§"
// "åº”ç”¨ @d(): åŸå‹æ–¹æ³•"
// "åº”ç”¨ @d(): é™æ€å±æ€§è£…é¥°å™¨"
// "åº”ç”¨ @d(): å®ä¾‹å±æ€§"
// "åº”ç”¨ @d(): ç±»è£…é¥°å™¨"
// "é™æ€å±æ€§å€¼"
```

å¯ä»¥çœ‹åˆ°ï¼Œç±»è½½å…¥çš„æ—¶å€™ï¼Œä»£ç æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ‰§è¡Œã€‚

ï¼ˆ1ï¼‰è£…é¥°å™¨è¯„ä¼°ï¼šè¿™ä¸€æ­¥è®¡ç®—è£…é¥°å™¨çš„å€¼ï¼Œé¦–å…ˆæ˜¯ç±»è£…é¥°å™¨ï¼Œç„¶åæ˜¯ç±»å†…éƒ¨çš„è£…é¥°å™¨ï¼ŒæŒ‰ç…§å®ƒä»¬å‡ºç°çš„é¡ºåºã€‚

æ³¨æ„ï¼Œå¦‚æœå±æ€§åæˆ–æ–¹æ³•åæ˜¯è®¡ç®—å€¼ï¼ˆæœ¬ä¾‹æ˜¯â€œè®¡ç®—æ–¹æ³•åâ€ï¼‰ï¼Œåˆ™å®ƒä»¬åœ¨å¯¹åº”çš„è£…é¥°å™¨è¯„ä¼°ä¹‹åï¼Œä¹Ÿä¼šè¿›è¡Œè‡ªèº«çš„è¯„ä¼°ã€‚

ï¼ˆ2ï¼‰è£…é¥°å™¨åº”ç”¨ï¼šå®é™…æ‰§è¡Œè£…é¥°å™¨å‡½æ•°ï¼Œå°†å®ƒä»¬ä¸å¯¹åº”çš„æ–¹æ³•å’Œå±æ€§è¿›è¡Œç»“åˆã€‚

åŸå‹æ–¹æ³•çš„è£…é¥°å™¨é¦–å…ˆåº”ç”¨ï¼Œç„¶åæ˜¯é™æ€å±æ€§å’Œé™æ€æ–¹æ³•è£…é¥°å™¨ï¼Œæ¥ä¸‹æ¥æ˜¯å®ä¾‹å±æ€§è£…é¥°å™¨ï¼Œæœ€åæ˜¯ç±»è£…é¥°å™¨ã€‚

> [!NOTE]
>
> â€œå®ä¾‹å±æ€§å€¼â€åœ¨ç±»åˆå§‹åŒ–çš„é˜¶æ®µå¹¶ä¸æ‰§è¡Œï¼Œç›´åˆ°ç±»å®ä¾‹åŒ–æ—¶æ‰ä¼šæ‰§è¡Œã€‚

å¦‚æœä¸€ä¸ªæ–¹æ³•æˆ–å±æ€§æœ‰å¤šä¸ªè£…é¥°å™¨ï¼Œåˆ™å†…å±‚çš„è£…é¥°å™¨å…ˆæ‰§è¡Œï¼Œå¤–å±‚çš„è£…é¥°å™¨åæ‰§è¡Œã€‚

```TS
class Person {
  name: string;
  constructor(name: string) {
    this.name = name;
  }

  @bound
  @log
  greet() {
    console.log(`Hello, my name is ${this.name}.`);
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`greet()`æœ‰ä¸¤ä¸ªè£…é¥°å™¨ï¼Œå†…å±‚çš„`@log`å…ˆæ‰§è¡Œï¼Œå¤–å±‚çš„`@bound`é’ˆå¯¹å¾—åˆ°çš„ç»“æœå†æ‰§è¡Œã€‚

## ç±»å‹è¿ç®—ç¬¦

### keyof

keyof æ˜¯ä¸€ä¸ªå•ç›®è¿ç®—ç¬¦ï¼Œæ¥å—ä¸€ä¸ªå¯¹è±¡ç±»å‹ä½œä¸ºå‚æ•°ï¼Œè¿”å›è¯¥å¯¹è±¡çš„æ‰€æœ‰é”®åç»„æˆçš„è”åˆç±»å‹ã€‚

```TS
type MyObj = {
  foo: number;
  bar: string;
};

type Keys = keyof MyObj; // 'foo'|'bar'
```

```TS
interface T {
  0: boolean;
  a: string;
  b(): void;
}

type KeyT = keyof T; // 0 | 'a' | 'b'
```



å¦‚æœæƒ³å–å‡ºé”®å€¼ç»„æˆçš„è”åˆç±»å‹ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™:

```TS
type MyObj = {
  foo: number;
  bar: string;
};

type Keys = keyof MyObj;

type Values = MyObj[Keys]; // number|string
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`Keys`æ˜¯é”®åç»„æˆçš„è”åˆç±»å‹ï¼Œè€Œ`MyObj[Keys]`ä¼šå–å‡ºæ¯ä¸ªé”®åå¯¹åº”çš„é”®å€¼ç±»å‹ï¼Œç»„æˆä¸€ä¸ªæ–°çš„è”åˆç±»å‹ï¼Œå³`number|string`ã€‚



ç”±äº JavaScript å¯¹è±¡çš„é”®ååªæœ‰ä¸‰ç§ç±»å‹ï¼Œæ‰€ä»¥å¯¹äºä»»æ„å¯¹è±¡çš„é”®åçš„è”åˆç±»å‹å°±æ˜¯`string|number|symbol`:

```TS
// string | number | symbol
type KeyT = keyof any;
```

å¯¹äºæ²¡æœ‰è‡ªå®šä¹‰é”®åçš„ç±»å‹ä½¿ç”¨ keyof è¿ç®—ç¬¦ï¼Œè¿”å›`never`ç±»å‹ï¼Œè¡¨ç¤ºä¸å¯èƒ½æœ‰è¿™æ ·ç±»å‹çš„é”®å:

```TS
// ç”±äºobjectç±»å‹æ²¡æœ‰è‡ªèº«çš„å±æ€§ï¼Œä¹Ÿå°±æ²¡æœ‰é”®åï¼Œæ‰€ä»¥keyof objectè¿”å›neverç±»å‹ã€‚
type KeyT = keyof object; // never
```

#### æ•°ç»„ã€å…ƒç»„

å¦‚æœ keyof è¿ç®—ç¬¦ç”¨äºæ•°ç»„æˆ–å…ƒç»„ç±»å‹ï¼Œå¾—åˆ°çš„ç»“æœå¯èƒ½å‡ºäººæ„æ–™ã€‚

```TS
type Result = keyof ["a", "b", "c"];
// è¿”å› number | "0" | "1" | "2"
// | "length" | "pop" | "push" | Â·Â·Â·
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œkeyof ä¼šè¿”å›æ•°ç»„çš„æ‰€æœ‰é”®åï¼ŒåŒ…æ‹¬æ•°å­—é”®åå’Œç»§æ‰¿çš„é”®åã€‚

#### è”åˆç±»å‹

å¯¹äºè”åˆç±»å‹ï¼Œkeyof è¿”å›æˆå‘˜å…±æœ‰çš„é”®åã€‚

```TS
type A = { a: string; z: boolean };
type B = { b: string; z: boolean };

// è¿”å› 'z'
type KeyT = keyof (A | B);
```

#### äº¤å‰ç±»å‹

å¯¹äºäº¤å‰ç±»å‹ï¼Œkeyof è¿”å›æ‰€æœ‰é”®åã€‚

```TS
type A = { a: string; x: boolean };
type B = { b: string; y: number };

// è¿”å› 'a' | 'x' | 'b' | 'y'
type KeyT = keyof (A & B);

// ç›¸å½“äº
keyof (A & B) â‰¡ keyof A | keyof B
```

### in

`in`è¿ç®—ç¬¦ç”¨æ¥ç¡®å®šå¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªå±æ€§åã€‚

```TS
const obj = { a: 123 };

if ("a" in obj) console.log("found a");
```



### []

æ–¹æ‹¬å·è¿ç®—ç¬¦ï¼ˆ`[]`ï¼‰ç”¨äºå–å‡ºå¯¹è±¡çš„é”®å€¼ç±»å‹ï¼Œæ¯”å¦‚`T[K]`ä¼šè¿”å›å¯¹è±¡`T`çš„å±æ€§`K`çš„ç±»å‹ã€‚

```TS
type Person = {
  age: number;
  name: string;
  alive: boolean;
};

// Age çš„ç±»å‹æ˜¯ number
type Age = Person["age"];
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`Person['age']`è¿”å›å±æ€§`age`çš„ç±»å‹ï¼Œæœ¬ä¾‹æ˜¯`number`ã€‚

æ–¹æ‹¬å·çš„å‚æ•°å¦‚æœæ˜¯è”åˆç±»å‹ï¼Œé‚£ä¹ˆè¿”å›çš„ä¹Ÿæ˜¯è”åˆç±»å‹:

```TS
type Person = {
  age: number;
  name: string;
  alive: boolean;
};

// number|string
type T = Person["age" | "name"];

// number|string|boolean
type A = Person[keyof Person];
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ–¹æ‹¬å·é‡Œé¢æ˜¯å±æ€§åçš„è”åˆç±»å‹ï¼Œæ‰€ä»¥è¿”å›çš„ä¹Ÿæ˜¯å¯¹åº”çš„å±æ€§å€¼çš„è”åˆç±»å‹ã€‚

å¦‚æœè®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¼šæŠ¥é”™:

```TS
type T = Person["notExisted"]; // æŠ¥é”™
```

æ–¹æ‹¬å·è¿ç®—ç¬¦çš„å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å±æ€§åçš„ç´¢å¼•ç±»å‹:

```TS
type Obj = {
  [key: string]: number;
};

// number
type T = Obj[string];
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`Obj`çš„å±æ€§åæ˜¯å­—ç¬¦ä¸²çš„ç´¢å¼•ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆ`Obj[string]`ï¼Œä»£è¡¨æ‰€æœ‰å­—ç¬¦ä¸²å±æ€§åï¼Œè¿”å›çš„å°±æ˜¯å®ƒä»¬çš„ç±»å‹`number`ã€‚

è¿™ä¸ªè¯­æ³•å¯¹äºæ•°ç»„ä¹Ÿé€‚ç”¨ï¼Œå¯ä»¥ä½¿ç”¨`number`ä½œä¸ºæ–¹æ‹¬å·çš„å‚æ•°:

```TS
// MyArray çš„ç±»å‹æ˜¯ { [key:number]ï¼šstring }
const MyArray = ["a", "b", "c"];

// ç­‰åŒäº (typeof MyArray)[number]
// è¿”å› string
type Person = (typeof MyArray)[number];
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`MyArray`æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç±»å‹å®é™…ä¸Šæ˜¯å±æ€§åçš„æ•°å€¼ç´¢å¼•ï¼Œè€Œ`typeof MyArray[number]`çš„`typeof`è¿ç®—ä¼˜å…ˆçº§é«˜äºæ–¹æ‹¬å·ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯æ‰€æœ‰æ•°å€¼é”®åçš„é”®å€¼ç±»å‹`string`ã€‚

> [!NOTE]
>
> æ–¹æ‹¬å·é‡Œé¢ä¸èƒ½æœ‰å€¼çš„è¿ç®—ã€‚

```TS
// ç¤ºä¾‹ä¸€
const key = 'age';
type Age = Person[key]; // æŠ¥é”™

// ç¤ºä¾‹äºŒ
type Age = Person['a' + 'g' + 'e']; // æŠ¥é”™
```

ä¸Šé¢ä¸¤ä¸ªç¤ºä¾‹ï¼Œæ–¹æ‹¬å·é‡Œé¢éƒ½æ¶‰åŠå€¼çš„è¿ç®—ï¼Œç¼–è¯‘æ—¶ä¸ä¼šè¿›è¡Œè¿™ç§è¿ç®—ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™

### extends ? : ä¸ infer

`infer` å…³é”®å­—æ˜¯ TypeScript æ¡ä»¶ç±»å‹ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œå®ƒå…è®¸ä½ ï¼š

1. **åŠ¨æ€åœ°ä»ç°æœ‰ç±»å‹ä¸­æ¨æ–­å’Œæå–æ–°çš„ç±»å‹å˜é‡ã€‚**
2. **æ„å»ºå¼ºå¤§çš„ç±»å‹è½¬æ¢å·¥å…·å’Œå®ç”¨ç¨‹åºç±»å‹ã€‚**
3. **å®ç°æ›´é«˜çº§çš„ç±»å‹æ“ä½œå’Œæ¨¡å¼åŒ¹é…ã€‚**

#### è¯­æ³•æ ¼å¼

`infer` æ€»æ˜¯å‡ºç°åœ¨æ¡ä»¶ç±»å‹çš„ `extends` å…³é”®å­—çš„å³ä¾§ï¼Œç”¨äºæ¨¡å¼åŒ¹é…ï¼š

```TS
type MyConditionalType<T> = T extends SomePattern<infer U> ? U : NeverType;
```

- `T extends SomePattern<infer U>`:
  - `T`: å¾…æ£€æŸ¥çš„ç±»å‹ã€‚
  - `SomePattern<infer U>`: è¿™æ˜¯ä¸€ä¸ªç±»å‹æ¨¡å¼ã€‚`infer U` è¡¨ç¤ºâ€œå¦‚æœ `T` ç¬¦åˆ `SomePattern` çš„ç»“æ„ï¼Œé‚£ä¹ˆè¯·æ¨æ–­å‡º `SomePattern` ä¸­çš„æ³›å‹å‚æ•°ï¼Œå¹¶æŠŠå®ƒå‘½åä¸º `U`â€ã€‚
- `? U`: å¦‚æœåŒ¹é…æˆåŠŸï¼Œæ¡ä»¶ç±»å‹çš„ç»“æœå°±æ˜¯æ¨æ–­å‡ºçš„ `U` ç±»å‹ã€‚
- `: NeverType`: å¦‚æœåŒ¹é…å¤±è´¥ï¼Œåˆ™è¿”å› `NeverType`ï¼ˆæˆ–ä½ å®šä¹‰çš„å…¶ä»–ç±»å‹ï¼‰ã€‚

#### å¸¸è§ç”¨æ³•

##### æå–å‡½æ•°è¿”å›ç±»å‹

```TS
type ReturnType<T> = T extends (...args: any[]) => infer R ? R : any;

function greet(): string {
  return "Hello";
}

function add(a: number, b: number): number {
  return a + b;
}

const obj = {
  id: 1,
  getName(): string { return "test"; }
};

type GreetReturnType = ReturnType<typeof greet>; // type GreetReturnType = string
type AddReturnType = ReturnType<typeof add>;     // type AddReturnType = number
type GetNameReturnType = ReturnType<typeof obj.getName>; // type GetNameReturnType = string

// å¦‚æœä¸æ˜¯å‡½æ•°ç±»å‹ï¼Œåˆ™ä¸º any (æ ¹æ®ä¸Šé¢çš„å®šä¹‰)
type NonFunctionReturnType = ReturnType<number>; // type NonFunctionReturnType = any
```

- `T extends (...args: any[]) => infer R`:
  - æ£€æŸ¥ `T` æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ã€‚
  - å¦‚æœ `T` æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œé‚£ä¹ˆ `infer R` ä¼šæ¨æ–­å‡ºè¿™ä¸ªå‡½æ•°çš„**è¿”å›å€¼ç±»å‹**ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ç±»å‹å˜é‡ `R`ã€‚
- `? R`: å¦‚æœ `T` ç¡®å®æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆ `ReturnType<T>` çš„ç»“æœå°±æ˜¯è¿™ä¸ªæ¨æ–­å‡ºçš„ `R`ã€‚

##### æå–å‡½æ•°å‚æ•°ç±»å‹

```TS
type Parameters<T> = T extends (...args: infer P) => any ? P : never;

function printInfo(name: string, age: number): void {
  console.log(`Name: ${name}, Age: ${age}`);
}

type PrintInfoParams = Parameters<typeof printInfo>; // type PrintInfoParams = [name: string, age: number]

type AddParams = Parameters<typeof add>; // type AddParams = [a: number, b: number]

type NoParams = Parameters<() => void>; // type NoParams = []

// å¦‚æœä¸æ˜¯å‡½æ•°ç±»å‹ï¼Œåˆ™ä¸º never
type NonFunctionParams = Parameters<string>; // type NonFunctionParams = never
```

- `T extends (...args: infer P) => any`:
  - æ£€æŸ¥ `T` æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ã€‚
  - å¦‚æœ `T` æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œé‚£ä¹ˆ `infer P` ä¼šæ¨æ–­å‡ºè¿™ä¸ªå‡½æ•°çš„**å‚æ•°åˆ—è¡¨**ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ç±»å‹å˜é‡ `P`ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå…ƒç»„ç±»å‹ï¼‰ã€‚
- `? P`: å¦‚æœ `T` ç¡®å®æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆ `Parameters<T>` çš„ç»“æœå°±æ˜¯è¿™ä¸ªæ¨æ–­å‡ºçš„ `P`ã€‚

##### æå–Promiseçš„è§£æå€¼ç±»å‹

åœ¨ TypeScript 4.5+ ä¸­ï¼Œ`Awaited` ç±»å‹æ˜¯å†…ç½®çš„ï¼Œä½†å®ƒçš„å®ç°åŸç†å°±ä¾èµ– `infer`ã€‚

```TS
// ç®€åŒ–ç‰ˆ Awaited å®ç°åŸç†
type MyAwaited<T> =
  T extends PromiseLike<infer U> ? MyAwaited<U> : // å¦‚æœæ˜¯ PromiseLikeï¼Œåˆ™é€’å½’æ¨æ–­å…¶è§£æå€¼
  T; // å¦åˆ™ç›´æ¥è¿”å› T

type PromiseString = Promise<string>;
type PromiseNumber = Promise<Promise<number>>; // åµŒå¥— Promise

type Result1 = MyAwaited<PromiseString>; // type Result1 = string
type Result2 = MyAwaited<PromiseNumber>; // type Result2 = number (ä¼šé€’å½’è§£å¼€åµŒå¥— Promise)
type Result3 = MyAwaited<number>;        // type Result3 = number
```

##### æå–æ•°ç»„æˆ–å…ƒç»„çš„å…ƒç´ ç±»å‹

```TS
type ArrayElementType<T> = T extends (infer U)[] ? U : T;

type NumberArray = ArrayElementType<number[]>; // type NumberArray = number
type StringTuple = ArrayElementType<[string, number]>; // type StringTuple = string | number (å…ƒç»„ä¼šè¢«æ¨æ–­ä¸ºè”åˆç±»å‹)
type SingleValue = ArrayElementType<boolean>; // type SingleValue = boolean (ä¸åŒ¹é…ï¼Œè¿”å›åŸå§‹ç±»å‹)
```

##### ä»å¯¹è±¡å±æ€§ç±»å‹ä¸­æå–

```TS
type GetPropType<T, K extends keyof T> = T extends { [P in K]: infer V } ? V : never;

interface User {
  name: string;
  age: number;
}

type UserName = GetPropType<User, 'name'>; // type UserName = string
type UserAge = GetPropType<User, 'age'>;   // type UserAge = number
// type UserInvalid = GetPropType<User, 'email'>; // Error: Type '"email"' is not assignable to type '"name" | "age"'.
```

---

`infer` ç»å¸¸ä¸ `keyof`ã€`typeof` ä»¥åŠå…¶ä»–é«˜çº§ç±»å‹æ“ä½œç¬¦ç»“åˆä½¿ç”¨ï¼Œæ¥æ„å»ºå¤æ‚çš„ç±»å‹è½¬æ¢å·¥å…·ã€‚

ä¾‹å¦‚ï¼Œä»ä¸€ä¸ªå¯¹è±¡ç±»å‹ä¸­æå–æ‰€æœ‰æ–¹æ³•çš„åç§°å’Œç­¾åï¼š

```TS
type MethodNames<T> = {
  [K in keyof T]: T[K] extends (...args: any[]) => any ? K : never;
}[keyof T]; // ä½¿ç”¨ç´¢å¼•è®¿é—®ç±»å‹æ¥è·å–è”åˆç±»å‹

type MethodParameters<T, M extends MethodNames<T>> = T[M] extends (...args: infer P) => any ? P : never;
type MethodReturnType<T, M extends MethodNames<T>> = T[M] extends (...args: any[]) => infer R ? R : never;

class Example {
  foo(a: string, b: number): boolean { return true; }
  bar(): string { return "hi"; }
  baz: number = 10;
}

type ExampleMethodNames = MethodNames<Example>; // type ExampleMethodNames = "foo" | "bar"

type FooParams = MethodParameters<Example, "foo">; // type FooParams = [a: string, b: number]
type FooReturn = MethodReturnType<Example, "foo">; // type FooReturn = boolean

type BarParams = MethodParameters<Example, "bar">; // type BarParams = []
type BarReturn = MethodReturnType<Example, "bar">; // type BarReturn = string
```



### is

`is` å…³é”®å­—æ˜¯ **ç±»å‹è°“è¯ï¼ˆType Predicateï¼‰** çš„ä¸€éƒ¨åˆ†ã€‚å®ƒçš„ä½œç”¨æ˜¯å‘Šè¯‰ TypeScript ç¼–è¯‘å™¨ï¼Œåœ¨ä¸€ä¸ªå‡½æ•°æ‰§è¡Œåï¼ŒæŸä¸ªå˜é‡çš„ç±»å‹ä¼šå˜å¾—**æ›´åŠ å…·ä½“**ã€‚è¿™å¯¹äºç¼©å°è”åˆç±»å‹ï¼ˆUnion Typesï¼‰çš„èŒƒå›´ï¼Œå¹¶å®ç°æ›´ç²¾ç¡®çš„ç±»å‹æ£€æŸ¥è‡³å…³é‡è¦ã€‚



å½“ä½ åœ¨å‡½æ•°è¿”å›ç±»å‹çš„ä½ç½®ä½¿ç”¨ `parameterName is Type` è¿™ç§å½¢å¼æ—¶ï¼Œä½ æ˜¯åœ¨å‘ TypeScript åšå‡ºä¸€ä¸ªä¿è¯ï¼š

- **ç¼–è¯‘æ—¶å½±å“**ï¼šè¿™ä¸ªå‡½æ•°ä¸ä»…ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆ`true` æˆ– `false`ï¼‰ï¼Œè€Œä¸”å¦‚æœå®ƒè¿”å› `true`ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨è¯¥å‡½æ•°çš„ä½œç”¨åŸŸå†…ï¼ŒTypeScript ç¼–è¯‘å™¨å°±ä¼šè®¤ä¸º `parameterName` çš„ç±»å‹å·²ç»ç¼©å°åˆ° `Type`ã€‚
- **è¿è¡Œæ—¶æ— å½±å“**ï¼š`is` å…³é”®å­—åªå­˜åœ¨äº TypeScript çš„ç±»å‹ç³»ç»Ÿä¸­ï¼Œåœ¨ç¼–è¯‘æˆ JavaScript åä¼šè¢«å®Œå…¨ç§»é™¤ï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•è¿è¡Œæ—¶ä»£ç ã€‚



```TS
// å‡½æ•°å£°æ˜äº† å¦‚æœè¿”å›å€¼ä¸ºtrueï¼Œåˆ™è¯¥å€¼ä¸€å®šæ˜¯stringç±»å‹
function isString(value: number | string): value is string {
  return typeof value === 'string';
}

function example(value: any) {
  if (isString(value)) {
    // èƒ½å¤Ÿç»è¿‡ifæ¡ä»¶åˆ¤æ–­ï¼Œè¯´æ˜è¿™é‡Œä¸€å®šæ˜¯stringç±»å‹ï¼Œæ‰€ä»¥èƒ½å¤Ÿä½¿ç”¨stringçš„æ–¹æ³•
    console.log(value.toUpperCase());
  }
}

example('hello world');
```



## ç±»å‹æ˜ å°„

### è‡ªå®šä¹‰æ˜ å°„

**ç±»å‹æ˜ å°„ï¼ˆMapped Typesï¼‰**å…è®¸ä½ åŸºäºä¸€ä¸ªç°æœ‰çš„ç±»å‹ï¼Œé€šè¿‡éå†å…¶å±æ€§å¹¶å¯¹å…¶åº”ç”¨æŸç§è½¬æ¢ï¼Œæ¥åˆ›å»ºæ–°çš„ç±»å‹ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆå¯¹ç±»å‹è¿›è¡Œçš„ä¸€ç§â€œæ‰¹é‡å¤„ç†â€æˆ–â€œæ•°æ®è½¬æ¢â€ã€‚

ç±»å‹æ˜ å°„çš„è¯­æ³•ç»“æ„ç±»ä¼¼äº JavaScript ä¸­çš„ `for...in` å¾ªç¯ï¼Œä½†å®ƒæ˜¯åœ¨**ç±»å‹å±‚é¢**ä¸Šæ“ä½œçš„ã€‚å®ƒé€šè¿‡è¿­ä»£æºç±»å‹çš„æ‰€æœ‰å±æ€§é”®ï¼Œå¹¶ä¸ºæ¯ä¸ªé”®ç”Ÿæˆä¸€ä¸ªæ–°çš„å±æ€§ï¼Œä»è€Œæ„å»ºå‡ºä¸€ä¸ªæ–°çš„ç±»å‹ã€‚

~~~TS
type NewType<T> = {
  [P in keyof T]: /* ç±»å‹è½¬æ¢é€»è¾‘ï¼ŒåŸºäº T[P] æˆ–å…¶ä»– */
};
~~~

**`[P in keyof T]`**ï¼šè¿™æ˜¯æ˜ å°„ç±»å‹çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚

- `keyof T`ï¼šè·å–ç±»å‹ `T` çš„æ‰€æœ‰å…¬å…±å±æ€§åçš„è”åˆç±»å‹ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœ `T` æ˜¯ `{ a: string; b: number; }`ï¼Œé‚£ä¹ˆ `keyof T` å°±æ˜¯ `'a' | 'b'`ï¼‰ã€‚
- `P in ...`ï¼šè¿­ä»£ `keyof T` ä¸­çš„æ¯ä¸€ä¸ªå±æ€§å `P`ã€‚

**`:`**ï¼šå†’å·åé¢æ˜¯ä½ æƒ³è¦åº”ç”¨äºæ¯ä¸ªå±æ€§çš„**ç±»å‹è½¬æ¢é€»è¾‘**ã€‚`T[P]` è¡¨ç¤ºåŸå§‹ç±»å‹ `T` ä¸­å±æ€§ `P` å¯¹åº”çš„ç±»å‹ã€‚

| æ¦‚å¿µ     | ç¤ºä¾‹                                 | è¯´æ˜                           |
| -------- | ------------------------------------ | ------------------------------ |
| åŸºæœ¬æ˜ å°„ | `[K in keyof T]: T[K]`               | éå† T çš„æ‰€æœ‰é”®                |
| å¯é€‰å±æ€§ | `[K in keyof T]?: T[K]`              | å°†å±æ€§å˜æˆå¯é€‰                 |
| åªè¯»å±æ€§ | `readonly [K in keyof T]: T[K]`      | å±æ€§åŠ  readonly                |
| é”®é‡å‘½å | `[K in keyof T as `new_${K}`]: T[K]` | å¯ä»¥ç”¨æ¨¡ç‰ˆå­—ç¬¦ä¸²åŠ¨æ€ä¿®æ”¹å±æ€§å |
| é”®è¿‡æ»¤   | `as K extends string ? K : never`    | è¿‡æ»¤å‡ºç¬¦åˆæ¡ä»¶çš„é”®             |

### å¸¸è§å†…ç½®æ˜ å°„

#### `Partial<T>`

`Partial<T>` ä¼šå°†ç±»å‹ `T` ä¸­çš„æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰ï¼ˆ`?`ï¼‰ã€‚

```TS
interface UserInfo {
  name?: string;
  age?: number;
}

type RequiredUserInfo = Required<UserInfo>;
/*
ç­‰åŒäºï¼š
type RequiredUserInfo = {
  name: string;
  age: number;
};
*/

const user: RequiredUserInfo = { name: "Bob", age: 30 }; // å¿…é¡»æä¾› name å’Œ age
// const incompleteUser: RequiredUserInfo = { name: "Charlie" }; // Error: Property 'age' is missing
```

**å®ç°åŸç†ï¼š**

```TS
type Required<T> = {
  [P in keyof T]-?: T[P]; // æ³¨æ„è¿™é‡Œçš„ -? æ ‡è®°ï¼Œè¡¨ç¤ºç§»é™¤å¯é€‰å±æ€§
};
```

**`-?` ç¬¦å·**ï¼šè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ä¿®é¥°ç¬¦ï¼Œç”¨äºä»å±æ€§ä¸­ç§»é™¤å¯é€‰ä¿®é¥°ç¬¦ã€‚ç±»ä¼¼åœ°ï¼Œ`+?` ï¼ˆæˆ–ä¸å†™ï¼‰è¡¨ç¤ºæ·»åŠ å¯é€‰ä¿®é¥°ç¬¦ï¼Œ`+readonly` è¡¨ç¤ºæ·»åŠ åªè¯»ä¿®é¥°ç¬¦ï¼Œ`-readonly` è¡¨ç¤ºç§»é™¤åªè¯»ä¿®é¥°ç¬¦ã€‚

#### `Readonly<T>`

`Readonly<T>` ä¼šå°†ç±»å‹ `T` ä¸­çš„æ‰€æœ‰å±æ€§å˜ä¸ºåªè¯»ï¼ˆ`readonly`ï¼‰ã€‚

```TS
interface Product {
  id: string;
  price: number;
}

type ReadonlyProduct = Readonly<Product>;
/*
ç­‰åŒäºï¼š
type ReadonlyProduct = {
  readonly id: string;
  readonly price: number;
};
*/

const product: ReadonlyProduct = { id: "P101", price: 99.99 };
// product.price = 100; // Error: Cannot assign to 'price' because it is a read-only property.
```

**å®ç°åŸç†ï¼š**

~~~TS
type Readonly<T> = {
  readonly [P in keyof T]: T[P]; // æ³¨æ„è¿™é‡Œçš„ readonly æ ‡è®°
};
~~~

#### `Pick<T, K>`

`Pick<T, K>` ä¼šä»ç±»å‹ `T` ä¸­é€‰æ‹©å±æ€§ååœ¨ `K` è”åˆç±»å‹ä¸­çš„å±æ€§ï¼Œæ¥åˆ›å»ºæ–°ç±»å‹ã€‚

```TS
interface Car {
  make: string;
  model: string;
  year: number;
  color: string;
}

type CarSummary = Pick<Car, "make" | "model">;
/*
ç­‰åŒäºï¼š
type CarSummary = {
  make: string;
  model: string;
};
*/

const myCar: CarSummary = { make: "Toyota", model: "Camry" };
// const invalidCar: CarSummary = { make: "Honda", year: 2020 }; // Error: Property 'year' does not exist
```

**å®ç°åŸç†ï¼š**

```TS
type Pick<T, K extends keyof T> = {
  [P in K]: T[P]; // åªè¿­ä»£ K ä¸­æŒ‡å®šçš„å±æ€§
};
```

`K extends keyof T`ï¼šè¿™ä¸ªçº¦æŸç¡®ä¿äº†ä½ åªèƒ½é€‰æ‹© `T` ä¸­å®é™…å­˜åœ¨çš„å±æ€§ã€‚

#### `Omit<T, K>`

`Omit<T, K>` ä¼šä»ç±»å‹ `T` ä¸­æ’é™¤å±æ€§ååœ¨ `K` è”åˆç±»å‹ä¸­çš„å±æ€§ï¼Œæ¥åˆ›å»ºæ–°ç±»å‹ã€‚

```TS
interface Task {
  id: number;
  title: string;
  description: string;
  dueDate: Date;
  completed: boolean;
}

type TaskWithoutIdAndDate = Omit<Task, "id" | "dueDate">;
/*
ç­‰åŒäºï¼š
type TaskWithoutIdAndDate = {
  title: string;
  description: string;
  completed: boolean;
};
*/

const newTask: TaskWithoutIdAndDate = {
  title: "Learn Mapped Types",
  description: "Understand how they work.",
  completed: false,
};
```

**å®ç°åŸç†ï¼š**

```TS
type Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>;
// Omit æ˜¯åŸºäº Pick å’Œ Exclude å®ç°çš„
// Exclude<UnionType, ExcludedMembers> ä¼šä» UnionType ä¸­ç§»é™¤ ExcludedMembers
```

## æ³¨é‡ŠæŒ‡ä»¤

**æ³¨é‡ŠæŒ‡ä»¤ï¼ˆComment Directivesï¼‰** æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Šå½¢å¼ï¼Œå®ƒä»¬ä»¥ç‰¹å®šçš„æ ¼å¼ç¼–å†™ï¼Œæ—¨åœ¨å‘ TypeScript ç¼–è¯‘å™¨ï¼ˆæˆ–ç›¸å…³çš„å·¥å…·ï¼Œå¦‚ ESLintã€JSDoc ç­‰ï¼‰æä¾›é¢å¤–çš„æŒ‡ä»¤æˆ–ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ä½œä¸ºæ™®é€šçš„è§£é‡Šæ€§æ–‡æœ¬ã€‚å®ƒä»¬åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­è¢«å·¥å…·è¯†åˆ«å’Œå¤„ç†ï¼Œä½†ä¸ä¼šæˆä¸ºæœ€ç»ˆ JavaScript ä»£ç çš„ä¸€éƒ¨åˆ†ã€‚

### ä¸‰æ–œæ å¼•ç”¨æŒ‡ä»¤

è¿™æ˜¯æœ€å¤è€ä¸”ç‰¹å®šç”¨é€”çš„æ³¨é‡ŠæŒ‡ä»¤ï¼Œé€šå¸¸ç”¨äºå£°æ˜æ–‡ä»¶ (`.d.ts` æ–‡ä»¶) æˆ–åœ¨æ²¡æœ‰æ¨¡å—ç³»ç»Ÿæ—¶å¼•ç”¨å…¶ä»–æ–‡ä»¶ã€‚

**`<reference path="..." />`**: å¼•ç”¨å¦ä¸€ä¸ª TypeScript æ–‡ä»¶ã€‚å½“æ–‡ä»¶ä¹‹é—´æ²¡æœ‰æ˜ç¡®çš„ `import`/`export` å…³ç³»æ—¶ä½¿ç”¨ï¼Œé€šå¸¸ç”¨äºç»„ç»‡å¤§å‹é¡¹ç›®æˆ–æ—©æœŸçš„æ¨¡å—ç³»ç»Ÿã€‚ç¼–è¯‘å™¨ä¼šæŸ¥æ‰¾å¹¶åŒ…å« `path` æŒ‡å®šçš„æ–‡ä»¶ã€‚

```TS
/// <reference path="./other.ts" />
// ç¼–è¯‘å™¨ä¼šåŒ…å« other.ts æ–‡ä»¶
```

**`<reference types="..." />`**: å¼•ç”¨ä¸€ä¸ªç±»å‹å£°æ˜åŒ…ï¼ˆé€šå¸¸æ˜¯ `@types` å‘½åç©ºé—´ä¸‹çš„åŒ…ï¼‰ã€‚è¿™ä¸ `tsconfig.json` ä¸­çš„ `types` é…ç½®æˆ– `import` è¯­å¥æœ‰ç±»ä¼¼ä½œç”¨ï¼Œä½†ç”¨äºå…¨å±€ç±»å‹å£°æ˜ã€‚

```TS
// index.ts æˆ– global.d.ts
/// <reference types="node" />
// è¿™æ ·å°±å¯ä»¥åœ¨å½“å‰æ–‡ä»¶ä¸­ä½¿ç”¨ Node.js çš„å…¨å±€ç±»å‹ï¼Œå¦‚ process
console.log(process.platform);
```

**`<reference lib="..." />`**: æ˜¾å¼åœ°å¼•ç”¨ä¸€ä¸ªå†…ç½®çš„ç±»å‹åº“ï¼ˆå¦‚ `lib.dom.d.ts`, `lib.es2015.d.ts`ï¼‰ã€‚è¿™ä¸ `tsconfig.json` ä¸­çš„ `lib` é…ç½®ç±»ä¼¼ã€‚

```TS
// my-dom-only-file.ts
/// <reference lib="dom" />
// å¼ºåˆ¶åªåŒ…å« DOM ç›¸å…³çš„ç±»å‹ï¼Œè€Œä¸åŒ…å«å…¶ä»–é»˜è®¤ç±»å‹
document.getElementById("app");
```

**`<reference no-default-lib="true"/>`**: é˜»æ­¢ç¼–è¯‘å™¨åŒ…å«é»˜è®¤çš„æ ‡å‡†åº“ï¼ˆé€šå¸¸æ˜¯æ ¹æ® `target` é…ç½®æ¨æ–­çš„ï¼‰ã€‚è¿™åœ¨ä½¿ç”¨è‡ªå®šä¹‰æ ‡å‡†åº“æˆ–åœ¨éå¸¸å—é™çš„ç¯å¢ƒä¸­å¾ˆæœ‰ç”¨ã€‚

```TS
/// <reference no-default-lib="true"/>
// ä¸ä¼šåŒ…å«ä»»ä½• lib.*.d.ts æ–‡ä»¶
// console.log("hello"); // Error: Cannot find name 'console'.	
```

### TypeScriptè¯Šæ–­æŒ‡ä»¤

#### `@ts-ignore`

å¿½ç•¥ä¸‹ä¸€è¡Œä»£ç å¯èƒ½äº§ç”Ÿçš„æ‰€æœ‰ TypeScript é”™è¯¯ã€‚è¿™æ˜¯ä¸€ç§â€œä¸‡èƒ½è¯â€ï¼Œé€šå¸¸å»ºè®®è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬å®Œå…¨ç¦ç”¨äº†ç±»å‹æ£€æŸ¥ã€‚

```TS
// @ts-ignore
const value: number = "hello"; // ç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ï¼Œå³ä½¿ç±»å‹ä¸åŒ¹é…
```

#### `@ts-expect-error`

å¦‚æœä¸‹ä¸€è¡Œä»£ç **æœŸæœ›å‡ºç°ä¸€ä¸ªé”™è¯¯**ï¼Œå¹¶ä¸”ç¡®å®å‡ºç°äº†ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ã€‚å¦‚æœä¸‹ä¸€è¡Œ**æ²¡æœ‰é”™è¯¯**ï¼Œ`@ts-expect-error` åè€Œä¼šæŠ¥é”™ã€‚è¿™å¯¹äºæµ‹è¯•å’Œä»£ç é‡æ„éå¸¸æœ‰ç”¨ï¼Œç¡®ä¿ä½ â€œæœŸæœ›â€çš„é”™è¯¯ç¡®å®å­˜åœ¨ã€‚

```TS
// @ts-expect-error
const num: number = "string"; // ç¼–è¯‘å™¨æœŸæœ›è¿™é‡Œæœ‰é”™è¯¯ï¼Œæ‰€ä»¥ä¸æŠ¥é”™

// @ts-expect-error
const str: string = "another string"; // Error: '/// @ts-expect-error' expects an error on the next line.
```

#### `@ts-nocheck`

æ”¾ç½®åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼Œå‘Šè¯‰ TypeScript ç¼–è¯‘å™¨å®Œå…¨è·³è¿‡å¯¹è¯¥æ–‡ä»¶çš„ç±»å‹æ£€æŸ¥ã€‚è¿™å¯¹äºå°†å¤§å‹ JavaScript æ–‡ä»¶é€æ­¥è¿ç§»åˆ° TypeScript æ—¶å¾ˆæœ‰ç”¨

```TS
// @ts-nocheck
// æ•´ä¸ªæ–‡ä»¶éƒ½ä¸ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥
function problematicJs(a, b) {
    return a + b.something; // TypeScript ä¸ä¼šæŠ¥é”™
}
```

#### `@ts-check`

ä¸ `//@ts-nocheck` ç›¸åï¼Œç”¨äºåœ¨é»˜è®¤ä¸è¿›è¡Œç±»å‹æ£€æŸ¥çš„ JavaScript æ–‡ä»¶ï¼ˆé€šè¿‡ `allowJs` å’Œ `checkJs` é…ç½®å¯ç”¨ï¼‰ä¸­ï¼Œå¼ºåˆ¶å¯¹ç‰¹å®šæ–‡ä»¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚

```TS
// @ts-check
// å³ä½¿åœ¨ JS æ–‡ä»¶ä¸­ï¼Œä¹Ÿä¼šè¿›è¡Œç±»å‹æ£€æŸ¥
/**
 * @param {number} x
 * @param {number} y
 */
function add(x, y) {
    return x + y;
}

add(1, "2"); // ç¼–è¯‘æ—¶æŠ¥é”™ï¼šArgument of type 'string' is not assignable to parameter of type 'number'.
```

### JS Doc æ³¨é‡ŠæŒ‡ä»¤

JSDoc æ˜¯ä¸€ç§ç”¨äº JavaScript ä»£ç çš„æ–‡æ¡£æ³¨é‡Šè§„èŒƒã€‚TypeScript èƒ½å¤Ÿç†è§£å¤§éƒ¨åˆ† JSDoc æ ‡ç­¾ï¼Œå¹¶å°†å®ƒä»¬ç”¨äºç±»å‹æ¨æ–­å’Œç”Ÿæˆæ–‡æ¡£ã€‚å®ƒä»¬è™½ç„¶ä¸æ˜¯ä¸¥æ ¼çš„â€œTypeScript ç‹¬æœ‰â€æŒ‡ä»¤ï¼Œä½† TypeScript ç¼–è¯‘å™¨å¯¹å…¶æœ‰ç‰¹æ®Šæ”¯æŒã€‚

#### `@typedef`

å®šä¹‰ä¸€ä¸ªç±»å‹åˆ«åã€‚

```TS
/**
 * @typedef {object} Point
 * @property {number} x - The x coordinate.
 * @property {number} y - The y coordinate.
 */
```

#### `@param`

æè¿°å‡½æ•°å‚æ•°ã€‚

#### `@return/@returns`

æè¿°å‡½æ•°è¿”å›å€¼

```TS
/**
 * Adds two numbers.
 * @param {number} a - The first number.
 * @param {number} b - The second number.
 * @returns {number} The sum of a and b.
 */
function add(a, b) {
    return a + b;
}
```

#### `@type`

å¯¹å˜é‡ã€å±æ€§ç­‰è¿›è¡Œç±»å‹å£°æ˜ã€‚

```TS
/** @type {string} */
const name = "Alice";
```

#### `@template`

å®šä¹‰æ³›å‹å‚æ•°ã€‚

```TS
/**
 * @template T
 * @param {T[]} arr - An array of type T.
 * @returns {T} The first element.
 */
function getFirstElement(arr) {
    return arr[0];
}
```

- **`@implements`**: æŒ‡ç¤ºä¸€ä¸ªç±»å®ç°äº†ä¸€ä¸ªæ¥å£ã€‚
- **`@override`**: ï¼ˆTypeScript 4.3+ï¼‰æŒ‡ç¤ºä¸€ä¸ªæ–¹æ³•è¦†ç›–äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚

### ES Lintæ³¨é‡ŠæŒ‡ä»¤

å¦‚æœä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ ESLint è¿›è¡Œä»£ç è§„èŒƒæ£€æŸ¥ï¼ŒESLint ä¹Ÿæœ‰ä¸€å¥—è‡ªå·±çš„æ³¨é‡ŠæŒ‡ä»¤ï¼Œå®ƒä»¬ä¸ TypeScript æœ¬èº«æ— å…³ï¼Œä½†ä¸é¡¹ç›®å¼€å‘æµç¨‹ç´§å¯†ç›¸å…³ã€‚

- **`eslint-disable`**: ç¦ç”¨æ‰€æœ‰è§„åˆ™ã€‚
- **`eslint-disable-line`**: ç¦ç”¨å½“å‰è¡Œçš„è§„åˆ™ã€‚
- **`eslint-disable-next-line`**: ç¦ç”¨ä¸‹ä¸€è¡Œçš„è§„åˆ™ã€‚
- **`eslint-enable`**: é‡æ–°å¯ç”¨è§„åˆ™ã€‚
- **`eslint-env`**: æŒ‡å®šè¿è¡Œæ—¶ç¯å¢ƒã€‚
- **`eslint no-unused-vars`**: é’ˆå¯¹ç‰¹å®šè§„åˆ™ç¦ç”¨ã€‚

```TS
// eslint-disable-next-line no-console
console.log("This will not trigger no-console rule.");

/* eslint-disable */
function everythingIsDisabled() {
    // ...
}
/* eslint-enable */
```



